const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-B1b6n_7N.js","./iframe-BP3_vWhA.js","./marked.esm-ZC1ceR6y.js","./react-number-format.es-Ki-o0R_4.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var _i=Object.defineProperty;var Vi=(e,t,n)=>t in e?_i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ne=(e,t,n)=>Vi(e,typeof t!="symbol"?t+"":t,n);import{r as y,R as rn,_ as qi}from"./iframe-BP3_vWhA.js";import{h as Ui,g as ji,k as Ki,v as Gi,l as Ji,m as tn,r as Qi,j as Zi,t as er}from"./throttle-CBl_kIso.js";import{s as vt,a as tr}from"./marked.esm-ZC1ceR6y.js";function Jo(e="This should not happen"){throw new Error(e)}function bt(e,t="Assertion failed"){if(!e)return Jo(t)}function Jn(e,t){return Jo(t??"Hell froze over")}function tl(e,t){try{return e()}catch{return t}}const Eo=Object.prototype.hasOwnProperty;function zt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&zt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Eo.call(e,n)&&++o&&!Eo.call(t,n)||!(n in t)||!zt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Mn=null,Qn=void 0;var le=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(le||{}),nr=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(nr||{}),qn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(qn||{});function nl(e){return"width"in e&&typeof e.width=="number"}async function ol(e){return typeof e=="object"?e:await e()}function or(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function il(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function Qo(e){return e.kind==="marker"||e.kind==="new-row"}function ir(e){if(!or(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:Jn(e,"A cell was passed with an invalid kind")}}function rl(e){return Ui(e,"editor")}function Zn(e){return!(e.readonly??!1)}var sn=(e=>(e.NewRow="new-row",e.Marker="marker",e))(sn||{});function rr(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Fo;const mt=class mt{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new mt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=rr([...this.items,n]);return new mt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,s]of n.entries()){const[l,a]=s;if(l<=i&&o<=a){const u=[];l<o&&u.push([l,o]),i<a&&u.push([i,a]),n.splice(r,1,...u)}}return new mt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ne(mt,"empty",()=>Fo??(Fo=new mt([]))),ne(mt,"fromSingleSelection",t=>mt.empty().add(t));let Un=mt;function Ue(e,t,n,o,i=!1){const r=y.useRef();r.current=t,y.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const s=n,l=a=>{var u;(u=r.current)==null||u.call(s,a)};return s.addEventListener(e,l,{passive:o,capture:i}),()=>{s.removeEventListener(e,l,{capture:i})}},[e,n,o,i])}function sl(e,t){return e===void 0?void 0:t}const sr=Math.PI;function Bo(e){return e*sr/180}const Zo=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ei=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ti=(e,t,n)=>Math.min(e,t-n*2),ni=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,eo=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),y.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},lr=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ar(e,t,n){const[o,i]=y.useState(e),r=y.useRef(!0);y.useEffect(()=>()=>{r.current=!1},[]);const s=y.useRef(ji(l=>{r.current&&i(l)},n));return y.useLayoutEffect(()=>{r.current&&s.current(()=>e())},t),o}const cr="֑-߿יִ-﷽ﹰ-ﻼ",dr="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ur=new RegExp("^[^"+dr+"]*["+cr+"]");function to(e){return ur.test(e)?"rtl":"not-rtl"}let kn;function Po(){if(typeof document>"u")return 0;if(kn!==void 0)return kn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),kn=n-o,kn}const Pt=Symbol();function ll(e){const t=y.useRef([Pt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=y.useState(e),[,i]=y.useState(),r=y.useCallback(l=>{const a=t.current[0];a!==Pt&&(l=typeof l=="function"?l(a):l,l===a)||(a!==Pt&&i({}),o(u=>typeof l=="function"?l(a===Pt?u:a):l),t.current[0]=Pt)},[]),s=y.useCallback(()=>{t.current[0]=Pt,i({})},[]);return[t.current[0]===Pt?n:t.current[0],r,s]}function oi(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function al(e){const t=y.useRef(e);return zt(e,t.current)||(t.current=e),t.current}function fr(e,t){const n=typeof t=="number"?t:t[0],o=typeof t=="number"?0:t[1];return rn.useMemo(()=>e.map((i,r)=>({group:i.group,grow:i.grow,hasMenu:i.hasMenu,icon:i.icon,id:i.id,menuIcon:i.menuIcon,overlayIcon:i.overlayIcon,sourceIndex:r,sticky:r<n||r>=e.length-o,stickyPosition:r<n?"left":r>=e.length-o?"right":void 0,indicatorIcon:i.indicatorIcon,style:i.style,themeOverride:i.themeOverride,title:i.title,trailingRowOptions:i.trailingRowOptions,width:i.width,growOffset:i.growOffset,rowMarker:i.rowMarker,rowMarkerChecked:i.rowMarkerChecked,headerRowMarkerTheme:i.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:i.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:i.headerRowMarkerDisabled})),[e,n,o])}function cl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(Sn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function En(e,t){return(e??"")===(t??"")}function hr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function gr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function Sn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ii(e){return[e.x+e.width-1,e.y+e.height-1]}function Ho(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,s=n.y+n.height-1,[l,a]=e;if(a<r||a>s)return!1;if(t.span===void 0)return l>=o&&l<=i;const[u,d]=t.span;return u>=o&&u<=i||d>=o&&u<=i||u<o&&d>i}function mr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Ho(e,t,r)&&i++;for(const s of n.current.rangeStack)Ho(e,t,s)&&i++;return i}function ri(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,s)=>({...r,sticky:e[s].sticky})),n=o}return n}function Xt(e,t){let n=0,o=0;const i=ri(e,t);for(let r=0;r<i.length;r++){const s=i[r];if(s.sticky)s.stickyPosition==="left"&&(n+=s.width);else break}for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.sticky)s.stickyPosition==="right"&&(o+=s.width);else break}return[n,o]}function Yt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Cn(e,t,n,o,i,r){const s=ri(e,i),l=typeof o=="number"?o:o[0],a=typeof o=="number"?0:o[1],u=[];for(let f=0;f<l;f++)u.push(s[f]);if(u.length>0)for(const f of u)n-=f.width;const d=[];for(let f=s.length-a;f<s.length;f++)d.push(s[f]);if(d.length>0)for(const f of d)n-=f.width;let g=t,m=r??0;for(;m<=n&&g<s.length;)m+=s[g].width,g++;for(let f=t;f<g;f++){const c=s[f];c.sticky||u.push(c)}return u.push(...d),u}function br(e,t,n,o,i){const r=typeof n=="number"?0:n[1];let s=o;for(let a=0;a<r;a++){const u=t.length-1-a,d=t[u];if(s-=d.width,e>=s)return d.sourceIndex}let l=0;for(let a=0;a<t.length-r;a++){const u=t[a],d=u.sticky?l:l+(i??0);if(e<=d+u.width)return u.sourceIndex;l+=u.width}return-1}function yr(e,t,n,o,i,r,s,l,a,u){const d=o+i;if(n&&e<=i)return-2;if(e<=d)return-1;let g=t;for(let c=0;c<u;c++){const h=r-1-c,v=typeof s=="number"?s:s(h);if(g-=v,e>=g)return h}const m=r-u,f=e-(a??0);if(typeof s=="number"){const c=Math.floor((f-d)/s)+l;return c>=m?void 0:c}else{let c=d;for(let h=l;h<m;h++){const v=s(h);if(f<=c+v)return h;c+=v}return}}let In=0,nn={};const vr=typeof window>"u";async function pr(){var e;vr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,In=0,nn={},Gi())}pr();function si(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function _t(e,t,n,o="middle"){const i=si(e,t,o,n);let r=nn[i];return r===void 0&&(r=t.measureText(e),nn[i]=r,In++),In>1e4&&(nn={},In=0),r}function li(e,t){const n=si(e,void 0,"middle",t);return nn[n]}function It(e,t){return typeof t!="string"&&(t=t.baseFontFull),wr(e,t)}function Ao(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Do=[];function wr(e,t){for(const r of Do)if(r.key===t)return r.val;const n=Ao(e,"alphabetic"),i=-(Ao(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Do.push({key:t,val:i}),i}function kr(e,t,n,o,i,r){const{ctx:s,rect:l,theme:a}=e;let u=Number.MAX_SAFE_INTEGER;const d=500;if(t!==void 0&&(u=n-t,u<d)){const g=1-u/d;s.globalAlpha=g,s.fillStyle=a.bgSearchResult,s.fillRect(l.x+1,l.y+1,l.width-(i?2:1),l.height-(r?2:1)),s.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return u<d}function an(e,t,n){const{ctx:o,theme:i}=e,r=t??{},s=n??i.textDark;return s!==r.fillStyle&&(o.fillStyle=s,r.fillStyle=s),r}function ai(e,t,n,o,i,r,s,l,a){a==="right"?e.fillText(t,n+i-(l.cellHorizontalPadding+.5),o+r/2+s):a==="center"?e.fillText(t,n+i/2,o+r/2+s):e.fillText(t,n+l.cellHorizontalPadding+.5,o+r/2+s)}function ci(e,t){const n=_t("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function xr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Sr(e,t,n,o,i,r,s,l,a,u){const d=l.baseFontFull,g=Ki(e,t,d,i-l.cellHorizontalPadding*2,u??!1),m=ci(e,d),f=l.lineHeight*m,c=m+f*(g.length-1),h=c+l.cellVerticalPadding>r;h&&(e.save(),e.rect(n,o,i,r),e.clip());const v=o+r/2-c/2;let w=Math.max(o+l.cellVerticalPadding,v);for(const k of g)if(ai(e,k,n,w,i,m,s,l,a),w+=f,w>o+r)break;h&&e.restore()}function yt(e,t,n,o,i){const{ctx:r,rect:s,theme:l}=e,{x:a,y:u,width:d,height:g}=s;o=o??!1,o||(t=xr(t,d));const m=It(r,l),f=to(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let c=!1;n==="right"?(r.textAlign="right",c=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,c=!0),o?Sr(r,t,a,u,d,g,m,l,n,i):ai(r,t,a,u,d,g,m,l,n),c&&(r.textAlign="start"),f&&(r.direction="inherit")}}function ct(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Cr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Ir(e,t,n){const o=function(l,a){const u=a.x-l.x,d=a.y-l.y,g=Math.sqrt(u*u+d*d),m=u/g,f=d/g;return{x:u,y:a.y-l.y,len:g,nx:m,ny:f,ang:Math.atan2(f,m)}};let i;const r=t.length;let s=t[r-1];for(let l=0;l<r;l++){let a=t[l%r];const u=t[(l+1)%r],d=o(a,s),g=o(a,u),m=d.nx*g.ny-d.ny*g.nx,f=d.nx*g.nx-d.ny*-g.ny;let c=Math.asin(m<-1?-1:m>1?1:m),h=1,v=!1;f<0?c<0?c=Math.PI+c:(c=Math.PI-c,h=-1,v=!0):c>0&&(h=-1,v=!0),i=a.radius!==void 0?a.radius:n;const w=c/2;let k=Math.abs(Math.cos(w)*i/Math.sin(w)),F;k>Math.min(d.len/2,g.len/2)?(k=Math.min(d.len/2,g.len/2),F=Math.abs(k*Math.sin(w)/Math.cos(w))):F=i;let S=a.x+g.nx*k,H=a.y+g.ny*k;S+=-g.ny*F*h,H+=g.nx*F*h,e.arc(S,H,F,d.ang+Math.PI/2*h,g.ang-Math.PI/2*h,v),s=a,a=u}e.closePath()}function jn(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c){const h={x:0,y:r+u,width:0,height:0},v=typeof g=="number"?g:g[0],w=typeof g=="number"?0:g[1],k=f[e];if(e>=f.length||t>=d||t<-2||e<0)return h;const F=r-i;if(e>=v&&e<f.length-w){const S=s>e?-1:1,[H]=Xt(f);h.x+=H+a;for(let I=s;I!==e;I+=S)h.x+=f[S===1?I:I-1].width*S}else if(k.stickyPosition==="left")for(let S=0;S<e;S++)h.x+=f[S].width;else if(k.stickyPosition==="right"){h.x=n;for(let S=e;S<f.length;S++)h.x-=f[S].width}if(h.width=f[e].width+1,t===-1)h.y=i,h.height=F;else if(t===-2){h.y=0,h.height=i;let S=e;const H=f[e].group,I=f[e].sticky;for(;S>0&&En(f[S-1].group,H)&&f[S-1].sticky===I;){const W=f[S-1];h.x-=W.width,h.width+=W.width,S--}let B=e;for(;B+1<f.length&&En(f[B+1].group,H)&&f[B+1].sticky===I;){const W=f[B+1];h.width+=W.width,B++}if(!I){const[W]=Xt(f),P=h.x-W;P<0&&(h.x-=P,h.width+=P),h.x+h.width>n&&(h.width=n-h.x)}}else if(t>=d-m){let S=d-t;for(h.y=o;S>0;){const H=t+S-1;h.height=typeof c=="number"?c:c(H),h.y-=h.height,S--}h.height+=1}else{const S=l>t?-1:1;if(typeof c=="number"){const H=t-l;h.y+=H*c}else for(let H=l;H!==t;H+=S)h.y+=c(H)*S;h.height=(typeof c=="number"?c:c(t))+1}return h}const no=1<<21;function tt(e,t){return(t+2)*no+e}function di(e){return e%no}function oo(e){return Math.floor(e/no)-2}function io(e){const t=di(e),n=oo(e);return[t,n]}class ui{constructor(){ne(this,"visibleWindow",{x:0,y:0,width:0,height:0});ne(this,"freezeCols",0);ne(this,"freezeRows",[]);ne(this,"isInWindow",t=>{const n=di(t),o=oo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,s=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&s})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&zt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Mr extends ui{constructor(){super(...arguments);ne(this,"cache",new Map);ne(this,"setValue",(n,o)=>{this.cache.set(tt(n[0],n[1]),o)});ne(this,"getValue",n=>this.cache.get(tt(n[0],n[1])));ne(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class on{constructor(t=[]){ne(this,"cells");this.cells=new Set(t.map(n=>tt(n[0],n[1])))}add(t){this.cells.add(tt(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(tt(t[0],t[1]))}remove(t){this.cells.delete(tt(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(oo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(tt(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield io(t)}}function Er(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Fr{constructor(t,n){ne(this,"spriteMap",new Map);ne(this,"headerIcons");ne(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,s,l,a=1){const[u,d]=Er(n,l),g=s*Math.ceil(window.devicePixelRatio),m=`${u}_${d}_${g}_${t}`;let f=this.spriteMap.get(m);if(f===void 0){const c=this.headerIcons[t];if(c===void 0)return;f=document.createElement("canvas");const h=f.getContext("2d");if(h===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(c({fgColor:d,bgColor:u}))}`,this.spriteMap.set(m,f);const w=v.decode();if(w===void 0)return;this.inFlight++,w.then(()=>{h.drawImage(v,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,g,g,i,r,s,s),a<1&&(o.globalAlpha=1)}}const Nn={};let Ct=null;function Br(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Kn(e){const t=e.toLowerCase().trim();if(Nn[t]!==void 0)return Nn[t];Ct=Ct||Br(),Ct.style.color="#000",Ct.style.color=t;const n=getComputedStyle(Ct).color;Ct.style.color="#fff",Ct.style.color=t;const o=getComputedStyle(Ct).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),Nn[t]=i,i}function cn(e,t){const[n,o,i]=Kn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Ro=new Map;function On(e,t){const n=`${e}-${t}`,o=Ro.get(n);if(o!==void 0)return o;const i=_e(e,t);return Ro.set(n,i),i}function _e(e,t){if(t===void 0)return e;const[n,o,i,r]=Kn(e);if(r===1)return e;const[s,l,a,u]=Kn(t),d=r+u*(1-r),g=(r*n+u*s*(1-r))/d,m=(r*o+u*l*(1-r))/d,f=(r*i+u*a*(1-r))/d;return`rgba(${g}, ${m}, ${f}, ${d})`}function fi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Fn(e,t,n,o,i,r,s,l,a){l=l??t;let u=t,d=e;const g=o-r;let m=!1;for(;u<n&&d<g;){const f=i(d);if(u+f>l&&a(u,d,f,!1,s&&d===o-1)===!0){m=!0;break}u+=f,d++}if(!m){u=n;for(let f=0;f<r;f++){d=o-1-f;const c=i(d);u-=c,a(u,d,c,!0,s&&d===o-1)}}}function Mt(e,t,n,o,i,r,s,l){let a=0,u=0;const d=r+i,g=s===0?0:e.slice(-s).reduce((m,f)=>m+f.width,0);for(let m=0;m<e.length-s;m++){const f=e[m],c=f.sticky?u:a+o;if(l(f,c,d,f.sticky?0:u,g,n)===!0)break;a+=f.width,u+=f.sticky?f.width:0}a=t;for(let m=0;m<s;m++){const f=e[e.length-1-m],c=a-f.width;a-=f.width,l(f,c,d,u,g,n)}}function hi(e,t,n,o,i,r){let s=0,l=0;const a=i===0?[]:e.slice(-i),u=a.reduce((d,g)=>d+g.width,0);t-=u;for(let d=0;d<e.length-i;d++){const g=e[d];let m=d+1,f=g.width;for(g.sticky&&(l+=f);m<e.length&&En(e[m].group,g.group)&&e[m].sticky===e[d].sticky;){const k=e[m];f+=k.width,m++,d++,k.sticky&&(l+=k.width)}const c=g.sticky?0:n,h=s+c,v=g.sticky?0:Math.max(0,l-h),w=Math.min(f-v,t-(h+v));r([g.sourceIndex,e[m-1].sourceIndex],g.group??"",h+v,0,w,o),s+=f}for(let d=0;d<a.length;d++){const g=a[d];let m=d+1,f=g.width;for(;m<a.length&&En(a[m].group,g.group)&&a[m].sticky===a[d].sticky;){const k=a[m];f+=k.width,m++,d++,k.sticky&&(l+=k.width)}const h=t+f-f,v=0,w=f-v;r([g.sourceIndex,a[m-1].sourceIndex],g.group??"",h+v,0,w,o),t+=w}}function gi(e,t,n,o,i,r,s){var m;const[l,a]=e;let u,d;const g=((m=s.find(f=>!f.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const f=Math.max(l,g);let c=t,h=o;for(let v=r.sourceIndex-1;v>=f;v--)c-=s[v].width,h+=s[v].width;for(let v=r.sourceIndex+1;v<=a;v++)h+=s[v].width;d={x:c,y:n,width:h,height:i}}if(g>l){const f=Math.min(a,g-1);let c=t,h=o;for(let v=r.sourceIndex-1;v>=l;v--)c-=s[v].width,h+=s[v].width;for(let v=r.sourceIndex+1;v<=f;v++)h+=s[v].width;u={x:c,y:n,width:h,height:i}}return[u,d]}function dl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const mi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function ul(){return mi}const fl=rn.createContext(mi);function $t(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=_e(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function hl(e,t,n,o){if(o==="any")return Pr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),gr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,s=n-e.y+1,l=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:s,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return a===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===s?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function ln(e,t,n,o,i,r,s,l){return e<=i+s&&i<=e+n&&t<=r+l&&r<=t+o}function Ot(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Pr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Hr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Ar(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,s=t+4,l=n+4,a=i-e.x,u=e.x+e.width-s,d=r-e.y,g=e.y+e.height-l,m=a>0?e.x+Math.floor(a/o)*o:e.x,f=u>0?e.x+e.width-Math.floor(u/o)*o:e.x+e.width,c=d>0?e.y+Math.floor(d/o)*o:e.y,h=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:c,width:f-m,height:h-c}}function Dr(e,t,n,o,i){const[r,s,l,a]=t,[u,d,g,m]=i,{x:f,y:c,width:h,height:v}=e,w=[];if(h<=0||v<=0)return w;const k=f+h,F=c+v,S=f<r,H=c<s,I=f+h>l,B=c+v>a,W=f>=r&&f<l||k>r&&k<=l||f<r&&k>l,P=c>=s&&c<a||F>s&&F<=a||c<s&&F>a;if(W&&P){const D=Math.max(f,r),C=Math.max(c,s),E=Math.min(k,l),p=Math.min(F,a);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:u,y:d,width:g-u+1,height:m-d+1}})}if(S&&H){const D=f,C=c,E=Math.min(k,r),p=Math.min(F,s);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:0,y:0,width:u+1,height:d+1}})}if(H&&W){const D=Math.max(f,r),C=c,E=Math.min(k,l),p=Math.min(F,s);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:u,y:0,width:g-u+1,height:d+1}})}if(H&&I){const D=Math.max(f,l),C=c,E=k,p=Math.min(F,s);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:g,y:0,width:n-g+1,height:d+1}})}if(S&&P){const D=f,C=Math.max(c,s),E=Math.min(k,r),p=Math.min(F,a);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:0,y:d,width:u+1,height:m-d+1}})}if(I&&P){const D=Math.max(f,l),C=Math.max(c,s),E=k,p=Math.min(F,a);w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:g,y:d,width:n-g+1,height:m-d+1}})}if(S&&B){const D=f,C=Math.max(c,a),E=Math.min(k,r),p=F;w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:0,y:m,width:u+1,height:o-m+1}})}if(B&&W){const D=Math.max(f,r),C=Math.max(c,a),E=Math.min(k,l),p=F;w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:u,y:m,width:g-u+1,height:o-m+1}})}if(I&&B){const D=Math.max(f,l),C=Math.max(c,a),E=k,p=F;w.push({rect:{x:D,y:C,width:E-D,height:p-C},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return w}const Rr={kind:le.Loading,allowOverlay:!1};function To(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w,k,F,S,H,I,B,W,P,A,D,C,E,p,x,$,V,K,de,ae){let ue=(H==null?void 0:H.size)??Number.MAX_SAFE_INTEGER;const me=performance.now();let Q=x.baseFontFull;e.font=Q;const Te={ctx:e},ke=[0,0],O=w>0?Yt(u,w,d):0;let ce,Ne;const ze=fi(S);return Mt(t,i,a,s,l,r,k,(q,Me,nt,ot,je,be)=>{const dt=Math.max(0,ot-Me),pt=Me+dt,Xe=r+1,se=q.stickyPosition==="right"?q.width-dt:Math.min(q.width-dt,i-Me-je),it=o-r-1;if(S.length>0){let ve=!1;for(let X=0;X<S.length;X++){const T=S[X];if(ln(pt,Xe,se,it,T.x,T.y,T.width,T.height)){ve=!0;break}}if(!ve)return}const he=()=>{e.save(),e.beginPath(),e.rect(pt,Xe,se,it),e.clip()},Ke=I.columns.hasIndex(q.sourceIndex),We=m(q.group??"").overrideTheme,Le=q.themeOverride===void 0&&We===void 0?x:$t(x,We,q.themeOverride),ye=Le.baseFontFull;ye!==Q&&(Q=ye,e.font=ye),he();let Ce;return Fn(be,nt,o,u,d,w,F,ze,(ve,X,T,De,oe)=>{var st,lt,At;if(X<0||(ke[0]=q.sourceIndex,ke[1]=X,H!==void 0&&!H.has(ke)))return;if(S.length>0){let ee=!1;for(let Ie=0;Ie<S.length;Ie++){const we=S[Ie];if(ln(Me,ve,q.width,T,we.x,we.y,we.width,we.height)){ee=!0;break}}if(!ee)return}const J=I.rows.hasIndex(X),Ge=c.hasIndex(X),pe=X<u?g(ke):Rr;let re=Me,G=q.width,Be=!1,$e=!1;if(pe.span!==void 0){const[ee,Ie]=pe.span,we=`${X},${ee},${Ie},${q.sticky}`;if(Ne===void 0&&(Ne=new Set),Ne.has(we)){ue--;return}else{const wt=gi(pe.span,Me,ve,q.width,T,q,n),qe=q.sticky?wt[0]:wt[1];if(!q.sticky&&wt[0]!==void 0&&($e=!0),qe!==void 0){re=qe.x,G=qe.width,Ne.add(we),e.restore(),Ce=void 0,e.save(),e.beginPath();const kt=Math.max(0,ot-qe.x);e.rect(qe.x+kt,ve,qe.width-kt,T),ce===void 0&&(ce=[]),ce.push({x:qe.x+kt,y:ve,width:qe.width-kt,height:T}),e.clip(),Be=!0}}}const Ye=f==null?void 0:f(X),Je=oe&&((st=q.trailingRowOptions)==null?void 0:st.themeOverride)!==void 0?(lt=q.trailingRowOptions)==null?void 0:lt.themeOverride:void 0,Ee=pe.themeOverride===void 0&&Ye===void 0&&Je===void 0?Le:$t(Le,Ye,Je,pe.themeOverride);e.beginPath();const rt=hr(ke,pe,I);let Oe=mr(ke,pe,I,v);const Vt=pe.span!==void 0&&I.columns.some(ee=>pe.span!==void 0&&ee>=pe.span[0]&&ee<=pe.span[1]);rt&&!h&&v?Oe=0:rt&&v&&(Oe=Math.max(Oe,1)),Vt&&Oe++,rt||(J&&Oe++,Ke&&!oe&&Oe++);const ut=pe.kind===le.Protected?Ee.bgCellMedium:Ee.bgCell;let xe;if((De||ut!==x.bgCell||q.sticky)&&(xe=_e(ut,xe)),Oe>0||Ge){Ge&&(xe=_e(Ee.bgHeader,xe));for(let ee=0;ee<Oe;ee++)xe=_e(Ee.accentLight,xe)}else if(B!==void 0){for(const ee of B)if(ee[0]===q.sourceIndex&&ee[1]===X){xe=_e(Ee.bgSearchResult,xe);break}}if(W!==void 0)for(let ee=0;ee<W.length;ee++){const Ie=W[ee],we=Ie.range;Ie.style!=="solid-outline"&&we.x<=q.sourceIndex&&q.sourceIndex<we.x+we.width&&we.y<=X&&X<we.y+we.height&&(xe=_e(Ie.color,xe))}let ft=!1;if(H!==void 0){const ee=ve+1,we=(De?ee+T-1:Math.min(ee+T-1,o-O))-ee;(we!==T-1||re+1<=ot)&&(ft=!0,e.save(),e.beginPath(),e.rect(re+1,ee,G-1,we),e.clip()),xe=xe===void 0?Ee.bgCell:_e(xe,Ee.bgCell)}const ge=q.sourceIndex===n.length-1,Ve=X===u-1;xe!==void 0&&(e.fillStyle=xe,Ce!==void 0&&(Ce.fillStyle=xe),H!==void 0?e.fillRect(re+1,ve+1,G-(ge?2:1),T-(Ve?2:1)):e.fillRect(re,ve,G,T)),pe.style==="faded"&&(e.globalAlpha=.6);let ht;for(let ee=0;ee<D.length;ee++){const Ie=D[ee];if(Ie.item[0]===q.sourceIndex&&Ie.item[1]===X){ht=Ie;break}}if(G>ae&&!$e){const ee=Ee.baseFontFull;ee!==Q&&(e.font=ee,Q=ee),Ce=bi(e,pe,q.sourceIndex,X,ge,Ve,re,ve,G,T,Oe>0,Ee,xe??Ee.bgCell,P,A,(ht==null?void 0:ht.hoverAmount)??0,C,p,me,E,Ce,$,V,K,de)}return ft&&e.restore(),pe.style==="faded"&&(e.globalAlpha=1),ue--,Be&&(e.restore(),(At=Ce==null?void 0:Ce.deprep)==null||At.call(Ce,Te),Ce=void 0,he(),Q=ye,e.font=ye),ue<=0}),e.restore(),ue<=0}),ce}const Jt=[0,0],Qt={x:0,y:0,width:0,height:0},zn=[void 0,()=>{}];let Gn=!1;function Tr(){Gn=!0}function bi(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w,k,F,S,H,I,B,W){var x,$;let P,A;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(P=v[1][0],A=v[1][1]);let D;Jt[0]=n,Jt[1]=o,Qt.x=s,Qt.y=l,Qt.width=a,Qt.height=u,zn[0]=I.getValue(Jt),zn[1]=V=>I.setValue(Jt,V),Gn=!1;const C={ctx:e,theme:g,col:n,row:o,cell:t,rect:Qt,highlighted:d,cellFillColor:m,hoverAmount:h,frameTime:k,hoverX:P,drawState:zn,hoverY:A,imageLoader:f,spriteManager:c,hyperWrapping:w,overrideCursor:P!==void 0?W:void 0,requestAnimationFrame:Tr},E=kr(C,t.lastUpdated,k,S,i,r),p=B(t);if(p!==void 0){(S==null?void 0:S.renderer)!==p&&((x=S==null?void 0:S.deprep)==null||x.call(S,C),S=void 0);const V=($=p.drawPrep)==null?void 0:$.call(p,C,S);F!==void 0&&!Qo(C.cell)?F(C,()=>p.draw(C,t)):p.draw(C,t),D=V===void 0?void 0:{deprep:V==null?void 0:V.deprep,fillStyle:V==null?void 0:V.fillStyle,font:V==null?void 0:V.font,renderer:p}}return(E||Gn)&&(H==null||H(Jt)),D}function ro(e,t,n,o,i,r,s,l,a=-20,u=-20,d=32,g="center",m="square"){const f=Math.floor(i+s/2),c=m==="circle"?1e4:t.roundingRadius??4;let h=ti(d,s,t.cellVerticalPadding),v=h/2;const w=ei(g,o,r,t.cellHorizontalPadding,h),k=Zo(w,f,h),F=ni(o+a,i+u,k);switch(n){case!0:{e.beginPath(),ct(e,w-h/2,f-h/2,h,h,c),m==="circle"&&(v*=.8,h*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(w-v+h/4.23,f-v+h/1.97),e.lineTo(w-v+h/2.42,f-v+h/1.44),e.lineTo(w-v+h/1.29,f-v+h/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Mn:case!1:{e.beginPath(),ct(e,w-h/2+.5,f-h/2+.5,h-1,h-1,c),e.lineWidth=1,e.strokeStyle=F?t.textDark:t.textMedium,e.stroke();break}case Qn:{e.beginPath(),ct(e,w-h/2,f-h/2,h,h,c),e.fillStyle=F?t.textMedium:t.textLight,e.fill(),m==="circle"&&(v*=.8,h*=.8),e.beginPath(),e.moveTo(w-h/3,f),e.lineTo(w+h/3,f),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Jn()}}function Wr(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w,k,F){var A,D,C,E;const S=s+l;if(S<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,S);const H=(A=o==null?void 0:o[0])==null?void 0:A[0],I=(D=o==null?void 0:o[0])==null?void 0:D[1],B=(C=o==null?void 0:o[1])==null?void 0:C[0],W=(E=o==null?void 0:o[1])==null?void 0:E[1],P=g.headerFontFull;e.font=P,Mt(t,i,0,r,0,S,F,(p,x,$,V,K)=>{var Me;if(v!==void 0&&!v.has([p.sourceIndex,-1]))return;const de=Math.max(0,V-x);let ae=p.stickyPosition==="right"?p.width-de:Math.min(p.width-de,i-x-K);e.save(),e.beginPath(),e.rect(x+de,l,ae,s),e.clip();const ue=h(p.group??"").overrideTheme,me=p.themeOverride===void 0&&ue===void 0?g:$t(g,ue,p.themeOverride);p.sticky===!0&&(e.fillStyle=me.bgHeader,e.fill()),me.bgHeader!==g.bgHeader&&(e.fillStyle=me.bgHeader,e.fill()),me!==g&&(e.font=me.headerFontFull);const Q=d.columns.hasIndex(p.sourceIndex),Te=a!==void 0||u||p.headerRowMarkerDisabled===!0,ke=!Te&&I===-1&&H===p.sourceIndex,O=Te?0:((Me=f.find(nt=>nt.item[0]===p.sourceIndex&&nt.item[1]===-1))==null?void 0:Me.hoverAmount)??0,ce=(d==null?void 0:d.current)!==void 0&&d.current.cell[0]===p.sourceIndex,Ne=Q?me.accentColor:ce?me.bgHeaderHasFocus:me.bgHeader,ze=n?l:0,q=p.sourceIndex===0?0:1;Q?(e.fillStyle=Ne,e.fillRect(x+q,ze,p.width-q,s)):(ce||O>0)&&(ae=p.stickyPosition==="right"?p.width-q:Math.min(p.width-q,i-x-K),e.beginPath(),e.rect(x+q,ze,ae,s),ce&&(e.fillStyle=me.bgHeaderHasFocus,e.fill()),O>0&&(e.globalAlpha=O,e.fillStyle=me.bgHeaderHovered,e.fill(),e.globalAlpha=1)),pi(e,x,ze,p.width,s,p,Q,me,ke,ke?B:void 0,ke?W:void 0,ce,O,m,w,k),e.restore()}),n&&Lr(e,t,i,r,l,o,g,m,f,c,h,v,F)}function Lr(e,t,n,o,i,r,s,l,a,u,d,g,m){const[c,h]=(r==null?void 0:r[0])??[];let v=0;hi(t,n,o,i,m,(w,k,F,S,H,I)=>{if(g!==void 0&&!g.hasItemInRectangle({x:w[0],y:-2,width:w[1]-w[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(F,S,H,I),e.clip();const B=d(k),W=(B==null?void 0:B.overrideTheme)===void 0?s:$t(s,B.overrideTheme),P=h===-2&&c!==void 0&&c>=w[0]&&c<=w[1],A=P?W.bgGroupHeaderHovered??W.bgHeaderHovered:W.bgGroupHeader??W.bgHeader;if(A!==s.bgHeader&&(e.fillStyle=A,e.fill()),e.fillStyle=W.textGroupHeader??W.textHeader,B!==void 0){let D=F;if(B.icon!==void 0&&(l.drawSprite(B.icon,"normal",e,D+8,(i-20)/2,20,W),D+=26),e.fillText(B.name,D+8,i/2+It(e,s.headerFontFull)),B.actions!==void 0&&P){const C=yi({x:F,y:S,width:H,height:I},B.actions);e.beginPath();const E=C[0].x-10,p=F+H-E;e.rect(E,0,p,i);const x=e.createLinearGradient(E,0,E+p,0),$=cn(A,0);x.addColorStop(0,$),x.addColorStop(10/p,A),x.addColorStop(1,A),e.fillStyle=x,e.fill(),e.globalAlpha=.6;const[V,K]=(r==null?void 0:r[1])??[-1,-1];for(let de=0;de<B.actions.length;de++){const ae=B.actions[de],ue=C[de],me=Ot(ue,V+F,K);me&&(e.globalAlpha=1),l.drawSprite(ae.icon,"normal",e,ue.x+ue.width/2-10,ue.y+ue.height/2-10,20,W),me&&(e.globalAlpha=.6)}e.globalAlpha=1}}F!==0&&u(w[0])&&(e.beginPath(),e.moveTo(F+.5,0),e.lineTo(F+.5,i),e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()),e.restore(),v=F+H}),e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()}const xn=30;function Nr(e,t,n,o,i){return{x:e+n-xn,y:Math.max(t,t+o/2-xn/2),width:xn,height:Math.min(xn,o)}}function yi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,s=26;for(let l=0;l<t.length;l++)n.push({x:o,y:i,width:s,height:r}),o+=26;return n}function Zt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function vi(e,t,n,o,i,r,s,l){var w;const a=s.cellHorizontalPadding,u=s.headerIconSize,d=Nr(n,o,i,r);let g=n+a;const m=t.icon===void 0?void 0:{x:g,y:o+(r-u)/2,width:u,height:u},f=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(u*1.3));const c={x:g,y:o,width:i-g,height:r};let h;if(t.indicatorIcon!==void 0){const k=e===void 0?((w=li(t.title,s.headerFontFull))==null?void 0:w.width)??0:_t(t.title,e,s.headerFontFull).width;c.width=k,g+=k+a,h={x:g,y:o+(r-u)/2,width:u,height:u}}const v=n+i/2;return{menuBounds:Zt(d,v,l),iconBounds:Zt(m,v,l),iconOverlayBounds:Zt(f,v,l),textBounds:Zt(c,v,l),indicatorIconBounds:Zt(h,v,l)}}function Wo(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const k=r.rowMarkerChecked;k!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const F=r.headerRowMarkerTheme!==void 0?$t(l,r.headerRowMarkerTheme):l;ro(e,F,k,t,n,o,i,!1,void 0,void 0,18,"center",r.rowMarker),k!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=s?l.textHeaderSelected:l.textHeader,w=r.hasMenu===!0&&(a||f&&s)&&h.menuBounds!==void 0;if(r.icon!==void 0&&h.iconBounds!==void 0){let k=s?"selected":"normal";r.style==="highlight"&&(k=s?"selected":"special"),m.drawSprite(r.icon,k,e,h.iconBounds.x,h.iconBounds.y,h.iconBounds.width,l),r.overlayIcon!==void 0&&h.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,s?"selected":"special",e,h.iconOverlayBounds.x,h.iconOverlayBounds.y,h.iconOverlayBounds.width,l)}if(w&&o>35){const F=c?35:o-35,S=c?35*.7:o-35*.7,H=F/o,I=S/o,B=e.createLinearGradient(t,0,t+o,0),W=cn(v,0);B.addColorStop(c?1:0,v),B.addColorStop(H,v),B.addColorStop(I,W),B.addColorStop(c?0:1,W),e.fillStyle=B}else e.fillStyle=v;if(c&&(e.textAlign="right"),h.textBounds!==void 0&&e.fillText(r.title,c?h.textBounds.x+h.textBounds.width:h.textBounds.x,n+i/2+It(e,l.headerFontFull)),c&&(e.textAlign="left"),r.indicatorIcon!==void 0&&h.indicatorIconBounds!==void 0&&(!w||!ln(h.menuBounds.x,h.menuBounds.y,h.menuBounds.width,h.menuBounds.height,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,h.indicatorIconBounds.height))){let k=s?"selected":"normal";r.style==="highlight"&&(k=s?"selected":"special"),m.drawSprite(r.indicatorIcon,k,e,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,l)}if(w&&h.menuBounds!==void 0){const k=h.menuBounds,F=u!==void 0&&d!==void 0&&Ot(k,u+t,d+n);if(F||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===qn.Triangle){e.beginPath();const S=k.x+k.width/2-5.5,H=k.y+k.height/2-3;Ir(e,[{x:S,y:H},{x:S+11,y:H},{x:S+5.5,y:H+6}],1),e.fillStyle=v,e.fill()}else if(r.menuIcon===qn.Dots){e.beginPath();const S=k.x+k.width/2,H=k.y+k.height/2;Cr(e,S,H),e.fillStyle=v,e.fill()}else{const S=k.x+(k.width-l.headerIconSize)/2,H=k.y+(k.height-l.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,S,H,l.headerIconSize,l)}F||(e.globalAlpha=1)}}function pi(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h){const v=to(r.title)==="rtl",w=vi(e,r,t,n,o,i,l,v);c!==void 0?c({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:s,hoverAmount:m,isHovered:a,hasSelectedCell:g,spriteManager:f,menuBounds:(w==null?void 0:w.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:u,hoverY:d},()=>Wo(e,t,n,o,i,r,s,l,a,u,d,m,f,h,v,w)):Wo(e,t,n,o,i,r,s,l,a,u,d,m,f,h,v,w)}function Or(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w,k,F){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const S=fi(w);Mt(t,o,a,s,l,r,h,(H,I,B,W,P,A)=>{if(H!==t[t.length-1])return;I+=H.width;const D=Math.max(I,W);D>o||(e.save(),e.beginPath(),e.rect(D,r+1,1e4,i-r-1),e.clip(),Fn(A,B,i,u,d,c,v,S,(C,E,p,x)=>{if(!x&&w.length>0&&!w.some(ae=>ln(I,C,1e4,p,ae.x,ae.y,ae.width,ae.height)))return;const $=m.hasIndex(E),V=f.hasIndex(E);e.beginPath();const K=g==null?void 0:g(E),de=K===void 0?F:$t(F,K);de.bgCell!==F.bgCell&&(e.fillStyle=de.bgCell,e.fillRect(I,C,1e4,p)),V&&(e.fillStyle=de.bgHeader,e.fillRect(I,C,1e4,p)),$&&(e.fillStyle=de.accentLight,e.fillRect(I,C,1e4,p))}),e.restore())})}function zr(e,t,n,o,i,r,s,l,a){let u=!1;for(const h of t)if(!h.sticky){u=s(h.sourceIndex);break}const d=a.horizontalBorderColor??a.borderColor,g=a.borderColor,[m,f]=u?Xt(t):[0,0];let c;if(m!==0&&(c=On(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=c,e.stroke()),f!==0){const h=g===d&&c!==void 0?c:On(d,a.bgCell);e.beginPath(),e.moveTo(n-f+.5,0),e.lineTo(n-f+.5,o),e.strokeStyle=h,e.stroke()}if(i>0){const h=g===d&&c!==void 0?c:On(d,a.bgCell),v=Yt(r,i,l);e.beginPath(),e.moveTo(0,o-v+.5),e.lineTo(n,o-v+.5),e.strokeStyle=h,e.stroke()}}const wi=(e,t,n)=>{let o=0,i=t,r=0,s=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),i=Math.max(i,l.x+l.width+1),r=Math.min(r,l.y-1),s=Math.max(s,l.y+l.height+1)}return{minX:o,maxX:i,minY:r,maxY:s}};function Xr(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c){var C;const h=c.bgCell,{minX:v,maxX:w,minY:k,maxY:F}=wi(l,r,s),S=[],H=s-Yt(f,m,u);let I=a,B=n,W=0;for(;I+i<H;){const E=I+i,p=u(B);if(E>=k&&E<=F-1){const x=d==null?void 0:d(B),$=x==null?void 0:x.bgCell;$!==void 0&&$!==h&&B>=f-m&&S.push({x:v,y:E,w:w-v,h:p,color:$})}I+=p,B<f-m&&(W=I),B++}let P=0;const A=Math.min(H,F)-W;if(A>0)for(let E=0;E<t.length;E++){const p=t[E];if(p.width===0)continue;const x=p.sticky?P:P+o,$=(C=p.themeOverride)==null?void 0:C.bgCell;$!==void 0&&$!==h&&x>=v&&x<=w&&g(E+1)&&S.push({x,y:W,w:p.width,h:A,color:$}),P+=p.width}if(S.length===0)return;let D;e.beginPath();for(let E=S.length-1;E>=0;E--){const p=S[E];D===void 0?D=p.color:p.color!==D&&(e.fillStyle=D,e.fill(),e.beginPath(),D=p.color),e.rect(p.x,p.y,p.w,p.h)}D!==void 0&&(e.fillStyle=D,e.fill()),e.beginPath()}function Lo(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w=!1){var E;if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,s);for(const p of a)e.rect(p.x+1,p.y+1,p.width-1,p.height-1);e.clip("evenodd")}const k=v.horizontalBorderColor??v.borderColor,F=v.borderColor,{minX:S,maxX:H,minY:I,maxY:B}=wi(l,r,s),W=[];e.beginPath();let P=.5;for(let p=0;p<t.length;p++){const x=t[p];if(x.width===0)continue;if((E=t[p+1])!=null&&E.sticky&&t[p+1].stickyPosition!=="left")break;P+=x.width;const $=x.sticky?P:P+o;$>=S&&$<=H&&f(p+1)&&W.push({x1:$,y1:Math.max(u,I),x2:$,y2:Math.min(s,B),color:F})}let A=r+.5;for(let p=t.length-1;p>=0;p--){const x=t[p];if(x.width===0)continue;if(!x.sticky)break;A-=x.width;const $=A;$>=S&&$<=H&&f(p+1)&&W.push({x1:$,y1:Math.max(u,I),x2:$,y2:Math.min(s,B),color:F})}let D=s+.5;for(let p=h-c;p<h;p++){const x=g(p);D-=x,W.push({x1:S,y1:D,x2:H,y2:D,color:k})}if(w!==!0){let p=d+.5,x=n;const $=D;for(;p+i<$;){const V=p+i;if(V>=I&&V<=B-1){const K=m==null?void 0:m(x);W.push({x1:S,y1:V,x2:H,y2:V,color:(K==null?void 0:K.horizontalBorderColor)??(K==null?void 0:K.borderColor)??k})}p+=g(x),x++}}const C=Ji(W,p=>p.color);for(const p of Object.keys(C)){e.strokeStyle=p;for(const x of C[p])e.moveTo(x.x1,x.y1),e.lineTo(x.x2,x.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function $r(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w,k){const F=[];e.imageSmoothingEnabled=!1;const S=Math.min(i.cellYOffset,s),H=Math.max(i.cellYOffset,s);let I=0;if(typeof w=="number")I+=(H-S)*w;else for(let x=S;x<H;x++)I+=w(x);s>i.cellYOffset&&(I=-I),I+=a-i.translateY;const B=Math.min(i.cellXOffset,r),W=Math.max(i.cellXOffset,r);let P=0;for(let x=B;x<W;x++)P+=h[x].width;r>i.cellXOffset&&(P=-P),P+=l-i.translateX;const[A,D]=Xt(v);if(P!==0&&I!==0)return{regions:[]};const C=u>0?Yt(m,u,w):0,E=d-A-Math.abs(P)-D,p=g-f-C-Math.abs(I)-1;if(E>150&&p>150){const x={sx:0,sy:0,sw:d*c,sh:g*c,dx:0,dy:0,dw:d*c,dh:g*c};if(I>0?(x.sy=(f+1)*c,x.sh=p*c,x.dy=(I+f+1)*c,x.dh=p*c,F.push({x:0,y:f,width:d,height:I+1})):I<0&&(x.sy=(-I+f+1)*c,x.sh=p*c,x.dy=(f+1)*c,x.dh=p*c,F.push({x:0,y:g+I-C,width:d,height:-I+C})),P>0?(x.sx=A*c,x.sw=E*c,x.dx=(P+A)*c,x.dw=E*c,F.push({x:A-1,y:0,width:P+2,height:g})):P<0&&(x.sx=(A-P)*c,x.sw=E*c,x.dx=A*c,x.dw=E*c,F.push({x:d+P-D,y:0,width:-P+D,height:g})),e.setTransform(1,0,0,1,0,0),k){if(A>0&&P!==0&&I===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const $=A*c,V=g*c;e.drawImage(t,0,0,$,V,0,0,$,V)}if(D>0&&P!==0&&I===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const $=(d-D)*c,V=D*c,K=g*c;e.drawImage(t,$,0,V,K,$,0,V,K)}if(C>0&&P===0&&I!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const $=(g-C)*c,V=d*c,K=C*c;e.drawImage(t,0,$,V,K,0,$,V,K)}}e.drawImage(t,x.sx,x.sy,x.sw,x.sh,x.dx,x.dy,x.dw,x.dh),e.scale(c,c)}return e.imageSmoothingEnabled=!0,{regions:F}}function Yr(e,t,n,o,i,r,s,l,a,u,d){const g=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||Mt(a,r,n,o,i,l,d,(m,f,c,h)=>{if(m.sourceIndex===u){const v=Math.max(f,h)+1;return g.push({x:v,y:0,width:r-v,height:s}),!0}}),g}function _r(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(zt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:s,...l}=i,{width:a,...u}=r;if(!zt(l,u))return!1;n=o}return n===void 0?!0:n}return!0}function No(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h){const v=c==null?void 0:c.filter(A=>A.style!=="no-outline"),w=typeof a=="number"?a:a[0],k=typeof a=="number"?0:a[1];if(v===void 0||v.length===0)return;const[F,S]=Xt(l),H=Yt(f,m,g),I=[w,0,l.length-k,f-m],B=[F,0,t-S,n-H],W=v.map(A=>{const D=A.range,C=A.style??"dashed";return Dr(D,I,t,n,B).map(E=>{const p=E.rect,x=jn(p.x,p.y,t,n,d,u+d,o,i,r,s,f,a,m,l,g),$=p.width===1&&p.height===1?x:jn(p.x+p.width-1,p.y+p.height-1,t,n,d,u+d,o,i,r,s,f,a,m,l,g);return p.x+p.width>=l.length&&($.width-=1),p.y+p.height>=f&&($.height-=1),{color:A.color,style:C,clip:E.clip,rect:Ar({x:x.x,y:x.y,width:$.x+$.width-x.x,height:$.y+$.height-x.y},t,n,8)}})}),P=()=>{e.lineWidth=1;let A=!1;for(const D of W)for(const C of D)if((C==null?void 0:C.rect)!==void 0&&ln(0,0,t,n,C.rect.x,C.rect.y,C.rect.width,C.rect.height)){const E=A,p=!Hr(C.clip,C.rect);e.beginPath(),p&&(e.save(),e.rect(C.clip.x,C.clip.y,C.clip.width,C.clip.height),e.clip()),C.style==="dashed"&&!A?(e.setLineDash([5,3]),A=!0):(C.style==="solid"||C.style==="solid-outline")&&A&&(e.setLineDash([]),A=!1),e.strokeStyle=C.style==="solid-outline"?_e(_e(C.color,h.borderColor),h.bgCell):cn(C.color,1),e.closePath(),e.strokeRect(C.rect.x+.5,C.rect.y+.5,C.rect.width-1,C.rect.height-1),p&&(e.restore(),A=E)}A&&e.setLineDash([])};return P(),P}function Oo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Xn(e,t,n,o,i,r,s,l,a,u,d,g,m,f,c,h,v,w){if(d.current===void 0)return;const k=d.current.range,F=d.current.cell,S=[k.x+k.width-1,k.y+k.height-1];if(F[1]>=w&&S[1]>=w||!s.some(x=>x.sourceIndex===F[0]||x.sourceIndex===S[0]))return;const[I,B]=d.current.cell,W=m(d.current.cell),P=W.span??[I,I],A=B>=w-f,D=f>0&&!A?Yt(w,f,g)-1:0,C=S[1];let E;if(Mt(s,t,o,i,r,u,c,(x,$,V,K,de,ae)=>{if(x.sticky&&I>x.sourceIndex)return;const ue=x.sourceIndex<P[0],me=x.sourceIndex>P[1],Q=x.sourceIndex===S[0];if(!(!Q&&(ue||me)))return Fn(ae,V,n,w,g,f,h,void 0,(Te,ke,O)=>{if(ke!==B&&ke!==C)return;let ce=$,Ne=x.width;if(W.span!==void 0){const q=gi(W.span,$,Te,x.width,O,x,l),Me=x.sticky?q[0]:q[1];Me!==void 0&&(ce=Me.x,Ne=Me.width)}return ke===C&&Q&&v&&(E=()=>{var q;K>ce&&!x.sticky&&(e.beginPath(),e.rect(K,0,t-K,n),e.clip()),e.beginPath(),e.rect(ce+Ne-4,Te+O-4,4,4),e.fillStyle=((q=x.themeOverride)==null?void 0:q.accentColor)??a.accentColor,e.fill()}),E!==void 0}),E!==void 0}),E===void 0)return;const p=()=>{e.save(),e.beginPath(),e.rect(0,u,t,n-u-D),e.clip(),E==null||E(),e.restore()};return p(),p}function Vr(e,t,n,o,i,r,s,l,a,u){u===void 0||u.size===0||(e.beginPath(),hi(t,n,r,o,a,(d,g,m,f,c,h)=>{u.hasItemInRectangle({x:d[0],y:-2,width:d[1]-d[0]+1,height:1})&&e.rect(m,f,c,h)}),Mt(t,n,l,r,s,i,a,(d,g,m,f,c)=>{const h=Math.max(0,f-g),v=g+h+1,w=d.stickyPosition==="right"?d.width-h:Math.min(d.width-h-1,n-g-c);u.has([d.sourceIndex,-1])&&e.rect(v,o,w,i-o)}),e.clip())}function qr(e,t,n,o,i,r,s,l,a,u,d,g){let m=0;return Mt(e,n,s,i,r,o,g,(f,c,h,v,w,k)=>(Fn(k,h,t,l,a,u,d,void 0,(F,S,H,I)=>{I||(m=Math.max(S,m))}),!0)),m}function zo(e,t){var ft;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:s,cellYOffset:l,translateX:a,translateY:u,mappedColumns:d,enableGroups:g,freezeColumns:m,dragAndDropState:f,theme:c,drawFocus:h,headerHeight:v,groupHeaderHeight:w,disabledRows:k,rowHeight:F,verticalBorder:S,overrideCursor:H,isResizing:I,selection:B,fillHandle:W,freezeTrailingRows:P,rows:A,getCellContent:D,getGroupDetails:C,getRowThemeOverride:E,isFocused:p,drawHeaderCallback:x,prelightCells:$,drawCellCallback:V,highlightRegions:K,resizeCol:de,imageLoader:ae,lastBlitData:ue,hoverValues:me,hyperWrapping:Q,hoverInfo:Te,spriteManager:ke,maxScaleFactor:O,hasAppendRow:ce,touchMode:Ne,enqueue:ze,renderStateProvider:q,getCellRenderer:Me,renderStrategy:nt,bufferACtx:ot,bufferBCtx:je,damage:be,minimumCellWidth:dt,resizeIndicator:pt}=e;if(i===0||r===0)return;const Xe=nt==="double-buffer",se=Math.min(O,Math.ceil(window.devicePixelRatio??1)),it=typeof m=="number"?m:m[0],he=typeof m=="number"?0:m[1],Ke=nt!=="direct"&&_r(e,t),We=n.canvas;(We.width!==i*se||We.height!==r*se)&&(We.width=i*se,We.height=r*se,We.style.width=i+"px",We.style.height=r+"px");const Le=o.canvas,ye=g?w+v:v,Ce=ye+1;(Le.width!==i*se||Le.height!==Ce*se)&&(Le.width=i*se,Le.height=Ce*se,Le.style.width=i+"px",Le.style.height=Ce+"px");const ve=ot.canvas,X=je.canvas;Xe&&(ve.width!==i*se||ve.height!==r*se)&&(ve.width=i*se,ve.height=r*se,ue.current!==void 0&&(ue.current.aBufferScroll=void 0)),Xe&&(X.width!==i*se||X.height!==r*se)&&(X.width=i*se,X.height=r*se,ue.current!==void 0&&(ue.current.bBufferScroll=void 0));const T=ue.current;if(Ke===!0&&s===(T==null?void 0:T.cellXOffset)&&l===(T==null?void 0:T.cellYOffset)&&a===(T==null?void 0:T.translateX)&&u===(T==null?void 0:T.translateY))return;let De=null;Xe&&(De=n);const oe=o;let J;Xe?be!==void 0?J=(T==null?void 0:T.lastBuffer)==="b"?je:ot:J=(T==null?void 0:T.lastBuffer)==="b"?ot:je:J=n;const Ge=J.canvas,pe=Xe?Ge===ve?X:ve:We,re=typeof F=="number"?()=>F:F;oe.save(),J.save(),oe.beginPath(),J.beginPath(),oe.textBaseline="middle",J.textBaseline="middle",se!==1&&(oe.scale(se,se),J.scale(se,se));const G=Cn(d,s,i,m,f,a);let Be=[];const $e=h&&((ft=B.current)==null?void 0:ft.cell[1])===l&&u===0;let Ye=!1;if(K!==void 0){for(const ge of K)if(ge.style!=="no-outline"&&ge.range.y===l&&u===0){Ye=!0;break}}const Je=()=>{Wr(oe,G,g,Te,i,a,v,w,f,I,B,c,ke,me,S,C,be,x,Ne,he),Lo(oe,G,l,a,u,i,r,void 0,void 0,w,ye,re,E,S,P,A,c,!0),oe.beginPath(),oe.moveTo(0,Ce-.5),oe.lineTo(i,Ce-.5),oe.strokeStyle=_e(c.headerBottomBorderColor??c.horizontalBorderColor??c.borderColor,c.bgHeader),oe.stroke(),Ye&&No(oe,i,r,s,l,a,u,d,m,v,w,F,P,A,K,c),$e&&Xn(oe,i,r,l,a,u,G,d,c,ye,B,re,D,P,he,ce,W,A)};if(be!==void 0){const ge=G[G.length-1].sourceIndex+1,Ve=be.hasItemInRegion([{x:s,y:-2,width:ge,height:2},{x:s,y:l,width:ge,height:300},{x:0,y:l,width:it,height:300},{x:0,y:-2,width:it,height:2},{x:s,y:A-P,width:ge,height:P,when:P>0},{x:ge-he,y:l,width:he,height:300},{x:ge-he,y:-2,width:he,height:2}]),ht=st=>{To(st,G,d,r,i,ye,a,u,l,A,re,D,C,E,k,p,h,P,he,ce,Be,be,B,$,K,ae,ke,me,Te,V,Q,c,ze,q,Me,H,dt);const lt=B.current;W&&h&&lt!==void 0&&be.has(ii(lt.range))&&Xn(st,i,r,l,a,u,G,d,c,ye,B,re,D,P,he,ce,W,A)};Ve&&(ht(J),De!==null&&(De.save(),De.scale(se,se),De.textBaseline="middle",ht(De),De.restore()),be.hasHeader()&&(Vr(oe,G,i,w,ye,a,u,l,he,be),Je())),J.restore(),oe.restore();return}if((Ke!==!0||s!==(T==null?void 0:T.cellXOffset)||a!==(T==null?void 0:T.translateX)||$e!==(T==null?void 0:T.mustDrawFocusOnHeader)||Ye!==(T==null?void 0:T.mustDrawHighlightRingsOnHeader))&&Je(),Ke===!0){bt(pe!==void 0&&T!==void 0);const{regions:ge}=$r(J,pe,pe===ve?T.aBufferScroll:T.bBufferScroll,pe===ve?T.bBufferScroll:T.aBufferScroll,T,s,l,a,u,P,i,r,A,ye,se,d,G,F,Xe);Be=ge}else Ke!==!1&&(bt(T!==void 0),Be=Yr(T,s,l,a,u,i,r,ye,G,Ke,he));zr(J,G,i,r,P,A,S,re,c);const Ee=No(J,i,r,s,l,a,u,d,m,v,w,F,P,A,K,c),rt=h?Xn(J,i,r,l,a,u,G,d,c,ye,B,re,D,P,he,ce,W,A):void 0;if(J.fillStyle=c.bgCell,Be.length>0){J.beginPath();for(const ge of Be)J.rect(ge.x,ge.y,ge.width,ge.height);J.clip(),J.fill(),J.beginPath()}else J.fillRect(0,0,i,r);const Oe=To(J,G,d,r,i,ye,a,u,l,A,re,D,C,E,k,p,h,P,he,ce,Be,be,B,$,K,ae,ke,me,Te,V,Q,c,ze,q,Me,H,dt);Or(J,G,d,i,r,ye,a,u,l,A,re,E,B.rows,k,P,he,ce,Be,be,c),Xr(J,G,l,a,u,i,r,Be,ye,re,E,S,P,A,c),Lo(J,G,l,a,u,i,r,Be,Oe,w,ye,re,E,S,P,A,c),Ee==null||Ee(),rt==null||rt(),I&&pt!=="none"&&Mt(G,i,0,a,0,ye,he,(ge,Ve)=>ge.sourceIndex===de?(Oo(oe,Ve+ge.width,0,ye+1,_e(c.resizeIndicatorColor??c.accentLight,c.bgHeader)),pt==="full"&&Oo(J,Ve+ge.width,ye,r,_e(c.resizeIndicatorColor??c.accentLight,c.bgCell)),!0):!1),De!==null&&(De.fillStyle=c.bgCell,De.fillRect(0,0,i,r),De.drawImage(J.canvas,0,0));const Vt=qr(G,r,i,ye,a,u,l,A,re,P,ce,he);ae==null||ae.setWindow({x:s,y:l,width:G.length,height:Vt-l},m,Array.from({length:P},(ge,Ve)=>A-1-Ve));const ut=T!==void 0&&(s!==T.cellXOffset||a!==T.translateX),xe=T!==void 0&&(l!==T.cellYOffset||u!==T.translateY);ue.current={cellXOffset:s,cellYOffset:l,translateX:a,translateY:u,mustDrawFocusOnHeader:$e,mustDrawHighlightRingsOnHeader:Ye,lastBuffer:Xe?Ge===ve?"a":"b":void 0,aBufferScroll:Ge===ve?[ut,xe]:T==null?void 0:T.aBufferScroll,bBufferScroll:Ge===X?[ut,xe]:T==null?void 0:T.bBufferScroll},J.restore(),oe.restore()}const Ur=80;function jr(e){const t=e-1;return t*t*t+1}class Kr{constructor(t){ne(this,"currentHoveredItem");ne(this,"leavingItems",[]);ne(this,"lastAnimationTime");ne(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>Sn(o.item,t.item))||this.leavingItems.push(t)});ne(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>Sn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ne(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ne(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ne(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:jr(t.hoverAmount)})));ne(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Ur;for(const r of this.leavingItems)r.hoverAmount=tn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=tn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ne(this,"setHovered",t=>{var n;if(!Sn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Gr{constructor(t){ne(this,"fn");ne(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function so(e){return new Gr(e)}const Jr=so(()=>window.navigator.userAgent.includes("Firefox")),Xo=so(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),gl=so(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Qr(e){const t=y.useRef([]),n=y.useRef(0),o=y.useRef(e);o.current=e;const i=y.useCallback(()=>{const r=()=>window.requestAnimationFrame(s),s=()=>{const l=t.current.map(io);t.current=[],o.current(new on(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:s)},[]);return y.useCallback(r=>{t.current.length===0&&i();const s=tt(r[0],r[1]);t.current.includes(s)||t.current.push(s)},[i])}const Ht="header",Nt="group-header",$o="out-of-bounds";var en=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(en||{});function Zr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Yo=6,es=(e,t)=>{if(e.kind===le.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},ts=(e,t)=>{var Io,Mo;const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:s,cellYOffset:l,headerHeight:a,fillHandle:u=!1,groupHeaderHeight:d,rowHeight:g,rows:m,getCellContent:f,getRowThemeOverride:c,onHeaderMenuClick:h,onHeaderIndicatorClick:v,enableGroups:w,isFilling:k,onCanvasFocused:F,onCanvasBlur:S,isFocused:H,selection:I,freezeColumns:B,onContextMenu:W,freezeTrailingRows:P,fixedShadowX:A=!0,fixedShadowY:D=!0,drawFocusRing:C,onMouseDown:E,onMouseUp:p,onMouseMoveRaw:x,onMouseMove:$,onItemHovered:V,dragAndDropState:K,firstColAccessible:de,onKeyDown:ae,onKeyUp:ue,highlightRegions:me,canvasRef:Q,onDragStart:Te,onDragEnd:ke,eventTargetRef:O,isResizing:ce,resizeColumn:Ne,isDragging:ze,isDraggable:q=!1,allowResize:Me,disabledRows:nt,hasAppendRow:ot,getGroupDetails:je,theme:be,prelightCells:dt,headerIcons:pt,verticalBorder:Xe,drawCell:se,drawHeader:it,onCellFocused:he,onDragOverCell:Ke,onDrop:We,onDragLeave:Le,imageWindowLoader:ye,smoothScrollX:Ce=!1,smoothScrollY:ve=!1,experimental:X,getCellRenderer:T,resizeIndicator:De="full"}=e,oe=e.translateX??0,J=e.translateY??0,Ge=typeof B=="number"?B:B[0],pe=typeof B=="number"?0:B[1],re=Math.max(Ge,Math.min(r.length-1,s)),G=y.useRef(null),Be=y.useRef((X==null?void 0:X.eventTarget)??window),$e=Be.current,Ye=ye,Je=y.useRef(),[Ee,rt]=y.useState(!1),Oe=y.useRef([]),Vt=y.useRef(),[ut,xe]=y.useState(),[ft,ge]=y.useState(),Ve=y.useRef(null),[ht,st]=y.useState(),[lt,At]=y.useState(!1),ee=y.useRef(lt);ee.current=lt;const Ie=y.useMemo(()=>new Fr(pt,()=>{un.current=void 0,Ut.current()}),[pt]),we=w?d+a:a,wt=y.useRef(-1),qe=((X==null?void 0:X.enableFirefoxRescaling)??!1)&&Jr.value,kt=((X==null?void 0:X.enableSafariRescaling)??!1)&&Xo.value;y.useLayoutEffect(()=>{window.devicePixelRatio===1||!qe&&!kt||(wt.current!==-1&&rt(!0),window.clearTimeout(wt.current),wt.current=window.setTimeout(()=>{rt(!1),wt.current=-1},200))},[l,re,oe,J,qe,kt]);const Se=fr(r,B),qt=y.useMemo(()=>A?Xt(Se,K):[0,0],[A,Se,K]),Pe=y.useCallback((b,M,z)=>{const N=b.getBoundingClientRect();if(M>=Se.length||z>=m)return;const R=N.width/n,L=jn(M,z,n,o,d,we,re,l,oe,J,m,B,P,Se,g);return R!==1&&(L.x*=R,L.y*=R,L.width*=R,L.height*=R),L.x+=N.x,L.y+=N.y,L},[n,o,d,we,re,l,oe,J,m,B,P,Se,g]),Re=y.useCallback((b,M,z,N)=>{const R=b.getBoundingClientRect(),L=R.width/n,U=(M-R.left)/L,j=(z-R.top)/L,Y=5,He=Cn(Se,re,n,B,void 0,oe);let _=0,ie=0;N instanceof MouseEvent&&(_=N.button,ie=N.buttons);const Z=br(U,He,B,n,oe),te=yr(j,o,w,a,d,m,g,l,J,P),Ae=(N==null?void 0:N.shiftKey)===!0,Qe=(N==null?void 0:N.ctrlKey)===!0,Fe=(N==null?void 0:N.metaKey)===!0,gt=N!==void 0&&!(N instanceof MouseEvent)||(N==null?void 0:N.pointerType)==="touch",xt=[U<0?-1:n<U?1:0,j<we?-1:o<j?1:0];let Ze;if(Z===-1||j<0||U<0||te===void 0||U>n||j>o){const fe=U>n?1:U<0?-1:0,et=j>o?1:j<0?-1:0;let at=fe*2,Kt=et*2;fe===0&&(at=Z===-1?en.EndPadding:en.Center),et===0&&(Kt=te===void 0?en.EndPadding:en.Center);let St=!1;if(Z===-1&&te===-1){const Gt=Pe(b,Se.length-1,-1);bt(Gt!==void 0),St=M<Gt.x+Gt.width+Y}const Ln=U>n&&U<n+Po()||j>o&&j<o+Po();Ze={kind:$o,location:[Z!==-1?Z:U<0?0:Se.length-1,te??m-1],region:[at,Kt],shiftKey:Ae,ctrlKey:Qe,metaKey:Fe,isEdge:St,isTouch:gt,button:_,buttons:ie,scrollEdge:xt,isMaybeScrollbar:Ln}}else if(te<=-1){let fe=Pe(b,Z,te);bt(fe!==void 0);let et=fe!==void 0&&fe.x+fe.width-M<=Y;const at=Z-1;M-fe.x<=Y&&at>=0&&Z<Se.length-pe?(et=!0,fe=Pe(b,at,te),bt(fe!==void 0),Ze={kind:w&&te===-2?Nt:Ht,location:[at,te],bounds:fe,group:Se[at].group??"",isEdge:et,shiftKey:Ae,ctrlKey:Qe,metaKey:Fe,isTouch:gt,localEventX:M-fe.x,localEventY:z-fe.y,button:_,buttons:ie,scrollEdge:xt}):Ze={kind:w&&te===-2?Nt:Ht,group:Se[Z].group??"",location:[Z,te],bounds:fe,isEdge:et,shiftKey:Ae,ctrlKey:Qe,metaKey:Fe,isTouch:gt,localEventX:M-fe.x,localEventY:z-fe.y,button:_,buttons:ie,scrollEdge:xt}}else{const fe=Pe(b,Z,te);bt(fe!==void 0);const et=fe!==void 0&&fe.x+fe.width-M<Y;let at=!1;if(u&&I.current!==void 0){const Kt=ii(I.current.range),St=Pe(b,Kt[0],Kt[1]);if(St!==void 0){const Ln=St.x+St.width-2,Gt=St.y+St.height-2;at=Math.abs(Ln-M)<Yo&&Math.abs(Gt-z)<Yo}}Ze={kind:"cell",location:[Z,te],bounds:fe,isEdge:et,shiftKey:Ae,ctrlKey:Qe,isFillHandle:at,metaKey:Fe,isTouch:gt,localEventX:M-fe.x,localEventY:z-fe.y,button:_,buttons:ie,scrollEdge:xt}}return Ze},[n,Se,re,oe,o,w,a,d,m,g,l,J,P,Pe,u,I,we,B,pe]),[Et]=ut??[],lo=y.useRef(()=>{}),Dt=y.useRef(ut);Dt.current=ut;const[Ft,Bt]=y.useMemo(()=>{const b=document.createElement("canvas"),M=document.createElement("canvas");return b.style.display="none",b.style.opacity="0",b.style.position="fixed",M.style.display="none",M.style.opacity="0",M.style.position="fixed",[b.getContext("2d",{alpha:!1}),M.getContext("2d",{alpha:!1})]},[]);y.useLayoutEffect(()=>{if(!(Ft===null||Bt===null))return document.documentElement.append(Ft.canvas),document.documentElement.append(Bt.canvas),()=>{Ft.canvas.remove(),Bt.canvas.remove()}},[Ft,Bt]);const dn=y.useMemo(()=>new Mr,[]),ao=qe&&Ee?1:kt&&Ee?2:5,co=(X==null?void 0:X.disableMinimumCellWidth)===!0?1:10,un=y.useRef(),fn=y.useRef(null),hn=y.useRef(null),gn=y.useCallback(()=>{var U;const b=G.current,M=Ve.current;if(b===null||M===null||(fn.current===null&&(fn.current=b.getContext("2d",{alpha:!1}),b.width=0,b.height=0),hn.current===null&&(hn.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),fn.current===null||hn.current===null||Ft===null||Bt===null))return;let z=!1;const N=j=>{z=!0,st(j)},R=un.current,L={headerCanvasCtx:hn.current,canvasCtx:fn.current,bufferACtx:Ft,bufferBCtx:Bt,width:n,height:o,cellXOffset:re,cellYOffset:l,translateX:Math.round(oe),translateY:Math.round(J),mappedColumns:Se,enableGroups:w,freezeColumns:B,dragAndDropState:K,theme:be,headerHeight:a,groupHeaderHeight:d,disabledRows:nt??Un.empty(),rowHeight:g,verticalBorder:Xe,isResizing:ce,resizeCol:Ne,isFocused:H,selection:I,fillHandle:u,drawCellCallback:se,hasAppendRow:ot,overrideCursor:N,maxScaleFactor:ao,freezeTrailingRows:P,rows:m,drawFocus:C,getCellContent:f,getGroupDetails:je??(j=>({name:j})),getRowThemeOverride:c,drawHeaderCallback:it,prelightCells:dt,highlightRegions:me,imageLoader:Ye,lastBlitData:Vt,damage:Je.current,hoverValues:Oe.current,hoverInfo:Dt.current,spriteManager:Ie,scrolling:Ee,hyperWrapping:(X==null?void 0:X.hyperWrapping)??!1,touchMode:lt,enqueue:lo.current,renderStateProvider:dn,renderStrategy:(X==null?void 0:X.renderStrategy)??(Xo.value?"double-buffer":"single-buffer"),getCellRenderer:T,minimumCellWidth:co,resizeIndicator:De};L.damage===void 0?(un.current=L,zo(L,R)):zo(L,void 0),!z&&(L.damage===void 0||L.damage.has((U=Dt==null?void 0:Dt.current)==null?void 0:U[0]))&&st(void 0)},[Ft,Bt,n,o,re,l,oe,J,Se,w,B,K,be,a,d,nt,g,Xe,ce,ot,Ne,H,I,u,P,m,C,ao,f,je,c,se,it,dt,me,Ye,Ie,Ee,X==null?void 0:X.hyperWrapping,X==null?void 0:X.renderStrategy,lt,dn,T,co,De]),Ut=y.useRef(gn);y.useLayoutEffect(()=>{gn(),Ut.current=gn},[gn]),y.useLayoutEffect(()=>{(async()=>{var M;((M=document==null?void 0:document.fonts)==null?void 0:M.ready)!==void 0&&(await document.fonts.ready,un.current=void 0,Ut.current())})()},[]);const Rt=y.useCallback(b=>{Je.current=b,Ut.current(),Je.current=void 0},[]),Ci=Qr(Rt);lo.current=Ci;const uo=y.useCallback(b=>{Rt(new on(b.map(M=>M.cell)))},[Rt]);Ye.setCallback(Rt);const[Ii,Mi]=y.useState(!1),[mn,Tt]=Et??[],Ei=mn!==void 0&&Tt===-1,Fi=mn!==void 0&&Tt===-2;let fo=!1,ho=!1,bn=ht;if(bn===void 0&&mn!==void 0&&Tt!==void 0&&Tt>-1&&Tt<m){const b=f([mn,Tt],!0);fo=b.kind===sn.NewRow||b.kind===sn.Marker&&b.markerKind!=="number",ho=b.kind===le.Boolean&&Zn(b),bn=b.cursor}const go=ze?"grabbing":(ft??!1)||ce?"col-resize":Ii||k?"crosshair":bn!==void 0?bn:Ei||fo||ho||Fi?"pointer":"default",Pn=y.useMemo(()=>({contain:"strict",display:"block",cursor:go}),[go]),mo=y.useRef("default"),Hn=O==null?void 0:O.current;Hn!=null&&mo.current!==Pn.cursor&&(Hn.style.cursor=mo.current=Pn.cursor);const Wt=y.useCallback((b,M,z,N)=>{if(je===void 0)return;const R=je(b);if(R.actions!==void 0){const L=yi(M,R.actions);for(const[U,j]of L.entries())if(Ot(j,z+M.x,N+j.y))return R.actions[U]}},[je]),Lt=y.useCallback((b,M,z,N)=>{const R=Se[M];if(!ze&&!ce&&!(ft??!1)){const L=Pe(b,M,-1);bt(L!==void 0);const U=vi(void 0,R,L.x,L.y,L.width,L.height,be,to(R.title)==="rtl");if(R.hasMenu===!0&&U.menuBounds!==void 0&&Ot(U.menuBounds,z,N))return{area:"menu",bounds:U.menuBounds};if(R.indicatorIcon!==void 0&&U.indicatorIconBounds!==void 0&&Ot(U.indicatorIconBounds,z,N))return{area:"indicator",bounds:U.indicatorIconBounds}}},[Se,Pe,ft,ze,ce,be]),An=y.useRef(0),jt=y.useRef(),Dn=y.useRef(!1),bo=y.useCallback(b=>{const M=G.current,z=O==null?void 0:O.current;if(M===null||b.target!==M&&b.target!==z)return;Dn.current=!0;let N,R;if(b instanceof MouseEvent?(N=b.clientX,R=b.clientY):(N=b.touches[0].clientX,R=b.touches[0].clientY),b.target===z&&z!==null){const U=z.getBoundingClientRect();if(N>U.right||R>U.bottom)return}const L=Re(M,N,R,b);jt.current=L.location,L.isTouch&&(An.current=Date.now()),ee.current!==L.isTouch&&At(L.isTouch),!(L.kind===Ht&&Lt(M,L.location[0],N,R)!==void 0)&&(L.kind===Nt&&Wt(L.group,L.bounds,L.localEventX,L.localEventY)!==void 0||(E==null||E(L),!L.isTouch&&q!==!0&&q!==L.kind&&L.button<3&&L.button!==1&&b.preventDefault()))},[O,q,Re,Wt,Lt,E]);Ue("touchstart",bo,$e,!1),Ue("mousedown",bo,$e,!1);const yo=y.useRef(0),vo=y.useCallback(b=>{var ie,Z;const M=yo.current;yo.current=Date.now();const z=G.current;if(Dn.current=!1,p===void 0||z===null)return;const N=O==null?void 0:O.current,R=b.target!==z&&b.target!==N;let L,U,j=!0;if(b instanceof MouseEvent){if(L=b.clientX,U=b.clientY,j=b.button<3,b.pointerType==="touch")return}else L=b.changedTouches[0].clientX,U=b.changedTouches[0].clientY;let Y=Re(z,L,U,b);Y.isTouch&&An.current!==0&&Date.now()-An.current>500&&(Y={...Y,isLongTouch:!0}),M!==0&&Date.now()-M<(Y.isTouch?1e3:500)&&(Y={...Y,isDoubleClick:!0}),ee.current!==Y.isTouch&&At(Y.isTouch),!R&&b.cancelable&&j&&b.preventDefault();const[He]=Y.location,_=Lt(z,He,L,U);if(Y.kind===Ht&&_!==void 0){(Y.button!==0||((ie=jt.current)==null?void 0:ie[0])!==He||((Z=jt.current)==null?void 0:Z[1])!==-1)&&p(Y,!0);return}else if(Y.kind===Nt){const te=Wt(Y.group,Y.bounds,Y.localEventX,Y.localEventY);if(te!==void 0){Y.button===0&&te.onClick(Y);return}}p(Y,R)},[p,O,Re,Lt,Wt]);Ue("mouseup",vo,$e,!1),Ue("touchend",vo,$e,!1);const Bi=y.useCallback(b=>{var He,_;const M=G.current;if(M===null)return;const z=O==null?void 0:O.current,N=b.target!==M&&b.target!==z;let R,L,U=!0;b instanceof MouseEvent?(R=b.clientX,L=b.clientY,U=b.button<3):(R=b.changedTouches[0].clientX,L=b.changedTouches[0].clientY);const j=Re(M,R,L,b);ee.current!==j.isTouch&&At(j.isTouch),!N&&b.cancelable&&U&&b.preventDefault();const[Y]=j.location;if(j.kind===Ht){const ie=Lt(M,Y,R,L);ie!==void 0&&j.button===0&&((He=jt.current)==null?void 0:He[0])===Y&&((_=jt.current)==null?void 0:_[1])===-1&&(ie.area==="menu"?h==null||h(Y,ie.bounds):ie.area==="indicator"&&(v==null||v(Y,ie.bounds)))}else if(j.kind===Nt){const ie=Wt(j.group,j.bounds,j.localEventX,j.localEventY);ie!==void 0&&j.button===0&&ie.onClick(j)}},[O,Re,Lt,h,v,Wt]);Ue("click",Bi,$e,!1);const Pi=y.useCallback(b=>{const M=G.current,z=O==null?void 0:O.current;if(M===null||b.target!==M&&b.target!==z||W===void 0)return;const N=Re(M,b.clientX,b.clientY,b);W(N,()=>{b.cancelable&&b.preventDefault()})},[O,Re,W]);Ue("contextmenu",Pi,(O==null?void 0:O.current)??null,!1);const po=y.useCallback(b=>{Je.current=new on(b.map(M=>M.item)),Oe.current=b,Ut.current(),Je.current=void 0},[]),wo=y.useMemo(()=>new Kr(po),[po]),ko=y.useRef(wo);ko.current=wo,y.useLayoutEffect(()=>{const b=ko.current;if(Et===void 0||Et[1]<0){b.setHovered(Et);return}const M=f(Et,!0),z=T(M),N=z===void 0&&M.kind===le.Custom||(z==null?void 0:z.needsHover)!==void 0&&(typeof z.needsHover=="boolean"?z.needsHover:z.needsHover(M));b.setHovered(N?Et:void 0)},[f,T,Et]);const xo=y.useRef(),Hi=y.useCallback(b=>{var j;const M=G.current;if(M===null)return;const z=O==null?void 0:O.current,N=b.target!==M&&b.target!==z,R=Re(M,b.clientX,b.clientY,b);if(R.kind!=="out-of-bounds"&&N&&!Dn.current&&!R.isTouch)return;const L=(Y,He)=>{xe(_=>_===Y||(_==null?void 0:_[0][0])===(Y==null?void 0:Y[0][0])&&(_==null?void 0:_[0][1])===(Y==null?void 0:Y[0][1])&&((_==null?void 0:_[1][0])===(Y==null?void 0:Y[1][0])&&(_==null?void 0:_[1][1])===(Y==null?void 0:Y[1][1])||!He)?_:Y)};if(!Zr(R,xo.current))st(void 0),V==null||V(R),L(R.kind===$o?void 0:[R.location,[R.localEventX,R.localEventY]],!0),xo.current=R;else if(R.kind==="cell"||R.kind===Ht||R.kind===Nt){let Y=!1,He=!0;if(R.kind==="cell"){const ie=f(R.location);He=((j=T(ie))==null?void 0:j.needsHoverPosition)??ie.kind===le.Custom,Y=He}else Y=!0;const _=[R.location,[R.localEventX,R.localEventY]];L(_,He),Dt.current=_,Y&&Rt(new on([R.location]))}const U=R.location[0]>=(de?0:1);ge(R.kind===Ht&&R.isEdge&&U&&Me===!0),Mi(R.kind==="cell"&&R.isFillHandle),x==null||x(b),$(R)},[O,Re,de,Me,x,$,V,f,T,Rt]);Ue("mousemove",Hi,$e,!0);const Ai=y.useCallback(b=>{const M=G.current;if(M===null)return;let z,N;I.current!==void 0&&(z=Pe(M,I.current.cell[0],I.current.cell[1]),N=I.current.cell),ae==null||ae({bounds:z,stopPropagation:()=>b.stopPropagation(),preventDefault:()=>b.preventDefault(),cancel:()=>{},ctrlKey:b.ctrlKey,metaKey:b.metaKey,shiftKey:b.shiftKey,altKey:b.altKey,key:b.key,keyCode:b.keyCode,rawEvent:b,location:N})},[ae,I,Pe]),Di=y.useCallback(b=>{const M=G.current;if(M===null)return;let z,N;I.current!==void 0&&(z=Pe(M,I.current.cell[0],I.current.cell[1]),N=I.current.cell),ue==null||ue({bounds:z,stopPropagation:()=>b.stopPropagation(),preventDefault:()=>b.preventDefault(),cancel:()=>{},ctrlKey:b.ctrlKey,metaKey:b.metaKey,shiftKey:b.shiftKey,altKey:b.altKey,key:b.key,keyCode:b.keyCode,rawEvent:b,location:N})},[ue,I,Pe]),Ri=y.useCallback(b=>{if(G.current=b,Q!==void 0&&(Q.current=b),X!=null&&X.eventTarget)Be.current=X.eventTarget;else if(b===null)Be.current=window;else{const M=b.getRootNode();M===document&&(Be.current=window),Be.current=M}},[Q,X==null?void 0:X.eventTarget]),Ti=y.useCallback(b=>{const M=G.current;if(M===null||q===!1||ce){b.preventDefault();return}let z,N;const R=Re(M,b.clientX,b.clientY);if(q!==!0&&R.kind!==q){b.preventDefault();return}const L=(ie,Z)=>{z=ie,N=Z};let U,j,Y;const He=(ie,Z,te)=>{U=ie,j=Z,Y=te};let _=!1;if(Te==null||Te({...R,setData:L,setDragImage:He,preventDefault:()=>_=!0,defaultPrevented:()=>_}),!_&&z!==void 0&&N!==void 0&&b.dataTransfer!==null)if(b.dataTransfer.setData(z,N),b.dataTransfer.effectAllowed="copyLink",U!==void 0&&j!==void 0&&Y!==void 0)b.dataTransfer.setDragImage(U,j,Y);else{const[ie,Z]=R.location;if(Z!==void 0){const te=document.createElement("canvas"),Ae=Pe(M,ie,Z);bt(Ae!==void 0);const Qe=Math.ceil(window.devicePixelRatio??1);te.width=Ae.width*Qe,te.height=Ae.height*Qe;const Fe=te.getContext("2d");Fe!==null&&(Fe.scale(Qe,Qe),Fe.textBaseline="middle",Z===-1?(Fe.font=be.headerFontFull,Fe.fillStyle=be.bgHeader,Fe.fillRect(0,0,te.width,te.height),pi(Fe,0,0,Ae.width,Ae.height,Se[ie],!1,be,!1,void 0,void 0,!1,0,Ie,it,!1)):(Fe.font=be.baseFontFull,Fe.fillStyle=be.bgCell,Fe.fillRect(0,0,te.width,te.height),bi(Fe,f([ie,Z]),0,Z,!1,!1,0,0,Ae.width,Ae.height,!1,be,be.bgCell,Ye,Ie,1,void 0,!1,0,void 0,void 0,void 0,dn,T,()=>{}))),te.style.left="-100%",te.style.position="absolute",te.style.width=`${Ae.width}px`,te.style.height=`${Ae.height}px`,document.body.append(te),b.dataTransfer.setDragImage(te,Ae.width/2,Ae.height/2),window.setTimeout(()=>{te.remove()},0)}}else b.preventDefault()},[q,ce,Re,Te,Pe,be,Se,Ie,it,f,Ye,dn,T]);Ue("dragstart",Ti,(O==null?void 0:O.current)??null,!1,!1);const Rn=y.useRef(),Wi=y.useCallback(b=>{const M=G.current;if(We!==void 0&&b.preventDefault(),M===null||Ke===void 0)return;const z=Re(M,b.clientX,b.clientY),[N,R]=z.location,L=N-(de?0:1),[U,j]=Rn.current??[];(U!==L||j!==R)&&(Rn.current=[L,R],Ke([L,R],b.dataTransfer))},[de,Re,Ke,We]);Ue("dragover",Wi,(O==null?void 0:O.current)??null,!1,!1);const Li=y.useCallback(()=>{Rn.current=void 0,ke==null||ke()},[ke]);Ue("dragend",Li,(O==null?void 0:O.current)??null,!1,!1);const Ni=y.useCallback(b=>{const M=G.current;if(M===null||We===void 0)return;b.preventDefault();const z=Re(M,b.clientX,b.clientY),[N,R]=z.location,L=N-(de?0:1);We([L,R],b.dataTransfer)},[de,Re,We]);Ue("drop",Ni,(O==null?void 0:O.current)??null,!1,!1);const Oi=y.useCallback(()=>{Le==null||Le()},[Le]);Ue("dragleave",Oi,(O==null?void 0:O.current)??null,!1,!1);const So=y.useRef(I);So.current=I;const yn=y.useRef(null),Tn=y.useCallback(b=>{var M;G.current===null||!G.current.contains(document.activeElement)||(b===null&&So.current.current!==void 0?(M=Q==null?void 0:Q.current)==null||M.focus({preventScroll:!0}):b!==null&&b.focus({preventScroll:!0}),yn.current=b)},[Q]);y.useImperativeHandle(t,()=>({focus:()=>{var M;const b=yn.current;b===null||!document.contains(b)?(M=Q==null?void 0:Q.current)==null||M.focus({preventScroll:!0}):b.focus({preventScroll:!0})},getBounds:(b,M)=>{if(!(Q===void 0||Q.current===null))return Pe(Q.current,b??0,M??-1)},damage:uo,getMouseArgsForPosition:(b,M,z)=>{if(!(Q===void 0||Q.current===null))return Re(Q.current,b,M,z)}}),[Q,uo,Pe]);const Wn=y.useRef(),zi=ar(()=>{var j,Y,He;if(n<50||(X==null?void 0:X.disableAccessibilityTree)===!0)return null;let b=Cn(Se,re,n,B,K,oe);const M=de?0:-1;!de&&((j=b[0])==null?void 0:j.sourceIndex)===0&&(b=b.slice(1));const[z,N]=((Y=I.current)==null?void 0:Y.cell)??[],R=(He=I.current)==null?void 0:He.range,L=b.map(_=>_.sourceIndex),U=Qi(l,Math.min(m,l+i));return z!==void 0&&N!==void 0&&!(L.includes(z)&&U.includes(N))&&Tn(null),y.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Se.length+M},y.createElement("thead",{role:"rowgroup"},y.createElement("tr",{role:"row","aria-rowindex":1},b.map(_=>y.createElement("th",{role:"columnheader","aria-selected":I.columns.hasIndex(_.sourceIndex),"aria-colindex":_.sourceIndex+1+M,tabIndex:-1,onFocus:ie=>{if(ie.target!==yn.current)return he==null?void 0:he([_.sourceIndex,-1])},key:_.sourceIndex},_.title)))),y.createElement("tbody",{role:"rowgroup"},U.map(_=>y.createElement("tr",{role:"row","aria-selected":I.rows.hasIndex(_),key:_,"aria-rowindex":_+2},b.map(ie=>{const Z=ie.sourceIndex,te=tt(Z,_),Ae=z===Z&&N===_,Qe=R!==void 0&&Z>=R.x&&Z<R.x+R.width&&_>=R.y&&_<R.y+R.height,Fe=`glide-cell-${Z}-${_}`,gt=[Z,_],xt=f(gt,!0);return y.createElement("td",{key:te,role:"gridcell","aria-colindex":Z+1+M,"aria-selected":Qe,"aria-readonly":Qo(xt)||!ir(xt),id:Fe,"data-testid":Fe,onClick:()=>{const Ze=Q==null?void 0:Q.current;if(Ze!=null)return ae==null?void 0:ae({bounds:Pe(Ze,Z,_),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:gt})},onFocusCapture:Ze=>{var fe,et;if(!(Ze.target===yn.current||((fe=Wn.current)==null?void 0:fe[0])===Z&&((et=Wn.current)==null?void 0:et[1])===_))return Wn.current=gt,he==null?void 0:he(gt)},ref:Ae?Tn:void 0,tabIndex:-1},es(xt,T))})))))},[n,Se,re,K,oe,m,l,i,I,Tn,f,Q,ae,Pe,he,B],200),vn=Ge===0||!A?0:re>Ge?1:tn(-oe/100,0,1);let Co=0;O!=null&&O.current&&(Co=((Io=O==null?void 0:O.current)==null?void 0:Io.scrollLeft)+n-((Mo=O==null?void 0:O.current)==null?void 0:Mo.scrollWidth));const pn=pe===0||!A?0:re+Cn(Se,re,n,B,K,oe).filter(b=>!b.sticky).length<r.length-pe?1:tn(-Co/100,0,1),Xi=-l*32+J,wn=D?tn(-Xi/100,0,1):0,$i=y.useMemo(()=>{if(!vn&&!wn&&!pn)return null;const b="opacity 0.2s",M={position:"absolute",top:0,left:qt[0],width:n-qt[0],height:o,opacity:vn,pointerEvents:"none",transition:Ce?void 0:b,boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},z={position:"absolute",top:0,right:qt[1],width:n-qt[1],height:o,opacity:pn,pointerEvents:"none",transition:Ce?void 0:b,boxShadow:"inset -13px 0 10px -13px rgba(0, 0, 0, 0.2)"},N={position:"absolute",top:we,left:0,width:n,height:o,opacity:wn,pointerEvents:"none",transition:ve?void 0:b,boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return y.createElement(y.Fragment,null,vn>0&&y.createElement("div",{id:"shadow-x",style:M}),pn>0&&y.createElement("div",{id:"shadow-x",style:z}),wn>0&&y.createElement("div",{id:"shadow-y",style:N}))},[vn,wn,qt,n,Ce,we,o,ve,pn]),Yi=y.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return y.createElement(y.Fragment,null,y.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ai,onKeyUp:Di,onFocus:F,onBlur:S,ref:Ri,style:Pn},zi),y.createElement("canvas",{ref:Ve,style:Yi}),$i)},ml=y.memo(y.forwardRef(ts));function ns(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case le.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Qn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case le.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case le.Image:case le.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case le.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case le.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case le.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case le.Markdown:case le.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case le.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case le.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case le.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Jn()}}function os(e,t){return e.map((o,i)=>{const r=t[i];return o.map(s=>s.span!==void 0&&s.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:ns(s))})}function _o(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function is(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(s=>_o(s,!0)).join(",")):i.push(_o(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function $n(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Vo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function rs(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ss(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${$n(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((s,l)=>`<li gdg-raw-value=${Vo(i.rawValue[l])}>`+$n(s)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Vo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${$n(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ls(e,t){const n=os(e,t),o=is(n),i=ss(n);return{textPlain:o,textHtml:i}}function bl(e){var s;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const a=l.cloneNode(!0),d=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(d==null?void 0:d.children.length)===1&&d.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const h of m)h.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),c=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((s=a.querySelector("a"))==null?void 0:s.getAttribute("href"))??"",formatted:a.textContent??"",format:c});else if(a.querySelector("ol")!==null){const h=a.querySelectorAll("li");r==null||r.push({rawValue:[...h].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...h].map(v=>v.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:rs(f),formatted:a.textContent??"",format:c});else{let h=a.textContent??"";g&&(h=h.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:h??"",formatted:h??"",format:c})}}}return r!==void 0&&i.push(r),i}function yl(e,t,n,o,i){var l;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let s=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(l=e.current)==null?void 0:l.range,u=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;u.push(...m);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;u.push(...f)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;u.push(...m)}let d=a.x-n,g=a.x+a.width-1-n;for(const m of u)for(const f of m)f.span!==void 0&&(d=Math.min(f.span[0],d),g=Math.max(f.span[1],g));d===a.x-n&&g===a.x+a.width-1-n?s=!0:e={current:{cell:e.current.cell??[0,0],range:{x:d+n,y:a.y,width:g-d+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!s);return e}function qo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function vl(e){let t;(l=>{l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let s=0;for(const l of e){switch(r){case 0:l==="	"||l===`
`?(o.push(e.slice(i,s)),i=s+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(r=1);break;case 1:l==='"'&&(r=2);break;case 2:l==='"'?r=1:((l==="	"||l===`
`)&&(o.push(qo(e.slice(i,s))),i=s+1,l===`
`&&(n.push(o),o=[])),r=0);break}s++}return i<e.length&&o.push(qo(e.slice(i,e.length))),n.push(o),n.map(l=>l.map(a=>({rawValue:a,formatted:a,format:"string"})))}function pl(e,t,n){var l;const o=ls(e,t),i=a=>{var u;(u=window.navigator.clipboard)==null||u.writeText(a)},r=(a,u)=>{var d;return((d=window.navigator.clipboard)==null?void 0:d.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([u],{type:"text/html"})})]),!0)},s=(a,u)=>{var d,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(d=n==null?void 0:n.clipboardData)==null||d.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",u)}catch{r(a,u)||i(a)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?s(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function as(e){return e!==!0}const ki=20;function Uo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:s,height:l,x:a,y:u}=i,d=t.maxSize??ki,g=Math.floor(i.y+l/2),m=ti(d,l,r.cellVerticalPadding),f=ei(t.contentAlign??"center",a,s,r.cellHorizontalPadding,m),c=Zo(f,g,m),h=ni(a+n,u+o,c);return Zn(t)&&h}const cs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:le.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>ds(e,e.cell.data,Zn(e.cell),e.cell.maxSize??ki,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Uo(e)&&e.preventDefault()},onClick:e=>{if(Uo(e))return{...e.cell,data:as(e.cell.data)}},onPaste:(e,t)=>{let n=Mn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Qn),n===t.data?void 0:{...t,data:n}}};function ds(e,t,n,o,i){if(!n&&t===Mn)return;const{ctx:r,hoverAmount:s,theme:l,rect:a,highlighted:u,hoverX:d,hoverY:g,cell:{contentAlign:m}}=e,{x:f,y:c,width:h,height:v}=a;let w=!1;if(i>0){let k=n?1-i+i*s:.4;if(t===Mn&&(k*=s),k===0)return;k<1&&(w=!0,r.globalAlpha=k)}ro(r,l,t,f,c,h,v,u,d,g,o,m),w&&(r.globalAlpha=1)}const us=vt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),fs=e=>{const{bubbles:t}=e;return y.createElement(us,null,t.map((n,o)=>y.createElement("div",{key:o,className:"boe-bubble"},n)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},hs={getAccessibilityString:e=>oi(e.data),kind:le.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>gs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(fs,{bubbles:t.data})},onPaste:()=>{}};function gs(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:s,y:l,width:a,height:u}=n;let d=s+o.cellHorizontalPadding;const g=[];for(const m of t){if(d>s+a)break;const f=_t(m,i,o.baseFontFull).width;g.push({x:d,width:f}),d+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const m of g)ct(i,m.x,l+(u-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[m,f]of g.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[m],f.x+o.bubblePadding,l+u/2+It(i,o))}const ms=vt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),bs=e=>{const{drilldowns:t}=e;return y.createElement(ms,null,t.map((n,o)=>y.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&y.createElement("img",{src:n.img}),y.createElement("div",null,n.text))))},ys={getAccessibilityString:e=>oi(e.data.map(t=>t.text)),kind:le.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>ps(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(bs,{drilldowns:t.data})},onPaste:()=>{}},Yn={};function vs(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,s=n-r*2,l=4,a=n*i,u=o+r,d=o*3,g=(d+r*2)*i,m=`${e},${t},${i},${n}`;if(Yn[m]!==void 0)return{el:Yn[m],height:a,width:g,middleWidth:l*i,sideWidth:u*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),c=f.getContext("2d");return c===null?null:(f.width=g,f.height=a,c.scale(i,i),Yn[m]=f,c.beginPath(),ct(c,r,r,d,s,o),c.shadowColor="rgba(24, 25, 34, 0.4)",c.shadowBlur=1,c.fillStyle=e,c.fill(),c.shadowColor="rgba(24, 25, 34, 0.3)",c.shadowOffsetY=1,c.shadowBlur=5,c.fillStyle=e,c.fill(),c.shadowOffsetY=0,c.shadowBlur=0,c.shadowBlur=0,c.beginPath(),ct(c,r+.5,r+.5,d,s,o),c.strokeStyle=t,c.lineWidth=1,c.stroke(),{el:f,height:a,width:g,sideWidth:u*i,middleWidth:o*i,padding:r*i,dpr:i})}function ps(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:s,row:l}=e,{x:a,width:u}=n,d=o.baseFontFull,g=ci(i,d),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-m)/2),c=m-10,h=o.bubblePadding,v=o.bubbleMargin;let w=a+o.cellHorizontalPadding;const k=o.roundingRadius??6,F=vs(o.bgCell,o.drilldownBorder,m,k),S=[];for(const H of t){if(w>a+u)break;const B=_t(H.text,i,d).width;let W=0;H.img!==void 0&&r.loadOrGetImage(H.img,s,l)!==void 0&&(W=c-8+4);const P=B+W+h*2;S.push({x:w,width:P}),w+=P+v}if(F!==null){const{el:H,height:I,middleWidth:B,sideWidth:W,width:P,dpr:A,padding:D}=F,C=W/A,E=D/A;for(const p of S){const x=Math.floor(p.x),$=Math.floor(p.width),V=$-(C-E)*2;i.imageSmoothingEnabled=!1,i.drawImage(H,0,0,W,I,x-E,f,C,m),V>0&&i.drawImage(H,W,0,B,I,x+(C-E),f,V,m),i.drawImage(H,P-W,0,W,I,x+$-(C-E),f,C,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[H,I]of S.entries()){const B=t[H];let W=I.x+h;if(B.img!==void 0){const P=r.loadOrGetImage(B.img,s,l);if(P!==void 0){const A=c-8;let D=0,C=0,E=P.width,p=P.height;E>p?(D+=(E-p)/2,E=p):p>E&&(C+=(p-E)/2,p=E),i.beginPath(),ct(i,W,f+m/2-A/2,A,A,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(P,D,C,E,p,W,f+m/2-A/2,A,A),i.restore(),W+=A+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(B.text,W,f+m/2+It(i,o))}}const ws=vt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),ks=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(l=>l!=="");if(r.length===0)return null;const s=r.length>1;return y.createElement(ws,{"data-testid":"GDG-default-image-overlay-editor"},y.createElement(Zi.Carousel,{showArrows:s,showThumbs:!1,swipeable:s,emulateTouch:s,infiniteLoop:s},r.map(l=>{const a=(i==null?void 0:i(l))??y.createElement("img",{draggable:!1,src:l});return y.createElement("div",{className:"gdg-centering-container",key:l},a)})),n&&o&&y.createElement("button",{className:"gdg-edit-icon",onClick:o},y.createElement(eo,null)))},xs={getAccessibilityString:e=>e.data.join(", "),kind:le.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Ss(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??ks;return y.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},_n=4;function Ss(e,t,n,o){const{rect:i,col:r,row:s,theme:l,ctx:a,imageLoader:u}=e,{x:d,y:g,height:m,width:f}=i,c=m-l.cellVerticalPadding*2,h=[];let v=0;for(let k=0;k<t.length;k++){const F=t[k];if(F.length===0)continue;const S=u.loadOrGetImage(F,r,s);if(S!==void 0){h[k]=S;const H=S.width*(c/S.height);v+=H+_n}}if(v===0)return;v-=_n;let w=d+l.cellHorizontalPadding;o==="right"?w=Math.floor(d+f-l.cellHorizontalPadding-v):o==="center"&&(w=Math.floor(d+f/2-v/2));for(const k of h){if(k===void 0)continue;const F=k.width*(c/k.height);n>0&&(a.beginPath(),ct(a,w,g+l.cellVerticalPadding,F,c,n),a.save(),a.clip()),a.drawImage(k,w,g+l.cellVerticalPadding,F,c),n>0&&a.restore(),w+=F+_n}}function Cs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Is={getAccessibilityString:()=>"",kind:le.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:s}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Cs(n,o)*t.skeletonWidthVariability));const a=s.cellHorizontalPadding;l+a*2>=r.width&&(l=r.width-a*2-1);const u=t.skeletonHeight??Math.min(18,r.height-2*s.cellVerticalPadding);ct(i,r.x+a,r.y+(r.height-u)/2,l,u,s.roundingRadius??3),i.fillStyle=cn(s.textDark,.1),i.fill()},onPaste:()=>{}},Ms=vt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Es extends rn.PureComponent{constructor(){super(...arguments);ne(this,"targetElement",null);ne(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,s=tr(i),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let a=r==null?void 0:r(s);if(a===void 0){const d=document.createElement("template");d.innerHTML=s,a=d.content}n.append(a);const u=n.getElementsByTagName("a");for(const d of u)d.target="_blank",d.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),rn.createElement(Ms,{ref:this.containerRefHook})}}const Fs=vt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Bs=vt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Ps=vt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let jo=0;const Bn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:s,...l}=e,{onChange:a,className:u}=l,d=y.useRef(null),g=n??"";bt(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=y.useState(()=>"input-box-"+(jo=(jo+1)%1e7));y.useEffect(()=>{const c=d.current;if(c===null||c.disabled)return;const h=g.toString().length;c.focus(),c.setSelectionRange(i?0:h,h)},[]),y.useLayoutEffect(()=>{var c;if(s!==void 0){const h=typeof s=="number"?[s,null]:s;(c=d.current)==null||c.setSelectionRange(h[0],h[1])}},[s]);const f=y.useCallback(c=>{c.key==="Enter"&&c.shiftKey&&r===!0||o==null||o(c)},[r,o]);return y.createElement(Ps,{className:"gdg-growing-entry"},y.createElement(Bs,{className:u},g+`
`),y.createElement(Fs,{...l,className:(u??"")+" gdg-input",id:m,ref:d,onKeyDown:f,value:g,placeholder:t,dir:"auto"}))},Hs=()=>e=>e.targetWidth,Ko=vt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Hs(),"px"]}}),As=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:s,validatedSelection:l}=e,a=t.data,u=t.readonly===!0,[d,g]=y.useState(a===""||o),m=y.useCallback(()=>{g(c=>!c)},[]),f=a?"gdg-ml-6":"";return d?y.createElement(Ko,{targetWidth:r.width-20},y.createElement(Bn,{autoFocus:!0,highlight:!1,validatedSelection:l,value:a,onKeyDown:c=>{c.key==="Enter"&&c.stopPropagation()},onChange:n}),y.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${f}`,onClick:()=>s(t)},y.createElement(lr,null))):y.createElement(Ko,{targetWidth:r.width},y.createElement(Es,{contents:a,createNode:i}),!u&&y.createElement(y.Fragment,null,y.createElement("div",{className:"spacer"}),y.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${f}`,onClick:m},y.createElement(eo,null))),y.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:an,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>yt(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:s,validatedSelection:l}=e;return y.createElement(As,{onFinish:i,targetRect:o,value:n,validatedSelection:l,onChange:a=>t({...n,data:a.target.value}),forceEditMode:s,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Rs={getAccessibilityString:e=>e.row.toString(),kind:sn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Ts,measure:()=>44,draw:e=>Ls(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:s}=t,l=n.drawHandle?7+(r-7)/2:r/2,a=s/2;if(Math.abs(o-l)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Ts(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ws,n.textAlign="center",r}function Ws(e){const{ctx:t}=e;t.textAlign="start"}function Ls(e,t,n,o,i,r){const{ctx:s,rect:l,hoverAmount:a,theme:u}=e,{x:d,y:g,width:m,height:f}=l,c=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&c>0){s.globalAlpha=c;const h=7*(n?a:1);if(ro(s,u,n,i?d+h:d,g,i?m-h:m,f,!0,void 0,void 0,18,"center",r),i){s.globalAlpha=a,s.beginPath();for(const v of[3,6])for(const w of[-5,-1,3])s.rect(d+v,g+f/2+w,2,2);s.fillStyle=u.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const h=t.toString(),v=u.markerFontFull,w=d+m/2;o==="both"&&a!==0&&(s.globalAlpha=1-a),s.fillStyle=u.textLight,s.font=v,s.fillText(h,w,g+f/2+It(s,v)),a!==0&&(s.globalAlpha=1)}}const Ns={getAccessibilityString:()=>"",kind:sn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Os(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Os(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:s,spriteManager:l}=e,{x:a,y:u,width:d,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,u+1,d,g-2),o.fillStyle=s.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let f=0;if(n!==void 0){const h=g-8,v=a+8/2,w=u+8/2;l.drawSprite(n,"normal",o,v,w,h,s,m?1:r),f=h}else{f=24;const c=12,h=m?c:r*c,v=m?0:(1-r)*c*.5,w=s.cellHorizontalPadding+4;h>0&&(o.moveTo(a+w+v,u+g/2),o.lineTo(a+w+v+h,u+g/2),o.moveTo(a+w+v+h*.5,u+g/2-h*.5),o.lineTo(a+w+v+h*.5,u+g/2+h*.5),o.lineWidth=2,o.strokeStyle=s.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=s.textMedium,o.fillText(t,f+a+s.cellHorizontalPadding+.5,u+g/2+It(o,s)),o.beginPath()}function xi(e,t,n,o,i,r,s){e.textBaseline="alphabetic";const l=zs(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),ct(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??cn(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",s==null||s("text")}function zs(e,t,n,o,i){const r=o.cellHorizontalPadding,s=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+s/2+1,width:t.width-r,height:t.height-s-1};const l=_t(n,e,o.baseFontFull,"alphabetic"),a=t.height-s,u=Math.min(a,l.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-u)/2+1,width:l.width+r*3,height:u-1}}const Xs=y.lazy(async()=>await qi(()=>import("./number-overlay-editor-B1b6n_7N.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),$s={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:an,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:s}=e,{hoverEffect:l,displayData:a,hoverEffectTheme:u}=n;l===!0&&t>0&&xi(o,i,u,a,r,t,s),yt(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return y.createElement(y.Suspense,{fallback:null},y.createElement(Xs,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ys={getAccessibilityString:()=>"",measure:()=>108,kind:le.Protected,needsHover:!1,needsHoverPosition:!1,draw:_s,onPaste:()=>{}};function _s(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:s}=o;t.beginPath();const l=2.5;let a=i+n.cellHorizontalPadding+l;const u=r+s/2,d=Math.cos(Bo(30))*l,g=Math.sin(Bo(30))*l;for(let m=0;m<12;m++)t.moveTo(a,u-l),t.lineTo(a,u+l),t.moveTo(a+d,u-g),t.lineTo(a-d,u+g),t.moveTo(a-d,u-g),t.lineTo(a+d,u+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Vs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>an(e,t,e.theme.textLight),draw:e=>yt(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return rn.createElement(Bn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},qs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:an,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:s,overrideCursor:l}=e,{displayData:a,contentAlign:u,hoverEffect:d,allowWrapping:g,hoverEffectTheme:m}=t;d===!0&&n>0&&xi(i,s,m,a,r,n,l),yt(e,a,u,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return y.createElement(Bn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:s=>o({...i,data:s.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Us=vt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),js=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:s}=e,[l,a]=y.useState(!i&&(t===""||o)),u=y.useCallback(()=>{a(!0)},[]);return l?y.createElement(Bn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):y.createElement(Us,null,y.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},s),!i&&y.createElement("div",{className:"gdg-edit-icon",onClick:u},y.createElement(eo,null)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function Si(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,s=e.width,l=e.actualBoundingBoxAscent;return o==="right"?i=t.width-s-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-s/2),{x:i,y:r,width:s,height:l}}function Go(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,s=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=li(s,r.baseFontFull);if(l===void 0)return!1;const a=Si(l,n,r,t.contentAlign);return Ot({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const Ks={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:an,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:s,ctx:l}=e,a=t.displayData??t.data,u=t.hoverEffect===!0;if(o!==void 0&&u&&i!==void 0&&r!==void 0){const d=_t(a,l,n.baseFontFull),g=Si(d,s,n,t.contentAlign),{x:m,y:f,width:c,height:h}=g;if(i>=m-4&&i<=m-4+c+8&&r>=f-4&&r<=f-4+h+8){const v=It(l,n.baseFontFull);o("pointer");const w=5,k=f-v;l.beginPath(),l.moveTo(s.x+m,Math.floor(s.y+k+h+w)+.5),l.lineTo(s.x+m+c,Math.floor(s.y+k+h+w)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,yt({...e,rect:{...s,x:s.x-1}},a,t.contentAlign),yt({...e,rect:{...s,x:s.x-2}},a,t.contentAlign),yt({...e,rect:{...s,x:s.x+1}},a,t.contentAlign),yt({...e,rect:{...s,x:s.x+2}},a,t.contentAlign),l.restore()}}l.fillStyle=u?n.linkColor:n.textDark,yt(e,a,t.contentAlign)},onSelect:e=>{Go(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Go(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return y.createElement(js,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:s=>n({...o,data:s.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},wl=[Rs,Ns,cs,hs,ys,xs,Is,Ds,$s,Ys,Vs,qs,Ks],Vn=[];class kl extends ui{constructor(){super(...arguments);ne(this,"imageLoaded",()=>{});ne(this,"loadedLocations",[]);ne(this,"cache",{});ne(this,"sendLoaded",er(()=>{this.imageLoaded(new on(this.loadedLocations)),this.loadedLocations=[]},20));ne(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let s=0;s<i.cells.length;s++){const l=i.cells[s];if(this.isInWindow(l)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let s=!1;const l=Vn.pop()??new Image;let a=!1;const u={img:void 0,cells:[tt(o,i)],url:n,cancel:()=>{a||(a=!0,Vn.length<12?Vn.unshift(l):s||(l.src=""))}},d=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await d,await l.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=l;for(const m of g.cells)this.loadedLocations.push(io(m));s=!0,this.sendLoaded()}}catch{u.cancel()}}),this.cache[r]=u}loadOrGetImage(n,o,i){const r=n,s=this.cache[r];if(s!==void 0){const l=tt(o,i);return s.cells.includes(l)||s.cells.push(l),s.img}else this.loadImage(n,o,i,r)}}export{wl as A,Ht as B,Un as C,Zr as D,hl as E,Jn as F,le as G,or as H,sn as I,rl as J,cl as K,bl as L,vl as M,Po as N,dl as O,pl as P,kl as Q,ml as R,Xo as S,fl as T,Jr as U,il as V,nr as a,bt as b,gl as c,al as d,ll as e,yl as f,ul as g,$t as h,nl as i,cn as j,tl as k,Yt as l,Rs as m,Nt as n,$o as o,Ot as p,En as q,ol as r,gr as s,as as t,Ue as u,Qo as v,sl as w,ir as x,Pr as y,Sn as z};
