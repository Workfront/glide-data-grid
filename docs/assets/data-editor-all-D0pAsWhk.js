const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-Dh7oaF_L.js","./iframe-u-uZSGaK.js","./index-DAIvD5fl.js","./image-window-loader-BuZ8WPKd.js","./throttle-BIWfclFY.js","./marked.esm-DMz2Pe0E.js","./image-window-loader-DwxX9NSO.css","./flatten-CPDsTVcy.js","./scrolling-data-grid-BQ2mQOi3.js","./scrolling-data-grid-DRMIUdoe.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Ul=Object.defineProperty;var Bl=(t,o,i)=>o in t?Ul(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i;var dn=(t,o,i)=>Bl(t,typeof o!="symbol"?o+"":o,i);import{r as l,R as he,_ as Vl}from"./iframe-u-uZSGaK.js";import{G as Q,b as Ko,i as Do,r as nr,c as No,C as Y,g as hr,d as _l,w as ut,e as Xl,f as Yl,h as fn,j as rr,I as Io,p as ql,k as jl,t as Zl,l as Jl,n as Pt,o as lr,q as ir,s as Ql,v as Fo,x as $o,y as ei,z as ti,B as oi,D as ni,E as ri,F as cr,H as to,J as li,K as ii,L as sr,M as ci,u as hn,N as si,O as ai,T as ui,P as ar,A as di,Q as fi}from"./image-window-loader-BuZ8WPKd.js";import{m as St,r as Kt,g as hi}from"./throttle-BIWfclFY.js";import{u as gi,f as ur}from"./flatten-CPDsTVcy.js";import{G as mi}from"./scrolling-data-grid-BQ2mQOi3.js";import{s as vn}from"./marked.esm-DMz2Pe0E.js";const Z='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',vi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},Ci=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="4" fill="${i}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},wi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},pi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},bi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${i}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},yi=t=>{const o=t.bgColor;return`${Z}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},xi=gr,Mi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Ri=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},ki=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Si=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${i}"/>
  </svg>`},zi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Ti=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Ei=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Li=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Hi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${i}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${i}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Di=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${i}"/>
</svg>`},Ii=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Fi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},$i=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Ai=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Gi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Pi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ki=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Ni=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Wi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Oi=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Ui=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Bi={headerRowID:vi,headerNumber:wi,headerCode:Ci,headerString:pi,headerBoolean:bi,headerAudioUri:xi,headerVideoUri:Mi,headerEmoji:Ri,headerImage:ki,headerUri:gr,headerPhone:Si,headerMarkdown:zi,headerDate:Ti,headerTime:Ei,headerEmail:Li,headerReference:Hi,headerIfThenElse:Di,headerSingleValue:Ii,headerLookup:Fi,headerTextTemplate:$i,headerMath:Ai,headerRollup:Gi,headerJoinStrings:Pi,headerSplitString:Ki,headerGeoDistance:Ni,headerArray:Wi,rowOwnerOverlay:Oi,protectedColumnOverlay:Ui,renameIcon:yi},Vi=vn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),_i=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Xi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Yi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),qi=10,ji=t=>{const{canvasRef:o,cellYOffset:i,rows:d,columns:w,searchInputRef:y,searchValue:I,searchResults:p,onSearchValueChange:R,getCellsForSelection:L,onSearchResultsChanged:v,showSearch:M=!1,onSearchClose:z}=t,[P]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[U,_]=l.useState(""),ve=I??U,O=l.useCallback(D=>{_(D),R==null||R(D)},[R]),[$,N]=l.useState(),pe=l.useRef($);pe.current=$,l.useEffect(()=>{p!==void 0&&(p.length>0?N(D=>({rowsSearched:d,results:p.length,selectedIndex:(D==null?void 0:D.selectedIndex)??-1})):N(void 0))},[d,p]);const ue=l.useRef();ue.current===void 0&&(ue.current=new AbortController);const ge=l.useRef(),[q,ee]=l.useState([]),te=p??q,X=l.useCallback(()=>{ge.current!==void 0&&(window.cancelAnimationFrame(ge.current),ge.current=void 0,ue.current.abort())},[]),je=l.useRef(i);je.current=i;const Le=l.useCallback(D=>{const ne=new RegExp(D.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let de=je.current,De=Math.min(10,d),Pe=0;N(void 0),ee([]);const ft=[],no=async()=>{var _e;if(L===void 0)return;const Oo=performance.now(),Wt=d-Pe;let ht=L({x:0,y:de,width:w.length,height:Math.min(De,Wt,d-de)},ue.current.signal);typeof ht=="function"&&(ht=await ht());let ro=!1;for(const[be,Se]of ht.entries())for(const[Uo,Ze]of Se.entries()){let Je;switch(Ze.kind){case Q.Text:case Q.Number:Je=Ze.displayData;break;case Q.Uri:case Q.Markdown:Je=Ze.data;break;case Q.Boolean:Je=typeof Ze.data=="boolean"?Ze.data.toString():void 0;break;case Q.Image:case Q.Bubble:Je=Ze.data.join("🐳");break;case Q.Custom:Je=Ze.copyData;break}Je!==void 0&&ne.test(Je)&&(ft.push([Uo,be+de]),ro=!0)}const lo=performance.now();ro&&ee([...ft]),Pe+=ht.length,Ko(Pe<=d);const tt=((_e=pe.current)==null?void 0:_e.selectedIndex)??-1;N({results:ft.length,rowsSearched:Pe,selectedIndex:tt}),v==null||v(ft,tt),de+De>=d?de=0:de+=De;const gt=lo-Oo,mt=Math.max(gt,1),vt=qi/mt;De=Math.ceil(De*vt),Pe<d&&ft.length<1e3&&(ge.current=window.requestAnimationFrame(no))};X(),ge.current=window.requestAnimationFrame(no)},[X,w.length,L,v,d]),ke=l.useCallback(()=>{var D;z==null||z(),N(void 0),ee([]),v==null||v([],-1),X(),(D=o==null?void 0:o.current)==null||D.focus()},[X,o,z,v]),oo=l.useCallback(D=>{O(D.target.value),p===void 0&&(D.target.value===""?(N(void 0),ee([]),X()):Le(D.target.value))},[Le,X,O,p]);l.useEffect(()=>{M&&y.current!==null&&(O(""),y.current.focus({preventScroll:!0}))},[M,y,O]);const dt=l.useCallback(D=>{var de;if((de=D==null?void 0:D.stopPropagation)==null||de.call(D),$===void 0)return;const ne=($.selectedIndex+1)%$.results;N({...$,selectedIndex:ne}),v==null||v(te,ne)},[$,v,te]),He=l.useCallback(D=>{var de;if((de=D==null?void 0:D.stopPropagation)==null||de.call(D),$===void 0)return;let ne=($.selectedIndex-1)%$.results;ne<0&&(ne+=$.results),N({...$,selectedIndex:ne}),v==null||v(te,ne)},[v,te,$]),Ae=l.useCallback(D=>{(D.ctrlKey||D.metaKey)&&D.nativeEvent.code==="KeyF"||D.key==="Escape"?(ke(),D.stopPropagation(),D.preventDefault()):D.key==="Enter"&&(D.shiftKey?He():dt())},[ke,dt,He]);l.useEffect(()=>()=>{X()},[X]);const[Nt,Ge]=l.useState(!1);l.useEffect(()=>{if(M)Ge(!0);else{const D=setTimeout(()=>Ge(!1),150);return()=>clearTimeout(D)}},[M]);const Wo=l.useMemo(()=>{if(!M&&!Nt)return null;let D;$!==void 0&&(D=$.results>=1e3?"over 1000":`${$.results} result${$.results!==1?"s":""}`,$.selectedIndex>=0&&(D=`${$.selectedIndex+1} of ${D}`));const ne=Pe=>{Pe.stopPropagation()},De={width:`${Math.floor((($==null?void 0:$.rowsSearched)??0)/d*100)}%`};return l.createElement(Vi,{className:M?"":"out",onMouseDown:ne,onMouseMove:ne,onMouseUp:ne,onClick:ne},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:P,"aria-hidden":!M,"data-testid":"search-input",ref:y,onChange:oo,value:ve,tabIndex:M?void 0:-1,onKeyDownCapture:Ae}),l.createElement("button",{"aria-label":"Previous Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:He,disabled:(($==null?void 0:$.results)??0)===0},_i),l.createElement("button",{"aria-label":"Next Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:dt,disabled:(($==null?void 0:$.results)??0)===0},Xi),z!==void 0&&l.createElement("button",{"aria-label":"Close Search","aria-hidden":!M,"data-testid":"search-close-button",tabIndex:M?void 0:-1,onClick:ke},Yi)),$!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},D)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:P},"Type to search")))},[M,Nt,$,d,P,y,oo,ve,Ae,He,dt,z,ke]);return l.createElement(l.Fragment,null,l.createElement(mi,{prelightCells:te,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),Wo)};class Zi extends l.PureComponent{constructor(){super(...arguments);dn(this,"wrapperRef",l.createRef());dn(this,"clickOutside",i=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(i))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(i.target)){let d=i.target;for(;d!==null;){if(d.classList.contains("click-outside-ignore"))return;d=d.parentElement}this.props.onClickOutside()}})}componentDidMount(){const i=this.props.customEventTarget??document;i.addEventListener("touchend",this.clickOutside,!0),i.addEventListener("pointerdown",this.clickOutside,!0),i.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const i=this.props.customEventTarget??document;i.removeEventListener("touchend",this.clickOutside,!0),i.removeEventListener("pointerdown",this.clickOutside,!0),i.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:i,isOutsideClick:d,customEventTarget:w,...y}=this.props;return l.createElement("div",{...y,ref:this.wrapperRef},this.props.children)}}const Ji=()=>t=>Math.max(16,t.targetHeight-10),Qi=vn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Ji(),"px"]}}),ec=t=>{const{bounds:o,group:i,onClose:d,canvasBounds:w,onFinish:y}=t,[I,p]=he.useState(i);return he.createElement(Zi,{style:{position:"absolute",left:o.x-w.left+1,top:o.y-w.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:d},he.createElement(Qi,{targetHeight:o.height,"data-testid":"group-rename-input",value:I,onBlur:d,onFocus:R=>R.target.setSelectionRange(0,I.length),onChange:R=>p(R.target.value),onKeyDown:R=>{R.key==="Enter"?y(I):R.key==="Escape"&&d()},autoFocus:!0}))},gn=150;function tc(t,o,i,d){var y;const w=d(o);return((y=w==null?void 0:w.measure)==null?void 0:y.call(w,t,o,i))??gn}function mr(t,o,i,d,w,y,I,p,R){let L=0;const v=w===void 0?[]:w.map(P=>{const U=tc(t,P[d],o,R);return L=Math.max(L,U),U});if(v.length>5&&p){L=0;let P=0;for(const _ of v)P+=_;const U=P/v.length;for(let _=0;_<v.length;_++)v[_]>=U*2?v[_]=0:L=Math.max(L,v[_])}const M=t.font;t.font=o.headerFontFull,L=Math.max(L,t.measureText(i.title).width+o.cellHorizontalPadding*2+(i.icon===void 0?0:28)),t.font=M;const z=Math.max(Math.ceil(y),Math.min(Math.floor(I),Math.ceil(L)));return{...i,width:z}}function oc(t,o,i,d,w,y,I,p,R){const L=l.useRef(o),v=l.useRef(i),M=l.useRef(I);L.current=o,v.current=i,M.current=I;const[z,P]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const $=document.createElement("canvas");return $.style.display="none",$.style.opacity="0",$.style.position="fixed",[$,$.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(z&&document.documentElement.append(z),()=>{z==null||z.remove()}),[z]);const U=l.useRef({}),_=l.useRef(),[ve,O]=l.useState();return l.useLayoutEffect(()=>{const $=v.current;if($===void 0||t.every(Do))return;let N=Math.max(1,10-Math.floor(t.length/1e4)),pe=0;N<L.current&&N>1&&(N--,pe=1);const ue={x:0,y:0,width:t.length,height:Math.min(L.current,N)},ge={x:0,y:L.current-1,width:t.length,height:1};(async()=>{const ee=$(ue,R.signal),te=pe>0?$(ge,R.signal):void 0;let X;typeof ee=="object"?X=ee:X=await nr(ee),te!==void 0&&(typeof te=="object"?X=[...X,...te]:X=[...X,...await nr(te)]),_.current=t,O(X)})()},[R.signal,t]),l.useMemo(()=>{let N=t.every(Do)?t:P===null?t.map(q=>Do(q)?q:{...q,width:gn}):(P.font=M.current.baseFontFull,t.map((q,ee)=>{if(Do(q))return q;if(U.current[q.id]!==void 0)return{...q,width:U.current[q.id]};if(ve===void 0||_.current!==t||q.id===void 0)return{...q,width:gn};const te=mr(P,I,q,ee,ve,w,y,!0,p);return U.current[q.id]=te.width,te})),pe=0,ue=0;const ge=[];for(const[q,ee]of N.entries())pe+=ee.width,ee.grow!==void 0&&ee.grow>0&&(ue+=ee.grow,ge.push(q));if(pe<d&&ge.length>0){const q=[...N],ee=d-pe;let te=ee;for(let X=0;X<ge.length;X++){const je=ge[X],Le=(N[je].grow??0)/ue,ke=X===ge.length-1?te:Math.min(te,Math.floor(ee*Le));q[je]={...N[je],growOffset:ke,width:N[je].width+ke},te-=ke}N=q}return{sizedColumns:N,nonGrowWidth:pe}},[d,t,P,ve,I,w,y,p])}function nc(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function A(t,o,i){const d=vr(t,o);return d&&(i.didMatch=!0),d}function vr(t,o){if(t.length===0)return!1;if(t.includes("|")){const R=t.split("|");for(const L of R)if(vr(L,o))return!0;return!1}let i=!1,d=!1,w=!1,y=!1;const I=t.split("+"),p=I.pop();if(!nc(p,o))return!1;if(I[0]==="any")return!0;for(const R of I)switch(R){case"ctrl":i=!0;break;case"shift":d=!0;break;case"alt":w=!0;break;case"meta":y=!0;break;case"primary":No.value?y=!0:i=!0;break}return o.altKey===w&&o.ctrlKey===i&&o.shiftKey===d&&o.metaKey===y}function rc(t,o,i,d,w,y,I){const p=he.useCallback((v,M,z,P)=>{var N;(y==="cell"||y==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!I&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const U=i==="mixed"&&(z||P==="drag"),_=d==="mixed"&&U,ve=w==="mixed"&&U;let O={current:v===void 0?void 0:{...v,rangeStack:P==="drag"?((N=t.current)==null?void 0:N.rangeStack)??[]:[]},columns:_?t.columns:Y.empty(),rows:ve?t.rows:Y.empty()};z&&(y==="multi-rect"||y==="multi-cell")&&O.current!==void 0&&t.current!==void 0&&(O={...O,current:{...O.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(O,M)},[d,t,i,y,I,w,o]),R=he.useCallback((v,M,z)=>{v=v??t.rows,M!==void 0&&(v=v.add(M));let P;if(w==="exclusive"&&v.length>0)P={current:void 0,columns:Y.empty(),rows:v};else{const U=z&&i==="mixed",_=z&&d==="mixed";P={current:U?t.current:void 0,columns:_?t.columns:Y.empty(),rows:v}}o(P,!1)},[d,t,i,w,o]),L=he.useCallback((v,M,z)=>{v=v??t.columns,M!==void 0&&(v=v.add(M));let P;if(d==="exclusive"&&v.length>0)P={current:void 0,rows:Y.empty(),columns:v};else{const U=z&&i==="mixed",_=z&&w==="mixed";P={current:U?t.current:void 0,rows:_?t.rows:Y.empty(),columns:v}}o(P,!1)},[d,t,i,w,o]);return[p,R,L]}function lc(t,o,i,d,w){const y=l.useCallback(L=>{if(t===!0){const v=[];for(let M=L.y;M<L.y+L.height;M++){const z=[];for(let P=L.x;P<L.x+L.width;P++)P<0||M>=w?z.push({kind:Q.Loading,allowOverlay:!1}):z.push(o([P,M]));v.push(z)}return v}return(t==null?void 0:t(L,d.signal))??[]},[d.signal,o,t,w]),I=t!==void 0?y:void 0,p=l.useCallback(L=>{if(I===void 0)return[];const v={...L,x:L.x-i};if(v.x<0){v.x=0,v.width--;const M=I(v,d.signal);return typeof M=="function"?async()=>(await M()).map(z=>[{kind:Q.Loading,allowOverlay:!1},...z]):M.map(z=>[{kind:Q.Loading,allowOverlay:!1},...z])}return I(v,d.signal)},[d.signal,I,i]);return[t!==void 0?p:void 0,I]}function dr(t){return typeof t=="string"?t:`${t}px`}const ic=()=>t=>t.innerWidth,cc=()=>t=>t.innerHeight,sc=vn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[ic()],"w2q57ts-1":[cc()]}}),ac=t=>{const{inWidth:o,inHeight:i,children:d,...w}=t;return l.createElement(sc,{innerHeight:dr(i),innerWidth:dr(o),...w},d)},uc=2,dc=1300;function fc(t,o,i){const d=he.useRef(0),[w,y]=t??[0,0];he.useEffect(()=>{if(w===0&&y===0){d.current=0;return}let I=!1,p=0;const R=L=>{var v;if(!I){if(p===0)p=L;else{const M=L-p;d.current=Math.min(1,d.current+M/dc);const z=d.current**1.618*M*uc;(v=o.current)==null||v.scrollBy(w*z,y*z),p=L,i==null||i()}window.requestAnimationFrame(R)}};return window.requestAnimationFrame(R),()=>{I=!0}},[o,w,y,i])}function hc({rowHeight:t,headerHeight:o,groupHeaderHeight:i,theme:d,overscrollX:w,overscrollY:y,scaleToRem:I,remSize:p}){const[R,L,v,M,z,P]=he.useMemo(()=>{if(!I||p===16)return[t,o,i,d,w,y];const U=p/16,_=t,ve=hr();return[typeof _=="number"?_*U:O=>Math.ceil(_(O)*U),Math.ceil(o*U),Math.ceil(i*U),{...d,headerIconSize:((d==null?void 0:d.headerIconSize)??ve.headerIconSize)*U,cellHorizontalPadding:((d==null?void 0:d.cellHorizontalPadding)??ve.cellHorizontalPadding)*U,cellVerticalPadding:((d==null?void 0:d.cellVerticalPadding)??ve.cellVerticalPadding)*U},Math.ceil((w??0)*U),Math.ceil((y??0)*U)]},[i,o,w,y,p,t,I,d]);return{rowHeight:R,headerHeight:L,groupHeaderHeight:v,theme:M,overscrollX:z,overscrollY:P}}const at={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function G(t,o){return t===!0?o:t===!1?"":t}function fr(t){const o=No.value;return{activateCell:G(t.activateCell," |Enter|shift+Enter"),clear:G(t.clear,"any+Escape"),closeOverlay:G(t.closeOverlay,"any+Escape"),acceptOverlayDown:G(t.acceptOverlayDown,"Enter"),acceptOverlayUp:G(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:G(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:G(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:G(t.delete,o?"Backspace|Delete":"Delete"),downFill:G(t.downFill,"primary+_68"),scrollToSelectedCell:G(t.scrollToSelectedCell,"primary+Enter"),goDownCell:G(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:G(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:G(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:G(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:G(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:G(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:G(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:G(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:G(t.goToFirstCell,"primary+Home"),goToFirstColumn:G(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:G(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:G(t.goToLastCell,"primary+End"),goToLastColumn:G(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:G(t.goToLastRow,"primary+ArrowDown"),goToNextPage:G(t.goToNextPage,"PageDown"),goToPreviousPage:G(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:G(t.rightFill,"primary+_82"),search:G(t.search,"primary+f"),selectAll:G(t.selectAll,"primary+a"),selectColumn:G(t.selectColumn,"ctrl+ "),selectGrowDown:G(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:G(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:G(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:G(t.selectGrowUp,"shift+ArrowUp"),selectRow:G(t.selectRow,"shift+ "),selectToFirstCell:G(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:G(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:G(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:G(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:G(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:G(t.selectToLastRow,"primary+shift+ArrowDown")}}function gc(t){const o=_l(t);return he.useMemo(()=>{if(o===void 0)return fr(at);const i={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??at.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??at.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??at.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??at.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??at.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??at.selectToLastCell};return fr({...at,...i})},[o])}function mc(t){function o(d,w,y){if(typeof d=="number")return{headerIndex:d,isCollapsed:!1,depth:w,path:y};const I={headerIndex:d.headerIndex,isCollapsed:d.isCollapsed,depth:w,path:y};return d.subGroups!==void 0&&(I.subGroups=d.subGroups.map((p,R)=>o(p,w+1,[...y,R])).sort((p,R)=>p.headerIndex-R.headerIndex)),I}return t.map((d,w)=>o(d,0,[w])).sort((d,w)=>d.headerIndex-w.headerIndex)}function Cn(t,o){const i=[];function d(p,R,L=!1){let v=R!==null?R-p.headerIndex:o-p.headerIndex;if(p.subGroups!==void 0&&(v=p.subGroups[0].headerIndex-p.headerIndex),v--,i.push({rowIndex:-1,headerIndex:p.headerIndex,contentIndex:-1,skip:L,isCollapsed:p.isCollapsed,depth:p.depth,path:p.path,rows:v}),p.subGroups)for(let M=0;M<p.subGroups.length;M++){const z=M<p.subGroups.length-1?p.subGroups[M+1].headerIndex:R;d(p.subGroups[M],z,L||p.isCollapsed)}}const w=mc(t.groups);for(let p=0;p<w.length;p++){const R=p<w.length-1?w[p+1].headerIndex:null;d(w[p],R)}let y=0,I=0;for(const p of i)p.contentIndex=I,I+=p.rows,p.rowIndex=y,y+=p.isCollapsed?1:p.rows+1;return i.filter(p=>p.skip===!1).map(p=>{const{skip:R,...L}=p;return L})}function mn(t,o){if(o===void 0||Cn.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let i=t;for(const d of o){if(i===0)return{path:[...d.path,-1],originalIndex:d.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:d.rows};if(d.isCollapsed)i--;else{if(i<=d.rows)return{path:[...d.path,i-1],originalIndex:d.headerIndex+i,isGroupHeader:!1,groupIndex:i-1,contentIndex:d.contentIndex+i-1,groupRows:d.rows};i=i-d.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function vc(t,o,i,d){const w=he.useMemo(()=>t===void 0?void 0:Cn(t,o),[t,o]),y=he.useMemo(()=>w==null?void 0:w.reduce((v,M)=>(v[M.rowIndex]=M,v),{}),[w]),I=he.useMemo(()=>w===void 0?o:w.reduce((v,M)=>v+(M.isCollapsed?1:M.rows+1),0),[w,o]),p=he.useMemo(()=>t===void 0||typeof i=="number"&&t.height===i?i:v=>y!=null&&y[v]?t.height:typeof i=="number"?i:i(v),[y,t,i]),R=he.useCallback(v=>{if(w===void 0)return v;let M=v;for(const z of w){if(M===0)return;if(M--,!z.isCollapsed){if(M<z.rows)return z.contentIndex+M;M-=z.rows}}return v},[w]),L=ut(d??(t==null?void 0:t.themeOverride),he.useCallback(v=>{if(t===void 0)return d==null?void 0:d(v,v,v);if(d===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:z,groupIndex:P}=mn(v,w);return M?t.themeOverride:d==null?void 0:d(v,P,z)},[w,d,t]));return t===void 0?{rowHeight:p,rows:o,rowNumberMapper:R,getRowThemeOverride:L}:{rowHeight:p,rows:I,rowNumberMapper:R,getRowThemeOverride:L}}function Cc(t,o){const i=he.useMemo(()=>t===void 0?void 0:Cn(t,o),[t,o]);return{getRowGroupingForPath:wr,updateRowGroupingByPath:Cr,mapper:he.useCallback(d=>{if(typeof d=="number")return mn(d,i);const w=mn(d[1],i);return{...w,originalIndex:[d[0],w.originalIndex]}},[i])}}function Cr(t,o,i){const[d,...w]=o;return w[0]===-1?t.map((y,I)=>I===d?{...y,...i}:y):t.map((y,I)=>I===d?{...y,subGroups:Cr(y.subGroups??[],w,i)}:y)}function wr(t,o){const[i,...d]=o;return d[0]===-1?t[i]:wr(t[i].subGroups??[],d)}function wc(t,o){const[i]=l.useState(()=>({value:t,callback:o,facade:{get current(){return i.value},set current(d){const w=i.value;w!==d&&(i.value=d,i.callback(d,w))}}}));return i.callback=o,i.facade}function pc(t,o,i,d,w){const[y,I]=l.useMemo(()=>[o!==void 0&&typeof i=="number"?Math.floor(o/i):0,o!==void 0&&typeof i=="number"?-(o%i):0],[o,i]),p=l.useMemo(()=>({x:d.current.x,y,width:d.current.width??1,height:d.current.height??1,ty:I}),[d,I,y]),[R,L,v]=Xl(p),M=l.useRef(w);M.current=w;const z=wc(null,_=>{_!==null&&o!==void 0?_.scrollTop=o:_!==null&&t!==void 0&&(_.scrollLeft=t)}),P=(R.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&z.current!==null&&P){if(z.current.scrollTop===o)return;z.current.scrollTop=o,z.current.scrollTop!==o&&v(),M.current()}},[o,P,v,z]);const U=(R.width??1)>1;return l.useLayoutEffect(()=>{if(t!==void 0&&z.current!==null&&U){if(z.current.scrollLeft===t)return;z.current.scrollLeft=t,z.current.scrollLeft!==t&&v(),M.current()}},[t,U,v,z]),{visibleRegion:R,setVisibleRegion:L,scrollRef:z}}const bc=l.lazy(async()=>await Vl(()=>import("./data-grid-overlay-editor-Dh7oaF_L.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url));let yc=0;function xc(t){return gi(ur(ur(t).filter(o=>o.span!==void 0).map(o=>{var i,d;return Kt((((i=o.span)==null?void 0:i[0])??0)+1,(((d=o.span)==null?void 0:d[1])??0)+1)})))}function Ao(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(i=>({...i,x:i.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const Go={kind:Q.Loading,allowOverlay:!1},Po={columns:Y.empty(),rows:Y.empty(),current:void 0},Mc=(t,o)=>{var er,tr,or;const[i,d]=l.useState(Po),[w,y]=l.useState(),I=l.useRef(null),p=l.useRef(null),[R,L]=l.useState(),v=l.useRef(),M=typeof window>"u"?null:window,{imageEditorOverride:z,getRowThemeOverride:P,markdownDivCreateNode:U,width:_,height:ve,columns:O,rows:$,getCellContent:N,onCellClicked:pe,onCellActivated:ue,onFillPattern:ge,onFinishedEditing:q,coercePasteValue:ee,drawHeader:te,drawCell:X,editorBloom:je,onHeaderClicked:Le,onColumnProposeMove:ke,rangeSelectionColumnSpanning:oo=!0,spanRangeBehavior:dt="default",onGroupHeaderClicked:He,onCellContextMenu:Ae,className:Nt,onHeaderContextMenu:Ge,getCellsForSelection:Wo,onGroupHeaderContextMenu:D,onGroupHeaderRenamed:ne,onCellEdited:de,onCellsEdited:De,onSearchResultsChanged:Pe,searchResults:ft,onSearchValueChange:no,searchValue:Oo,onKeyDown:Wt,onKeyUp:ht,keybindings:ro,editOnType:lo=!0,onRowAppended:tt,onColumnMoved:gt,validateCell:mt,highlightRegions:vt,rangeSelect:_e="rect",columnSelect:be="multi",rowSelect:Se="multi",rangeSelectionBlending:Uo="exclusive",columnSelectionBlending:Ze="exclusive",rowSelectionBlending:Je="exclusive",onDelete:Bo,onDragStart:io,onMouseMove:co,onPaste:Ct,copyHeaders:wn=!1,freezeColumns:Ot=0,cellActivationBehavior:Vo="second-click",rowSelectionMode:_o="auto",onHeaderMenuClick:so,onHeaderIndicatorClick:ao,getGroupDetails:uo,rowGrouping:ot,onSearchClose:Xo,onItemHovered:fo,onSelectionCleared:nt,showSearch:pr,onVisibleRegionChanged:ho,gridSelection:wt,onGridSelectionChange:Yo,minColumnWidth:br=50,maxColumnWidth:yr=500,maxColumnAutoWidth:xr,provideEditor:Mr,trailingRowOptions:V,freezeTrailingRows:Ke=0,allowedFillDirections:pn="orthogonal",scrollOffsetX:Rr,scrollOffsetY:kr,verticalBorder:zt,onDragOverCell:Sr,onDrop:zr,onColumnResize:Ut,onColumnResizeEnd:Bt,onColumnResizeStart:Vt,customRenderers:go,fillHandle:Tr,experimental:ce,fixedShadowX:Er,fixedShadowY:Lr,headerIcons:Hr,imageWindowLoader:Dr,initialSize:Ir,isDraggable:Fr,onDragLeave:$r,onRowMoved:_t,overscrollX:Ar,overscrollY:Gr,preventDiagonalScrolling:Pr,rightElement:Kr,rightElementProps:Nr,trapFocus:bn=!1,smoothScrollX:Wr,smoothScrollY:Or,scaleToRem:Ur=!1,rowHeight:Br=34,headerHeight:yn=36,groupHeaderHeight:Vr=yn,theme:_r,isOutsideClick:Xr,renderers:qo,resizeIndicator:Yr,scrollToActiveCell:xn=!0,drawFocusRing:Mn=!0,portalElementRef:qr}=t,Rn=Mn==="no-editor"?w===void 0:Mn,re=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,Ne=(re==null?void 0:re.kind)??t.rowMarkers??"none",jr=(re==null?void 0:re.width)??t.rowMarkerWidth,kn=(re==null?void 0:re.startIndex)??t.rowMarkerStartIndex??1,Sn=(re==null?void 0:re.theme)??t.rowMarkerTheme,zn=re==null?void 0:re.headerTheme,Tn=re==null?void 0:re.headerAlwaysVisible,En=Se!=="multi",mo=(re==null?void 0:re.checkboxStyle)??"square",Tt=Math.max(br,20),vo=Math.max(yr,Tt),Zr=Math.max(xr??vo,Tt),Qe=typeof Ot=="number"?Ot:Ot[0],We=typeof Ot=="number"?0:Ot[1],Ln=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:Hn,rowHeight:Jr,getRowThemeOverride:et}=vc(ot,$,Br,P),Qr=l.useMemo(()=>Number.parseFloat(Ln.fontSize),[Ln]),{rowHeight:rt,headerHeight:jo,groupHeaderHeight:Dn,theme:In,overscrollX:el,overscrollY:tl}=hc({groupHeaderHeight:Vr,headerHeight:yn,overscrollX:Ar,overscrollY:Gr,remSize:Qr,rowHeight:Jr,scaleToRem:Ur,theme:_r}),lt=gc(ro),Et=jr??($>1e4?48:$>1e3?44:$>100?36:32),Xe=Ne!=="none",a=Xe?1:0,oe=tt!==void 0,Xt=(V==null?void 0:V.sticky)===!0,[ol,Fn]=l.useState(!1),nl=pr??ol,rl=l.useCallback(()=>{Xo!==void 0?Xo():Fn(!1)},[Xo]),g=l.useMemo(()=>wt===void 0?void 0:Ao(wt,a),[wt,a])??i,ze=l.useRef();ze.current===void 0&&(ze.current=new AbortController),l.useEffect(()=>()=>ze==null?void 0:ze.current.abort(),[]);const[me,ll]=lc(Wo,N,a,ze.current,F),il=l.useCallback((e,n,r)=>{if(mt===void 0)return!0;const c=[e[0]-a,e[1]];return mt==null?void 0:mt(c,n,r)},[a,mt]),Co=l.useRef(wt),Ie=l.useCallback((e,n)=>{n&&(e=Yl(e,me,a,dt,ze.current)),Yo!==void 0?(Co.current=Ao(e,-a),Yo(Co.current)):d(e)},[Yo,me,a,dt]),Lt=ut(Ut,l.useCallback((e,n,r,c)=>{Ut==null||Ut(O[r-a],n,r-a,c)},[Ut,a,O])),cl=ut(Bt,l.useCallback((e,n,r,c)=>{Bt==null||Bt(O[r-a],n,r-a,c)},[Bt,a,O])),sl=ut(Vt,l.useCallback((e,n,r,c)=>{Vt==null||Vt(O[r-a],n,r-a,c)},[Vt,a,O])),al=ut(te,l.useCallback((e,n)=>(te==null?void 0:te({...e,columnIndex:e.columnIndex-a},n))??!1,[te,a])),ul=ut(X,l.useCallback((e,n)=>(X==null?void 0:X({...e,col:e.col-a},n))??!1,[X,a])),it=l.useCallback(e=>{if(Bo!==void 0){const n=Bo(Ao(e,-a));return typeof n=="boolean"?n:Ao(n,a)}return!0},[Bo,a]),[ye,xe,se]=rc(g,Ie,Uo,Ze,Je,_e,oo),Ce=l.useMemo(()=>fn(hr(),In),[In]),[Zo,dl]=l.useState([0,0,0]),$n=l.useMemo(()=>{if(qo===void 0)return{};const e={};for(const n of qo)e[n.kind]=n;return e},[qo]),Me=l.useCallback(e=>e.kind!==Q.Custom?$n[e.kind]:go==null?void 0:go.find(n=>n.isMatch(e)),[go,$n]);let{sizedColumns:ae,nonGrowWidth:An}=oc(O,F,ll,Zo[0]-(a===0?0:Et)-Zo[2],Tt,Zr,Ce,Me,ze.current);Ne!=="none"&&(An+=Et);const Jo=l.useMemo(()=>ae.some(e=>e.group!==void 0),[ae]),Yt=Jo?jo+Dn:jo,Gn=g.rows.length,Pn=Ne==="none"?void 0:Gn===0?!1:Gn===F?!0:void 0,B=l.useMemo(()=>Ne==="none"?ae:[{title:"",width:Et,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Sn,rowMarker:mo,rowMarkerChecked:Pn,headerRowMarkerTheme:zn,headerRowMarkerAlwaysVisible:Tn,headerRowMarkerDisabled:En},...ae],[Ne,ae,Et,Sn,mo,Pn,zn,Tn,En]),Te=l.useRef({height:1,width:1,x:0,y:0}),wo=l.useRef(!1),{setVisibleRegion:Kn,visibleRegion:pt,scrollRef:j}=pc(Rr,kr,rt,Te,()=>wo.current=!0);Te.current=pt;const fl=pt.x+a,po=pt.y,fe=l.useRef(null),Re=l.useCallback(e=>{var n;e===!0?(n=fe.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=fe.current)==null||r.focus()})},[]),we=oe?F+1:F,Fe=l.useCallback(e=>{const n=a===0?e:e.map(c=>({...c,location:[c.location[0]-a,c.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const c of n)de==null||de(c.location,c.value);return r},[de,De,a]),[bt,Qo]=l.useState(),bo=g.current!==void 0&&g.current.range.width*g.current.range.height>1?g.current.range:void 0,Ht=Rn?(er=g.current)==null?void 0:er.cell:void 0,yo=Ht==null?void 0:Ht[0],xo=Ht==null?void 0:Ht[1],hl=l.useMemo(()=>{if((vt===void 0||vt.length===0)&&(bo??yo??xo??bt)===void 0)return;const e=[];if(vt!==void 0)for(const n of vt){const r=B.length-n.range.x-a;r>0&&e.push({color:n.color,range:{...n.range,x:n.range.x+a,width:Math.min(r,n.range.width)},style:n.style})}return bt!==void 0&&e.push({color:rr(Ce.accentColor,0),range:bt,style:"dashed"}),bo!==void 0&&e.push({color:rr(Ce.accentColor,.5),range:bo,style:"solid-outline"}),yo!==void 0&&xo!==void 0&&e.push({color:Ce.accentColor,range:{x:yo,y:xo,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[bt,bo,yo,xo,vt,B.length,Ce.accentColor,a]),Nn=l.useRef(B);Nn.current=B;const Ee=l.useCallback(([e,n],r=!1)=>{var h,u,f,m,C,b,S;const c=oe&&n===we-1;if(e===0&&Xe){if(c)return Go;const x=Hn(n);return x===void 0?Go:{kind:Io.Marker,allowOverlay:!1,checkboxStyle:mo,checked:(g==null?void 0:g.rows.hasIndex(n))===!0,markerKind:Ne==="clickable-number"?"number":Ne,row:kn+x,drawHandle:_t!==void 0,cursor:Ne==="clickable-number"?"pointer":void 0}}else if(c){const E=e===a?(V==null?void 0:V.hint)??"":"",k=Nn.current[e];if(((h=k==null?void 0:k.trailingRowOptions)==null?void 0:h.disabled)===!0)return Go;{const K=((u=k==null?void 0:k.trailingRowOptions)==null?void 0:u.hint)??E,H=((f=k==null?void 0:k.trailingRowOptions)==null?void 0:f.addIcon)??(V==null?void 0:V.addIcon);return{kind:Io.NewRow,hint:K,allowOverlay:!1,icon:H}}}else{const x=e-a;if(r||(ce==null?void 0:ce.strict)===!0){const k=Te.current,K=k.x>x||x>k.x+k.width||k.y>n||n>k.y+k.height||n>=tn.current,H=x===((C=(m=k.extras)==null?void 0:m.selected)==null?void 0:C[0])&&n===((b=k.extras)==null?void 0:b.selected[1]);let T=!1;if(((S=k.extras)==null?void 0:S.freezeRegions)!==void 0){for(const W of k.extras.freezeRegions)if(ql(W,x,n)){T=!0;break}}if(K&&!H&&!T)return Go}let E=N([x,n]);return a!==0&&E.span!==void 0&&(E={...E,span:[E.span[0]+a,E.span[1]+a]}),E}},[oe,we,Xe,Hn,mo,g==null?void 0:g.rows,Ne,kn,_t,a,V==null?void 0:V.hint,V==null?void 0:V.addIcon,ce==null?void 0:ce.strict,N]),en=l.useCallback(e=>{let n=(uo==null?void 0:uo(e))??{name:e};return ne!==void 0&&e!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>nn({group:n.name,bounds:r.bounds})}]}),n},[uo,ne]),Mo=l.useCallback(e=>{var f;const[n,r]=e.cell,c=B[n],s=(c==null?void 0:c.group)!==void 0?(f=en(c.group))==null?void 0:f.overrideTheme:void 0,h=c==null?void 0:c.themeOverride,u=et==null?void 0:et(r);y({...e,theme:fn(Ce,s,h,u,e.content.themeOverride)})},[et,B,en,Ce]),Dt=l.useCallback((e,n,r)=>{var u;if(g.current===void 0)return;const[c,s]=g.current.cell,h=Ee([c,s]);if(h.kind!==Q.Boolean&&h.allowOverlay){let f=h;if(r!==void 0)switch(f.kind){case Q.Number:{const m=jl(()=>r==="-"?-0:Number.parseFloat(r),0);f={...f,data:Number.isNaN(m)?0:m};break}case Q.Text:case Q.Markdown:case Q.Uri:f={...f,data:r};break}Mo({target:e,content:f,initialValue:r,cell:[c,s],highlight:r===void 0,forceEditMode:r!==void 0})}else h.kind===Q.Boolean&&n&&h.readonly!==!0&&(Fe([{location:g.current.cell,value:{...h,data:Zl(h.data)}}]),(u=fe.current)==null||u.damage([{cell:g.current.cell}]))},[Ee,g,Fe,Mo]),Wn=l.useCallback((e,n)=>{var s;const r=(s=fe.current)==null?void 0:s.getBounds(e,n);if(r===void 0||j.current===null)return;const c=Ee([e,n]);c.allowOverlay&&Mo({target:r,content:c,initialValue:void 0,highlight:!0,cell:[e,n],forceEditMode:!0})},[Ee,j,Mo]),le=l.useCallback((e,n,r="both",c=0,s=0,h=void 0)=>{if(j.current!==null){const u=fe.current,f=p.current,m=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,C=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,b=typeof e!="number"&&e.unit==="px"?e.amount:void 0,S=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(u!==null&&f!==null){let x={x:0,y:0,width:0,height:0},E=0,k=0;if((m!==void 0||C!==void 0)&&(x=u.getBounds((m??0)+a,C??0)??x,x.width===0||x.height===0))return;const K=f.getBoundingClientRect(),H=K.width/f.offsetWidth;if(b!==void 0&&(x={...x,x:b-K.left-j.current.scrollLeft,width:1}),S!==void 0&&(x={...x,y:S+K.top-j.current.scrollTop,height:1}),x!==void 0){const T={x:x.x-c,y:x.y-s,width:x.width+2*c,height:x.height+2*s};let W=0;for(let kt=0;kt<Qe;kt++)W+=ae[kt].width;let J=0;for(let kt=ae.length-1;kt>=ae.length-1-We;kt--)J+=ae[kt].width;let ie=0;const Rt=Ke+(Xt?1:0);Rt>0&&(ie=Jl(we,Rt,rt));let Be=W*H+K.left+a*Et*H,qe=K.right-J*H,Ve=K.top+Yt*H,Gt=K.bottom-ie*H;const Lo=x.width+c*2;switch(h==null?void 0:h.hAlign){case"start":qe=Be+Lo;break;case"end":Be=qe-Lo;break;case"center":Be=Math.floor((Be+qe)/2)-Lo/2,qe=Be+Lo;break}const Ho=x.height+s*2;switch(h==null?void 0:h.vAlign){case"start":Gt=Ve+Ho;break;case"end":Ve=Gt-Ho;break;case"center":Ve=Math.floor((Ve+Gt)/2)-Ho/2,Gt=Ve+Ho;break}Be>T.x?E=T.x-Be:qe<T.x+T.width&&(E=T.x+T.width-qe),Ve>T.y?k=T.y-Ve:Gt<T.y+T.height&&(k=T.y+T.height-Gt),r==="vertical"||typeof e=="number"&&(e<Qe||e>=B.length-We)?E=0:(r==="horizontal"||typeof n=="number"&&n>=we-Rt)&&(k=0),(E!==0||k!==0)&&(H!==1&&(E/=H,k/=H),j.current.scrollTo({left:E+j.current.scrollLeft,top:k+j.current.scrollTop,behavior:(h==null?void 0:h.behavior)??"auto"}))}}}},[a,Ke,Et,j,Yt,Qe,We,B.length,ae,we,Xt,rt]),On=l.useRef(Wn),Un=l.useRef(N),tn=l.useRef(F);On.current=Wn,Un.current=N,tn.current=F;const It=l.useCallback(async(e,n=!0,r)=>{var C;const c=B[e];if(((C=c==null?void 0:c.trailingRowOptions)==null?void 0:C.disabled)===!0)return;const s=tt==null?void 0:tt();let h,u=!0;s!==void 0&&(h=await s,h==="top"&&(u=!1),typeof h=="number"&&(u=!1));let f=0;const m=()=>{if(tn.current<=F){f<500&&window.setTimeout(m,f),f=50+f*2;return}const b=typeof h=="number"?h:u?F:0;Eo.current(e-a,b,"both",0,0,r?{behavior:r}:void 0),ye({cell:[e,b],range:{x:e,y:b,width:1,height:1}},!1,!1,"edit");const S=Un.current([e-a,b]);S.allowOverlay&&$o(S)&&S.readonly!==!0&&n&&window.setTimeout(()=>{On.current(e,b)},0)};m()},[B,tt,a,F,ye]),Ro=l.useCallback(e=>{var r,c;const n=((c=(r=ae[e])==null?void 0:r.trailingRowOptions)==null?void 0:c.targetColumn)??(V==null?void 0:V.targetColumn);if(typeof n=="number")return n+(Xe?1:0);if(typeof n=="object"){const s=O.indexOf(n);if(s>=0)return s+(Xe?1:0)}},[ae,O,Xe,V==null?void 0:V.targetColumn]),ct=l.useRef(),Ft=l.useRef(),qt=l.useCallback((e,n)=>{var s;const[r,c]=n;return fn(Ce,(s=B[r])==null?void 0:s.themeOverride,et==null?void 0:et(c),e.themeOverride)},[et,B,Ce]),{mapper:yt}=Cc(ot,$),Oe=ot==null?void 0:ot.navigationBehavior,jt=l.useCallback(e=>{var b,S,x;const n=No.value?e.metaKey:e.ctrlKey,r=n&&Se==="multi",c=n&&be==="multi",[s,h]=e.location,u=g.columns,f=g.rows,[m,C]=((b=g.current)==null?void 0:b.cell)??[];if(e.kind==="cell"){if(Ft.current=void 0,xt.current=[s,h],s===0&&Xe){if(oe===!0&&h===F||Ne==="number"||Se==="none")return;const E=Ee(e.location);if(E.kind!==Io.Marker)return;if(_t!==void 0){const H=Me(E);Ko((H==null?void 0:H.kind)===Io.Marker);const T=(S=H==null?void 0:H.onClick)==null?void 0:S.call(H,{...e,cell:E,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:qt(E,e.location),preventDefault:()=>{}});if(T===void 0||T.checked===E.checked)return}y(void 0),Re();const k=f.hasIndex(h),K=ct.current;if(Se==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&K!==void 0&&f.hasIndex(K)){const H=[Math.min(K,h),Math.max(K,h)+1];r||_o==="multi"?xe(void 0,H,!0):xe(Y.fromSingleSelection(H),void 0,r)}else Se==="multi"&&(r||e.isTouch||_o==="multi")?k?xe(f.remove(h),void 0,!0):(xe(void 0,h,!0),ct.current=h):k&&f.length===1?xe(Y.empty(),void 0,n):(xe(Y.fromSingleSelection(h),void 0,n),ct.current=h)}else if(s>=a&&oe&&h===F){const E=Ro(s);It(E??s)}else if(m!==s||C!==h){const E=Ee(e.location),k=Me(E);if((k==null?void 0:k.onSelect)!==void 0){let T=!1;if(k.onSelect({...e,cell:E,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>T=!0,theme:qt(E,e.location)}),T)return}if(Oe==="block"&&yt(h).isGroupHeader)return;const K=Xt&&h===F,H=Xt&&g!==void 0&&((x=g.current)==null?void 0:x.cell[1])===F;if((e.shiftKey||e.isLongTouch===!0)&&m!==void 0&&C!==void 0&&g.current!==void 0&&!H){if(K)return;const T=Math.min(s,m),W=Math.max(s,m),J=Math.min(h,C),ie=Math.max(h,C);ye({...g.current,range:{x:T,y:J,width:W-T+1,height:ie-J+1}},!0,n,"click"),ct.current=void 0,Re()}else ye({cell:[s,h],range:{x:s,y:h,width:1,height:1}},!0,n,"click"),ct.current=void 0,y(void 0),Re()}}else if(e.kind==="header")if(xt.current=[s,h],y(void 0),Xe&&s===0)ct.current=void 0,Ft.current=void 0,Se==="multi"&&(f.length!==F?xe(Y.fromSingleSelection([0,F]),void 0,n):xe(Y.empty(),void 0,n),Re());else{const E=Ft.current;if(be==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&E!==void 0&&u.hasIndex(E)){const k=[Math.min(E,s),Math.max(E,s)+1];c?se(void 0,k,n):se(Y.fromSingleSelection(k),void 0,n)}else c?(u.hasIndex(s)?se(u.remove(s),void 0,n):se(void 0,s,n),Ft.current=s):be!=="none"&&(u.hasIndex(s)?se(u.remove(s),void 0,n):se(Y.fromSingleSelection(s),void 0,n),Ft.current=s);ct.current=void 0,Re()}else e.kind===Pt?xt.current=[s,h]:e.kind===lr&&!e.isMaybeScrollbar&&(Ie(Po,!1),y(void 0),Re(),nt==null||nt(),ct.current=void 0,Ft.current=void 0)},[Se,be,g,Xe,a,oe,F,Ne,Ee,_t,Re,_o,Me,qt,xe,Ro,It,Oe,yt,Xt,ye,se,Ie,nt]),Zt=l.useRef(!1),xt=l.useRef(),Bn=l.useRef(pt),$e=l.useRef(),gl=l.useCallback(e=>{if($t.current=!1,Bn.current=Te.current,e.button!==0&&e.button!==1){$e.current=void 0;return}const n=performance.now();$e.current={button:e.button,time:n,location:e.location},(e==null?void 0:e.kind)==="header"&&(Zt.current=!0);const r=e.kind==="cell"&&e.isFillHandle;!r&&e.kind!=="cell"&&e.isEdge||(L({previousSelection:g,fillHandle:r}),xt.current=void 0,!e.isTouch&&e.button===0&&!r?jt(e):!e.isTouch&&e.button===1&&(xt.current=e.location))},[g,jt]),[on,nn]=l.useState(),Vn=l.useCallback(e=>{if(e.kind!==Pt||be!=="multi")return;const n=No.value?e.metaKey:e.ctrlKey,[r]=e.location,c=g.columns;if(r<a)return;const s=B[r];let h=r,u=r;for(let f=r-1;f>=a&&ir(s.group,B[f].group);f--)h--;for(let f=r+1;f<B.length&&ir(s.group,B[f].group);f++)u++;if(Re(),n)if(c.hasAll([h,u+1])){let f=c;for(let m=h;m<=u;m++)f=f.remove(m);se(f,void 0,n)}else se(void 0,[h,u+1],n);else se(Y.fromSingleSelection([h,u+1]),void 0,n)},[be,Re,g.columns,B,a,se]),$t=l.useRef(!1),ko=l.useCallback(async e=>{if(me!==void 0&&Lt!==void 0){const n=Te.current.y,r=Te.current.height;let c=me({x:e,y:n,width:1,height:Math.min(r,F-n)},ze.current.signal);typeof c!="object"&&(c=await c());const s=ae[e-a],u=document.createElement("canvas").getContext("2d",{alpha:!1});if(u!==null){u.font=Ce.baseFontFull;const f=mr(u,Ce,s,0,c,Tt,vo,!1,Me);Lt==null||Lt(s,f.width,e,f.width)}}},[ae,me,vo,Ce,Tt,Lt,a,F,Me]),[ml,rn]=l.useState(),At=l.useCallback(async(e,n)=>{var f,m;const r=(f=e.current)==null?void 0:f.range;if(r===void 0||me===void 0||n.current===void 0)return;const c=n.current.range;if(ge!==void 0){let C=!1;if(ge({fillDestination:{...c,x:c.x-a},patternSource:{...r,x:r.x-a},preventDefault:()=>C=!0}),C)return}let s=me(r,ze.current.signal);typeof s!="object"&&(s=await s());const h=s,u=[];for(let C=0;C<c.width;C++)for(let b=0;b<c.height;b++){const S=[c.x+C,c.y+b];if(Ql(S,r))continue;const x=h[b%r.height][C%r.width];Fo(x)||!$o(x)||u.push({location:S,value:{...x}})}Fe(u),(m=fe.current)==null||m.damage(u.map(C=>({cell:C.location})))},[me,Fe,ge,a]),_n=l.useCallback(()=>{if(g.current===void 0||g.current.range.width<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,width:1}}};At(e,g)},[At,g]),Xn=l.useCallback(()=>{if(g.current===void 0||g.current.range.height<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,height:1}}};At(e,g)},[At,g]),vl=l.useCallback((e,n)=>{var b,S;const r=R;if(L(void 0),Qo(void 0),rn(void 0),Zt.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&g.current!==void 0&&((b=r.previousSelection)==null?void 0:b.current)!==void 0){if(bt===void 0)return;const x={...g,current:{...g.current,range:ei(r.previousSelection.current.range,bt)}};At(r.previousSelection,x),Ie(x,!0);return}const[c,s]=e.location,[h,u]=xt.current??[],f=()=>{$t.current=!0},m=x=>{var k,K,H;const E=x.isTouch||h===c&&u===s;if(E&&(pe==null||pe([c-a,s],{...x,preventDefault:f})),x.button===1)return!$t.current;if(!$t.current){const T=Ee(e.location),W=Me(T);if(W!==void 0&&W.onClick!==void 0&&E){const ie=W.onClick({...x,cell:T,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:qt(T,e.location),preventDefault:f});ie!==void 0&&!Fo(ie)&&to(ie)&&(Fe([{location:x.location,value:ie}]),(k=fe.current)==null||k.damage([{cell:x.location}]))}if($t.current||g.current===void 0)return!1;let J=!1;switch(T.activationBehaviorOverride??Vo){case"double-click":case"second-click":{if(((H=(K=r==null?void 0:r.previousSelection)==null?void 0:K.current)==null?void 0:H.cell)===void 0)break;const[ie,Rt]=g.current.cell,[Be,qe]=r.previousSelection.current.cell;J=c===ie&&c===Be&&s===Rt&&s===qe&&(x.isDoubleClick===!0||Vo==="second-click");break}case"single-click":{J=!0;break}}if(J)return ue==null||ue([c-a,s]),Dt(x.bounds,!1),!0}return!1},C=e.location[0]-a;if(e.isTouch){const x=Te.current,E=Bn.current;if(x.x!==E.x||x.y!==E.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&ti((S=g.current)==null?void 0:S.cell,e.location)){Ae==null||Ae([C,e.location[1]],{...e,preventDefault:f});return}else if(e.kind==="header"&&g.columns.hasIndex(c)){Ge==null||Ge(C,{...e,preventDefault:f});return}else if(e.kind===Pt){if(C<0)return;D==null||D(C,{...e,preventDefault:f});return}}e.kind==="cell"?m(e)||jt(e):e.kind===Pt?He==null||He(C,{...e,preventDefault:f}):(e.kind===oi&&(Le==null||Le(C,{...e,preventDefault:f})),jt(e));return}if(e.kind==="header"){if(C<0)return;e.isEdge?e.isDoubleClick===!0&&ko(c):e.button===0&&c===h&&s===u&&(Le==null||Le(C,{...e,preventDefault:f}))}if(e.kind===Pt){if(C<0)return;e.button===0&&c===h&&s===u&&(He==null||He(C,{...e,preventDefault:f}),$t.current||Vn(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&m(e),xt.current=void 0},[R,g,a,bt,At,Ie,pe,Ee,Me,Vo,qt,Fe,ue,Dt,Ae,Ge,D,jt,He,Le,ko,Vn]),Cl=l.useCallback(e=>{const n={...e,location:[e.location[0]-a,e.location[1]]};co==null||co(n),R!==void 0&&e.buttons===0&&(L(void 0),Qo(void 0),rn(void 0),Zt.current=!1),rn(r=>{var c;return Zt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(r==null?void 0:r[0])&&e.scrollEdge[1]===r[1]?r:R===void 0||(((c=$e.current)==null?void 0:c.location[0])??0)<a?void 0:e.scrollEdge})},[R,co,a]),wl=l.useCallback((e,n)=>{so==null||so(e-a,n)},[so,a]),pl=l.useCallback((e,n)=>{ao==null||ao(e-a,n)},[ao,a]),Ye=(tr=g==null?void 0:g.current)==null?void 0:tr.cell,bl=l.useCallback((e,n,r,c,s,h)=>{wo.current=!1;let u=Ye;u!==void 0&&(u=[u[0]-a,u[1]]);const f=Qe===0?void 0:{x:0,y:e.y,width:Qe,height:e.height},m=We===0?void 0:{x:ae.length-We,y:e.y,width:We,height:e.height},C=[];f!==void 0&&C.push(f),m!==void 0&&C.push(m),Ke>0&&(C.push({x:e.x-a,y:F-Ke,width:e.width,height:Ke}),Qe>0&&C.push({x:0,y:F-Ke,width:Qe,height:Ke}),We>0&&C.push({x:ae.length-We,y:F-Ke,width:We,height:Ke}));const b={x:e.x-a,y:e.y,width:e.width,height:oe&&e.y+e.height>=F?e.height-1:e.height,tx:s,ty:h,extras:{selected:u,freezeRegion:f,freezeRegions:C}};Te.current=b,Kn(b),dl([n,r,c]),ho==null||ho(b,b.tx,b.ty,b.extras)},[Ye,a,oe,F,Qe,We,ae.length,Ke,Kn,ho]),yl=ut(ke,l.useCallback((e,n)=>(ke==null?void 0:ke(e-a,n-a))!==!1,[ke,a])),xl=ut(gt,l.useCallback((e,n)=>{gt==null||gt(e-a,n-a),be!=="none"&&se(Y.fromSingleSelection(n),void 0,!0)},[be,gt,a,se])),ln=l.useRef(!1),Ml=l.useCallback(e=>{if(e.location[0]===0&&a>0){e.preventDefault();return}io==null||io({...e,location:[e.location[0]-a,e.location[1]]}),e.defaultPrevented()||(ln.current=!0),L(void 0)},[io,a]),Rl=l.useCallback(()=>{ln.current=!1},[]),Yn=ot==null?void 0:ot.selectionBehavior,So=l.useCallback(e=>{if(Yn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:c}=yt(e);if(n)return[e,e];const s=r[r.length-1],h=e-s,u=e+c-s-1;return[h,u]},[yt,Yn]),cn=l.useRef(),sn=l.useCallback(e=>{var n,r,c;if(!ni(e,cn.current)&&(cn.current=e,!(((n=$e==null?void 0:$e.current)==null?void 0:n.button)!==void 0&&$e.current.button>=1))){if(e.buttons!==0&&R!==void 0&&((r=$e.current)==null?void 0:r.location[0])===0&&e.location[0]===0&&a===1&&Se==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex($e.current.location[1])&&g.rows.hasIndex($e.current.location[1])){const s=Math.min($e.current.location[1],e.location[1]),h=Math.max($e.current.location[1],e.location[1])+1;xe(Y.fromSingleSelection([s,h]),void 0,!1)}if(e.buttons!==0&&R!==void 0&&g.current!==void 0&&!ln.current&&!Zt.current&&(_e==="rect"||_e==="multi-rect")){const[s,h]=g.current.cell;let[u,f]=e.location;if(f<0&&(f=Te.current.y),R.fillHandle===!0&&((c=R.previousSelection)==null?void 0:c.current)!==void 0){const m=R.previousSelection.current.range;f=Math.min(f,oe?F-1:F);const C=ri(m,u,f,pn);Qo(C)}else{if(oe&&h===F)return;if(oe&&f===F)if(e.kind===lr)f--;else return;u=Math.max(u,a);const b=So(h);f=b===void 0?f:St(f,b[0],b[1]);const S=u-s,x=f-h,E={x:S>=0?s:u,y:x>=0?h:f,width:Math.abs(S)+1,height:Math.abs(x)+1};ye({...g.current,range:E},!0,!1,"drag")}}fo==null||fo({...e,location:[e.location[0]-a,e.location[1]]})}},[R,a,Se,g,_e,fo,xe,oe,F,pn,So,ye]),kl=l.useCallback(()=>{var u,f;const e=cn.current;if(e===void 0)return;const[n,r]=e.scrollEdge;let[c,s]=e.location;const h=Te.current;n===-1?c=((f=(u=h.extras)==null?void 0:u.freezeRegion)==null?void 0:f.x)??h.x:n===1&&(c=h.x+h.width),r===-1?s=Math.max(0,h.y):r===1&&(s=Math.min(F-1,h.y+h.height)),c=St(c,0,B.length-1),s=St(s,0,F-1),sn({...e,location:[c,s]})},[B.length,sn,F]);fc(ml,j,kl);const Ue=l.useCallback(e=>{if(g.current===void 0)return;const[n,r]=e,[c,s]=g.current.cell,h=g.current.range;let u=h.x,f=h.x+h.width,m=h.y,C=h.y+h.height;const[b,S]=So(s)??[0,F-1],x=S+1;if(r!==0)switch(r){case 2:{C=x,m=s,le(0,C,"vertical");break}case-2:{m=b,C=s+1,le(0,m,"vertical");break}case 1:{m<s?(m++,le(0,m,"vertical")):(C=Math.min(x,C+1),le(0,C,"vertical"));break}case-1:{C>s+1?(C--,le(0,C,"vertical")):(m=Math.max(b,m-1),le(0,m,"vertical"));break}default:cr()}if(n!==0)if(n===2)f=B.length,u=c,le(f-1-a,0,"horizontal");else if(n===-2)u=a,f=c+1,le(u-a,0,"horizontal");else{let E=[];if(me!==void 0){const k=me({x:u,y:m,width:f-u-a,height:C-m},ze.current.signal);typeof k=="object"&&(E=xc(k))}if(n===1){let k=!1;if(u<c){if(E.length>0){const K=Kt(u+1,c+1).find(H=>!E.includes(H-a));K!==void 0&&(u=K,k=!0)}else u++,k=!0;k&&le(u,0,"horizontal")}k||(f=Math.min(B.length,f+1),le(f-1-a,0,"horizontal"))}else if(n===-1){let k=!1;if(f>c+1){if(E.length>0){const K=Kt(f-1,c,-1).find(H=>!E.includes(H-a));K!==void 0&&(f=K,k=!0)}else f--,k=!0;k&&le(f-a,0,"horizontal")}k||(u=Math.max(a,u-1),le(u-a,0,"horizontal"))}else cr()}ye({cell:g.current.cell,range:{x:u,y:m,width:f-u,height:C-m}},!0,!1,"keyboard-select")},[me,So,g,B.length,a,F,le,ye]),an=l.useRef(xn);an.current=xn;const st=l.useCallback((e,n,r,c)=>{const s=we-(r?0:1);e=St(e,a,ae.length-1+a),n=St(n,0,s);const h=Ye==null?void 0:Ye[0],u=Ye==null?void 0:Ye[1];if(e===h&&n===u)return!1;if(c&&g.current!==void 0){const f=[...g.current.rangeStack];(g.current.range.width>1||g.current.range.height>1)&&f.push(g.current.range),Ie({...g,current:{cell:[e,n],range:{x:e,y:n,width:1,height:1},rangeStack:f}},!0)}else ye({cell:[e,n],range:{x:e,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===e&&v.current[1]===n&&(v.current=void 0),an.current&&le(e-a,n),!0},[we,a,ae.length,Ye,g,le,Ie,ye]),Sl=l.useCallback((e,n)=>{(w==null?void 0:w.cell)!==void 0&&e!==void 0&&to(e)&&(Fe([{location:w.cell,value:e}]),window.requestAnimationFrame(()=>{var s;(s=fe.current)==null||s.damage([{cell:w.cell}])})),Re(!0),y(void 0);const[r,c]=n;if(g.current!==void 0&&(r!==0||c!==0)){const s=g.current.cell[1]===we-1&&e!==void 0;st(St(g.current.cell[0]+r,0,B.length-1),St(g.current.cell[1]+c,0,we-1),s,!1)}q==null||q(e,n)},[w==null?void 0:w.cell,Re,g,q,Fe,we,st,B.length]),zl=l.useMemo(()=>`gdg-overlay-${yc++}`,[]),Mt=l.useCallback(e=>{var r,c,s,h;Re();const n=[];for(let u=e.x;u<e.x+e.width;u++)for(let f=e.y;f<e.y+e.height;f++){const m=N([u-a,f]);if(!m.allowOverlay&&m.kind!==Q.Boolean)continue;let C;if(m.kind===Q.Custom){const b=Me(m),S=(r=b==null?void 0:b.provideEditor)==null?void 0:r.call(b,m);(b==null?void 0:b.onDelete)!==void 0?C=b.onDelete(m):li(S)&&(C=(c=S==null?void 0:S.deletedValue)==null?void 0:c.call(S,m))}else if(to(m)&&m.allowOverlay||m.kind===Q.Boolean){const b=Me(m);C=(s=b==null?void 0:b.onDelete)==null?void 0:s.call(b,m)}C!==void 0&&!Fo(C)&&to(C)&&n.push({location:[u,f],value:C})}Fe(n),(h=fe.current)==null||h.damage(n.map(u=>({cell:u.location})))},[Re,N,Me,Fe,a]),Jt=w!==void 0,qn=l.useCallback(e=>{var K,H;const n=()=>{e.stopPropagation(),e.preventDefault()},r={didMatch:!1},{bounds:c}=e,s=g.columns,h=g.rows,u=lt;if(!Jt&&A(u.clear,e,r))Ie(Po,!1),nt==null||nt();else if(!Jt&&A(u.selectAll,e,r))Ie({columns:Y.empty(),rows:Y.empty(),current:{cell:((K=g.current)==null?void 0:K.cell)??[a,0],range:{x:a,y:0,width:O.length,height:F},rangeStack:[]}},!1);else if(A(u.search,e,r))(H=I==null?void 0:I.current)==null||H.focus({preventScroll:!0}),Fn(!0);else if(A(u.delete,e,r)){const T=(it==null?void 0:it(g))??!0;if(T!==!1){const W=T===!0?g:T;if(W.current!==void 0){Mt(W.current.range);for(const J of W.current.rangeStack)Mt(J)}for(const J of W.rows)Mt({x:a,y:J,width:O.length,height:1});for(const J of W.columns)Mt({x:J,y:0,width:1,height:F})}}if(r.didMatch)return n(),!0;if(g.current===void 0)return!1;let[f,m]=g.current.cell;const[,C]=g.current.cell;let b=!1,S=!1;if(A(u.scrollToSelectedCell,e,r)?Eo.current(f-a,m):be!=="none"&&A(u.selectColumn,e,r)?s.hasIndex(f)?se(s.remove(f),void 0,!0):be==="single"?se(Y.fromSingleSelection(f),void 0,!0):se(void 0,f,!0):Se!=="none"&&A(u.selectRow,e,r)?h.hasIndex(m)?xe(h.remove(m),void 0,!0):Se==="single"?xe(Y.fromSingleSelection(m),void 0,!0):xe(void 0,m,!0):!Jt&&c!==void 0&&A(u.activateCell,e,r)?m===F&&oe?window.setTimeout(()=>{const T=Ro(f);It(T??f)},0):(ue==null||ue([f-a,m]),Dt(c,!0)):g.current.range.height>1&&A(u.downFill,e,r)?Xn():g.current.range.width>1&&A(u.rightFill,e,r)?_n():A(u.goToNextPage,e,r)?m+=Math.max(1,Te.current.height-4):A(u.goToPreviousPage,e,r)?m-=Math.max(1,Te.current.height-4):A(u.goToFirstCell,e,r)?(y(void 0),m=0,f=0):A(u.goToLastCell,e,r)?(y(void 0),m=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(u.selectToFirstCell,e,r)?(y(void 0),Ue([-2,-2])):A(u.selectToLastCell,e,r)?(y(void 0),Ue([2,2])):Jt?(A(u.closeOverlay,e,r)&&y(void 0),A(u.acceptOverlayDown,e,r)&&(y(void 0),m++),A(u.acceptOverlayUp,e,r)&&(y(void 0),m--),A(u.acceptOverlayLeft,e,r)&&(y(void 0),f--),A(u.acceptOverlayRight,e,r)&&(y(void 0),f++)):(A(u.goDownCell,e,r)?m+=1:A(u.goUpCell,e,r)?m-=1:A(u.goRightCell,e,r)?f+=1:A(u.goLeftCell,e,r)?f-=1:A(u.goDownCellRetainSelection,e,r)?(m+=1,b=!0):A(u.goUpCellRetainSelection,e,r)?(m-=1,b=!0):A(u.goRightCellRetainSelection,e,r)?(f+=1,b=!0):A(u.goLeftCellRetainSelection,e,r)?(f-=1,b=!0):A(u.goToLastRow,e,r)?m=F-1:A(u.goToFirstRow,e,r)?m=Number.MIN_SAFE_INTEGER:A(u.goToLastColumn,e,r)?f=Number.MAX_SAFE_INTEGER:A(u.goToFirstColumn,e,r)?f=Number.MIN_SAFE_INTEGER:(_e==="rect"||_e==="multi-rect")&&(A(u.selectGrowDown,e,r)?Ue([0,1]):A(u.selectGrowUp,e,r)?Ue([0,-1]):A(u.selectGrowRight,e,r)?Ue([1,0]):A(u.selectGrowLeft,e,r)?Ue([-1,0]):A(u.selectToLastRow,e,r)?Ue([0,2]):A(u.selectToFirstRow,e,r)?Ue([0,-2]):A(u.selectToLastColumn,e,r)?Ue([2,0]):A(u.selectToFirstColumn,e,r)&&Ue([-2,0])),S=r.didMatch),Oe!==void 0&&Oe!=="normal"&&m!==C){const T=Oe==="skip-up"||Oe==="skip"||Oe==="block",W=Oe==="skip-down"||Oe==="skip"||Oe==="block",J=m<C;if(J&&T){for(;m>=0&&yt(m).isGroupHeader;)m--;m<0&&(m=C)}else if(!J&&W){for(;m<F&&yt(m).isGroupHeader;)m++;m>=F&&(m=C)}}const E=st(f,m,!1,b),k=r.didMatch;return k&&(E||!S||bn)&&n(),k},[Oe,Jt,g,lt,be,Se,_e,a,yt,F,st,Ie,nt,O.length,it,bn,Mt,se,xe,oe,Ro,It,ue,Dt,Xn,_n,Ue]),Qt=l.useCallback(e=>{let n=!1;if(Wt!==void 0&&Wt({...e,...e.location&&{location:[e.location[0]-a,e.location[1]]},cancel:()=>{n=!0}}),n||qn(e)||g.current===void 0)return;const[r,c]=g.current.cell,s=Te.current;if(lo&&!e.metaKey&&!e.ctrlKey&&g.current!==void 0&&e.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(e.key)&&e.bounds!==void 0&&$o(N([r-a,Math.max(0,Math.min(c,F-1))]))){if((!oe||c!==F)&&(s.y>c||c>s.y+s.height||s.x>r||r>s.x+s.width))return;Dt(e.bounds,!0,e.key),e.stopPropagation(),e.preventDefault()}},[lo,Wt,qn,g,N,a,F,oe,Dt]),Tl=l.useCallback((e,n)=>{const r=e.location[0]-a;if(e.kind==="header"&&(Ge==null||Ge(r,{...e,preventDefault:n})),e.kind===Pt){if(r<0)return;D==null||D(r,{...e,preventDefault:n})}if(e.kind==="cell"){const[c,s]=e.location;Ae==null||Ae([r,s],{...e,preventDefault:n}),ii(g,e.location)||st(c,s,!1,!1)}},[g,Ae,D,Ge,a,st]),un=l.useCallback(async e=>{var u,f,m;if(!lt.paste)return;function n(C,b,S,x){var k,K;const E=typeof S=="object"?(S==null?void 0:S.join(`
`))??"":(S==null?void 0:S.toString())??"";if(!Fo(C)&&$o(C)&&C.readonly!==!0){const H=ee==null?void 0:ee(E,C);if(H!==void 0&&to(H))return{location:b,value:H};const T=Me(C);if(T===void 0)return;if(T.kind===Q.Custom){Ko(C.kind===Q.Custom);const W=(k=T.onPaste)==null?void 0:k.call(T,E,C.data);return W===void 0?void 0:{location:b,value:{...C,data:W}}}else{const W=(K=T.onPaste)==null?void 0:K.call(T,E,C,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:S});return W===void 0?void 0:(Ko(W.kind===C.kind),{location:b,value:W})}}}const r=g.columns,c=g.rows,s=((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0;let h;if(g.current!==void 0?h=[g.current.range.x,g.current.range.y]:r.length===1?h=[r.first()??0,0]:c.length===1&&(h=[a,c.first()??0]),s&&h!==void 0){let C,b;const S="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const H=await navigator.clipboard.read();for(const T of H){if(T.types.includes(x)){const J=await(await T.getType(x)).text(),ie=sr(J);if(ie!==void 0){C=ie;break}}T.types.includes(S)&&(b=await(await T.getType(S)).text())}}else if(navigator.clipboard.readText!==void 0)b=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(x)){const H=e.clipboardData.getData(x);C=sr(H)}C===void 0&&e.clipboardData.types.includes(S)&&(b=e.clipboardData.getData(S))}else return;const[E,k]=h,K=[];do{if(Ct===void 0){const H=Ee(h),T=b??(C==null?void 0:C.map(J=>J.map(ie=>ie.rawValue).join("	")).join("	"))??"",W=n(H,h,T,void 0);W!==void 0&&K.push(W);break}if(C===void 0){if(b===void 0)return;C=ci(b)}if(Ct===!1||typeof Ct=="function"&&(Ct==null?void 0:Ct([h[0]-a,h[1]],C.map(H=>H.map(T=>{var W;return((W=T.rawValue)==null?void 0:W.toString())??""}))))!==!0)return;for(const[H,T]of C.entries()){if(H+k>=F)break;for(const[W,J]of T.entries()){const ie=[W+E,H+k],[Rt,Be]=ie;if(Rt>=B.length||Be>=we)continue;const qe=Ee(ie),Ve=n(qe,ie,J.rawValue,J.formatted);Ve!==void 0&&K.push(Ve)}}}while(!1);Fe(K),(m=fe.current)==null||m.damage(K.map(H=>({cell:H.location})))}},[ee,Me,Ee,g,lt.paste,j,B.length,Fe,we,Ct,a,F]);hn("paste",un,M,!1,!0);const eo=l.useCallback(async(e,n)=>{var u,f;if(!lt.copy)return;const r=n===!0||((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0,c=g.columns,s=g.rows,h=(m,C)=>{if(!wn)ar(m,C,e);else{const b=C.map(S=>({kind:Q.Text,data:O[S].title,displayData:O[S].title,allowOverlay:!1}));ar([b,...m],C,e)}};if(r&&me!==void 0){if(g.current!==void 0){let m=me(g.current.range,ze.current.signal);typeof m!="object"&&(m=await m()),h(m,Kt(g.current.range.x-a,g.current.range.x+g.current.range.width-a))}else if(s!==void 0&&s.length>0){const C=[...s].map(b=>{const S=me({x:a,y:b,width:O.length,height:1},ze.current.signal);return typeof S=="object"?S[0]:S().then(x=>x[0])});if(C.some(b=>b instanceof Promise)){const b=await Promise.all(C);h(b,Kt(O.length))}else h(C,Kt(O.length))}else if(c.length>0){const m=[],C=[];for(const b of c){let S=me({x:b,y:0,width:1,height:F},ze.current.signal);typeof S!="object"&&(S=await S()),m.push(S),C.push(b-a)}if(m.length===1)h(m[0],C);else{const b=m.reduce((S,x)=>S.map((E,k)=>[...E,...x[k]]));h(b,C)}}}},[O,me,g,lt.copy,a,j,F,wn]);hn("copy",eo,M,!1,!1);const El=l.useCallback(async e=>{var r,c;if(!(!lt.cut||!(((r=j.current)==null?void 0:r.contains(document.activeElement))===!0||((c=p.current)==null?void 0:c.contains(document.activeElement))===!0))&&(await eo(e),g.current!==void 0)){let s={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:Y.empty(),columns:Y.empty()};const h=it==null?void 0:it(s);if(h===!1||(s=h===!0?s:h,s.current===void 0))return;Mt(s.current.range)}},[Mt,g,lt.cut,eo,j,it]);hn("cut",El,M,!1,!1);const Ll=l.useCallback((e,n)=>{if(Pe!==void 0){a!==0&&(e=e.map(s=>[s[0]-a,s[1]])),Pe(e,n);return}if(e.length===0||n===-1)return;const[r,c]=e[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===c||(v.current=[r,c],st(r,c,!1,!1))},[Pe,a,st]),[zo,To]=((or=wt==null?void 0:wt.current)==null?void 0:or.cell)??[],Eo=l.useRef(le);Eo.current=le,l.useLayoutEffect(()=>{var e,n,r,c;an.current&&!wo.current&&zo!==void 0&&To!==void 0&&(zo!==((n=(e=Co.current)==null?void 0:e.current)==null?void 0:n.cell[0])||To!==((c=(r=Co.current)==null?void 0:r.current)==null?void 0:c.cell[1]))&&Eo.current(zo,To),wo.current=!1},[zo,To]);const jn=g.current!==void 0&&(g.current.cell[0]>=B.length||g.current.cell[1]>=we);l.useLayoutEffect(()=>{jn&&Ie(Po,!1)},[jn,Ie]);const Hl=l.useMemo(()=>oe===!0&&(V==null?void 0:V.tint)===!0?Y.fromSingleSelection(we-1):Y.empty(),[we,oe,V==null?void 0:V.tint]),Dl=l.useCallback(e=>typeof zt=="boolean"?zt:(zt==null?void 0:zt(e-a))??!0,[a,zt]),Il=l.useMemo(()=>{if(on===void 0||p.current===null)return null;const{bounds:e,group:n}=on,r=p.current.getBoundingClientRect();return l.createElement(ec,{bounds:e,group:n,canvasBounds:r,onClose:()=>nn(void 0),onFinish:c=>{nn(void 0),ne==null||ne(n,c)}})},[ne,on]),Fl=Math.min(B.length,Qe+(Xe?1:0));l.useImperativeHandle(o,()=>({appendRow:(e,n)=>It(e+a,n),updateCells:e=>{var n;return a!==0&&(e=e.map(r=>({cell:[r.cell[0]+a,r.cell[1]]}))),(n=fe.current)==null?void 0:n.damage(e)},getBounds:(e,n)=>{var r;if(!((p==null?void 0:p.current)===null||(j==null?void 0:j.current)===null)){if(e===void 0&&n===void 0){const c=p.current.getBoundingClientRect(),s=c.width/j.current.clientWidth;return{x:c.x-j.current.scrollLeft*s,y:c.y-j.current.scrollTop*s,width:j.current.scrollWidth*s,height:j.current.scrollHeight*s}}return(r=fe.current)==null?void 0:r.getBounds((e??0)+a,n)}},focus:()=>{var e;return(e=fe.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await eo(void 0,!0);break;case"paste":await un();break}},scrollTo:le,remeasureColumns:e=>{for(const n of e)ko(n+a)},getMouseArgsForPosition:(e,n,r)=>{if((fe==null?void 0:fe.current)===null)return;const c=fe.current.getMouseArgsForPosition(e,n,r);if(c!==void 0)return{...c,location:[c.location[0]-a,c.location[1]]}}}),[It,ko,j,eo,Qt,un,a,le]);const[Zn,Jn]=Ye??[],$l=l.useCallback(e=>{const[n,r]=e;if(r===-1){be!=="none"&&(se(Y.fromSingleSelection(n),void 0,!1),Re());return}Zn===n&&Jn===r||(ye({cell:e,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),le(n,r))},[be,Re,le,Zn,Jn,ye,se]),[Al,Gl]=l.useState(!1),Qn=l.useRef(hi(e=>{Gl(e)},5)),Pl=l.useCallback(()=>{Qn.current(!0),g.current===void 0&&g.columns.length===0&&g.rows.length===0&&R===void 0&&ye({cell:[a,po],range:{x:a,y:po,width:1,height:1}},!0,!1,"keyboard-select")},[po,g,R,a,ye]),Kl=l.useCallback(()=>{Qn.current(!1)},[]),[Nl,Wl]=l.useMemo(()=>{let e;const n=(ce==null?void 0:ce.scrollbarWidthOverride)??si(),r=F+(oe?1:0);if(typeof rt=="number")e=Yt+r*rt;else{let s=0;const h=Math.min(r,10);for(let u=0;u<h;u++)s+=rt(u);s=Math.floor(s/h),e=Yt+r*s}e+=n;const c=B.reduce((s,h)=>h.width+s,0)+n;return[`${Math.min(1e5,c)}px`,`${Math.min(1e5,e)}px`]},[B,ce==null?void 0:ce.scrollbarWidthOverride,rt,F,oe,Yt]),Ol=l.useMemo(()=>ai(Ce),[Ce]);return l.createElement(ui.Provider,{value:Ce},l.createElement(ac,{style:Ol,className:Nt,inWidth:_??Nl,inHeight:ve??Wl},l.createElement(ji,{fillHandle:Tr,drawFocusRing:Rn,experimental:ce,fixedShadowX:Er,fixedShadowY:Lr,getRowThemeOverride:et,headerIcons:Hr,imageWindowLoader:Dr,initialSize:Ir,isDraggable:Fr,onDragLeave:$r,onRowMoved:_t,overscrollX:el,overscrollY:tl,preventDiagonalScrolling:Pr,rightElement:Kr,rightElementProps:Nr,smoothScrollX:Wr,smoothScrollY:Or,className:Nt,enableGroups:Jo,onCanvasFocused:Pl,onCanvasBlur:Kl,canvasRef:p,onContextMenu:Tl,theme:Ce,cellXOffset:fl,cellYOffset:po,accessibilityHeight:pt.height,onDragEnd:Rl,columns:B,nonGrowWidth:An,drawHeader:al,onColumnProposeMove:yl,drawCell:ul,disabledRows:Hl,freezeColumns:[Fl,We],lockColumns:a,firstColAccessible:a===0,getCellContent:Ee,minColumnWidth:Tt,maxColumnWidth:vo,searchInputRef:I,showSearch:nl,onSearchClose:rl,highlightRegions:hl,getCellsForSelection:me,getGroupDetails:en,headerHeight:jo,isFocused:Al,groupHeaderHeight:Jo?Dn:0,freezeTrailingRows:Ke+(oe&&(V==null?void 0:V.sticky)===!0?1:0),hasAppendRow:oe,onColumnResize:Lt,onColumnResizeEnd:cl,onColumnResizeStart:sl,onCellFocused:$l,onColumnMoved:xl,onDragStart:Ml,onHeaderMenuClick:wl,onHeaderIndicatorClick:pl,onItemHovered:sn,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:Cl,onKeyDown:Qt,onKeyUp:ht,onMouseDown:gl,onMouseUp:vl,onDragOverCell:Sr,onDrop:zr,onSearchResultsChanged:Ll,onVisibleRegionChanged:bl,clientSize:Zo,rowHeight:rt,searchResults:ft,searchValue:Oo,onSearchValueChange:no,rows:we,scrollRef:j,selection:g,translateX:pt.tx,translateY:pt.ty,verticalBorder:Dl,gridRef:fe,getCellRenderer:Me,resizeIndicator:Yr}),Il,w!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(bc,{...w,validateCell:il,bloom:je,id:zl,getCellRenderer:Me,className:(ce==null?void 0:ce.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Mr,imageEditorOverride:z,portalElementRef:qr,onFinishEditing:Sl,markdownDivCreateNode:U,isOutsideClick:Xr,customEventTarget:ce==null?void 0:ce.eventTarget}))))},Rc=l.forwardRef(Mc),kc=(t,o)=>{const i=l.useMemo(()=>({...Bi,...t.headerIcons}),[t.headerIcons]),d=l.useMemo(()=>t.renderers??di,[t.renderers]),w=l.useMemo(()=>t.imageWindowLoader??new fi,[t.imageWindowLoader]);return l.createElement(Rc,{...t,renderers:d,headerIcons:i,ref:o,imageWindowLoader:w})},Fc=l.forwardRef(kc);export{Zi as C,Fc as D,at as k,Cc as u};
