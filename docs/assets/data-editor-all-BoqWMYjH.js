const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-BX12Laym.js","./iframe-u-uZSGaK.js","./index-DAIvD5fl.js","./marked.esm-DMz2Pe0E.js","./throttle-BIWfclFY.js","./flatten-CPDsTVcy.js","./number-overlay-editor-BBwg_rcV.js","./react-number-format.es-D7_H5l20.js"])))=>i.map(i=>d[i]);
var Ks=Object.defineProperty;var Us=(e,t,n)=>t in e?Ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var We=(e,t,n)=>Us(e,typeof t!="symbol"?t+"":t,n);import{r as a,R as Ct,_ as Hl}from"./iframe-u-uZSGaK.js";import{h as Vs,g as Tl,j as qs,k as js,v as Zs,l as Js,m as en,r as go,t as Qs}from"./throttle-BIWfclFY.js";import{u as ea,f as ol}from"./flatten-CPDsTVcy.js";import{s as on,a as ta}from"./marked.esm-DMz2Pe0E.js";function Al(e="This should not happen"){throw new Error(e)}function tn(e,t="Assertion failed"){if(!e)return Al(t)}function sr(e,t){return Al(t??"Hell froze over")}function na(e,t){try{return e()}catch{return t}}const rl=Object.prototype.hasOwnProperty;function Po(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Po(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(rl.call(e,n)&&++o&&!rl.call(t,n)||!(n in t)||!Po(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Kr=null,Fi=void 0;var ne;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(ne||(ne={}));var il;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(il||(il={}));var Ur;(function(e){e.Triangle="triangle",e.Dots="dots"})(Ur||(Ur={}));function Wr(e){return"width"in e&&typeof e.width=="number"}async function ll(e){return typeof e=="object"?e:await e()}function Ao(e){return!(e.kind===ne.Loading||e.kind===ne.Bubble||e.kind===ne.RowID||e.kind===ne.Protected||e.kind===ne.Drilldown)}function Su(e){return!(e.kind===ne.Loading||e.kind===ne.Bubble||e.kind===ne.RowID||e.kind===ne.Protected||e.kind===ne.Drilldown||e.kind===ne.Boolean||e.kind===ne.Image||e.kind===ne.Custom)}function zo(e){return e.kind===mn.Marker||e.kind===mn.NewRow}function or(e){if(!Ao(e)||e.kind===ne.Image)return!1;switch(e.kind){case ne.Text:case ne.Number:case ne.Markdown:case ne.Uri:case ne.Custom:case ne.Boolean:return e.readonly!==!0;default:sr(e,"A cell was passed with an invalid kind")}}function oa(e){return Vs(e,"editor")}function Hi(e){return!(e.readonly??!1)}var mn;(function(e){e.NewRow="new-row",e.Marker="marker"})(mn||(mn={}));function ra(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let sl;const Ln=class Ln{constructor(t){We(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Ln(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ra([...this.items,n]);return new Ln(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,s]of n.entries()){const[l,c]=s;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Ln(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};We(Ln,"empty",()=>sl??(sl=new Ln([]))),We(Ln,"fromSingleSelection",t=>Ln.empty().add(t));let st=Ln;const ia=on("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Lt(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const s=n,l=c=>{var f;(f=i.current)==null||f.call(s,c)};return s.addEventListener(e,l,{passive:o,capture:r}),()=>{s.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function jn(e,t){return e===void 0?void 0:t}const la=Math.PI;function al(e){return e*la/180}const zl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Ll=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Pl=(e,t,n)=>Math.min(e,t-n*2),Bl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ti=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},sa=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function aa(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const s=a.useRef(Tl(l=>{i.current&&r(l)},n));return a.useLayoutEffect(()=>{i.current&&s.current(()=>e())},t),o}const ca="֑-߿יִ-﷽ﹰ-ﻼ",da="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ua=new RegExp("^[^"+da+"]*["+ca+"]");function Ai(e){return ua.test(e)?"rtl":"not-rtl"}let $r;function Mi(){if(typeof document>"u")return 0;if($r!==void 0)return $r;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),$r=n-o,$r}const ho=Symbol();function fa(e){const t=a.useRef([ho,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(l=>{const c=t.current[0];c!==ho&&(l=typeof l=="function"?l(c):l,l===c)||(c!==ho&&r({}),o(f=>typeof l=="function"?l(c===ho?f:c):l),t.current[0]=ho)},[]),s=a.useCallback(()=>{t.current[0]=ho,r({})},[]);return[t.current[0]===ho?n:t.current[0],i,s]}function Wl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ha(e){const t=a.useRef(e);return Po(e,t.current)||(t.current=e),t.current}const ga=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const s=i.length>1;return a.createElement(ia,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(qs.Carousel,{showArrows:s,showThumbs:!1,swipeable:s,emulateTouch:s,infiniteLoop:s},i.map(l=>{const c=(r==null?void 0:r(l))??a.createElement("img",{draggable:!1,src:l});return a.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(Ti,null)))},ma=on("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class wa extends Ct.PureComponent{constructor(){super(...arguments);We(this,"targetElement",null);We(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,s=ta(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(s);if(c===void 0){const u=document.createElement("template");u.innerHTML=s,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Ct.createElement(ma,{ref:this.containerRefHook})}}const ba=on("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ya=on("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),pa=on("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let cl=0;const Zr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:s,...l}=e,{onChange:c,className:f}=l,u=a.useRef(null),h=n??"";tn(c!==void 0,"GrowingEntry must be a controlled input area");const[w]=a.useState(()=>"input-box-"+(cl=(cl+1)%1e7));a.useEffect(()=>{const m=u.current;if(m===null||m.disabled)return;const b=h.toString().length;m.focus(),m.setSelectionRange(r?0:b,b)},[]),a.useLayoutEffect(()=>{var m;if(s!==void 0){const b=typeof s=="number"?[s,null]:s;(m=u.current)==null||m.setSelectionRange(b[0],b[1])}},[s]);const g=a.useCallback(m=>{m.key==="Enter"&&m.shiftKey&&i===!0||o==null||o(m)},[i,o]);return a.createElement(pa,{className:"gdg-growing-entry"},a.createElement(ya,{className:f},h+`
`),a.createElement(ba,{...l,className:(f??"")+" gdg-input",id:w,ref:u,onKeyDown:g,value:h,placeholder:t,dir:"auto"}))},bi={};let Vn=null;function va(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Bo(e){const t=e.toLowerCase().trim();if(bi[t]!==void 0)return bi[t];Vn=Vn||va(),Vn.style.color="#000",Vn.style.color=t;const n=getComputedStyle(Vn).color;Vn.style.color="#fff",Vn.style.color=t;const o=getComputedStyle(Vn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),bi[t]=r,r}function wo(e,t){const[n,o,r]=Bo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const dl=new Map;function yi(e,t){const n=`${e}-${t}`,o=dl.get(n);if(o!==void 0)return o;const r=nn(e,t);return dl.set(n,r),r}function nn(e,t){if(t===void 0)return e;const[n,o,r,i]=Bo(e);if(i===1)return e;const[s,l,c,f]=Bo(t),u=i+f*(1-i),h=(i*n+f*s*(1-i))/u,w=(i*o+f*l*(1-i))/u,g=(i*r+f*c*(1-i))/u;return`rgba(${h}, ${w}, ${g}, ${u})`}function Mu(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...Bo(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...Bo(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,s=1-n,l=o[3]*s+r[3]*i,c=Math.floor((o[0]*s+r[0]*i)/l),f=Math.floor((o[1]*s+r[1]*i)/l),u=Math.floor((o[2]*s+r[2]*i)/l);return`rgba(${c}, ${f}, ${u}, ${l})`}function Ru(e){if(e==="transparent")return 0;function t(i){const s=i/255;return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}const[n,o,r]=Bo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ca(e,t){const n=typeof t=="number"?t:t[0],o=typeof t=="number"?0:t[1];return Ct.useMemo(()=>e.map((r,i)=>({group:r.group,grow:r.grow,hasMenu:r.hasMenu,icon:r.icon,id:r.id,menuIcon:r.menuIcon,overlayIcon:r.overlayIcon,sourceIndex:i,sticky:i<n||i>=e.length-o,stickyPosition:i<n?"left":i>=e.length-o?"right":void 0,indicatorIcon:r.indicatorIcon,style:r.style,themeOverride:r.themeOverride,title:r.title,trailingRowOptions:r.trailingRowOptions,width:r.width,growOffset:r.growOffset,rowMarker:r.rowMarker,rowMarkerChecked:r.rowMarkerChecked,headerRowMarkerTheme:r.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:r.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:r.headerRowMarkerDisabled})),[e,n,o])}function xa(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(rr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Wo(e,t){return(e??"")===(t??"")}function ka(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function $l(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function rr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Ol(e){return[e.x+e.width-1,e.y+e.height-1]}function ul(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,s=n.y+n.height-1,[l,c]=e;if(c<i||c>s)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Sa(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&ul(e,t,i)&&r++;for(const s of n.current.rangeStack)ul(e,t,s)&&r++;return r}function Nl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,s)=>({...i,sticky:e[s].sticky})),n=o}return n}function $o(e,t){let n=0,o=0;const r=Nl(e,t);for(let i=0;i<r.length;i++){const s=r[i];if(s.sticky)s.stickyPosition==="left"&&(n+=s.width);else break}for(let i=r.length-1;i>=0;i--){const s=r[i];if(s.sticky)s.stickyPosition==="right"&&(o+=s.width);else break}return[n,o]}function bo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Gr(e,t,n,o,r,i){const s=Nl(e,r),l=typeof o=="number"?o:o[0],c=typeof o=="number"?0:o[1],f=[];for(let g=0;g<l;g++)f.push(s[g]);if(f.length>0)for(const g of f)n-=g.width;const u=[];for(let g=s.length-c;g<s.length;g++)u.push(s[g]);if(u.length>0)for(const g of u)n-=g.width;let h=t,w=i??0;for(;w<=n&&h<s.length;)w+=s[h].width,h++;for(let g=t;g<h;g++){const m=s[g];m.sticky||f.push(m)}return f.push(...u),f}function Ma(e,t,n,o,r){const i=typeof n=="number"?0:n[1];let s=o;for(let c=0;c<i;c++){const f=t.length-1-c,u=t[f];if(s-=u.width,e>=s)return u.sourceIndex}let l=0;for(let c=0;c<t.length-i;c++){const f=t[c],u=f.sticky?l:l+(r??0);if(e<=u+f.width)return f.sourceIndex;l+=f.width}return-1}function Ra(e,t,n,o,r,i,s,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let h=t;for(let m=0;m<f;m++){const b=i-1-m,v=typeof s=="number"?s:s(b);if(h-=v,e>=h)return b}const w=i-f,g=e-(c??0);if(typeof s=="number"){const m=Math.floor((g-u)/s)+l;return m>=w?void 0:m}else{let m=u;for(let b=l;b<w;b++){const v=s(b);if(g<=m+v)return b;m+=v}return}}let _r=0,ir={};const Ea=typeof window>"u";async function Ia(){var e;Ea||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,_r=0,ir={},Zs())}Ia();function Xl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Oo(e,t,n,o="middle"){const r=Xl(e,t,o,n);let i=ir[r];return i===void 0&&(i=t.measureText(e),ir[r]=i,_r++),_r>1e4&&(ir={},_r=0),i}function Yl(e,t){const n=Xl(e,void 0,"middle",t);return ir[n]}function Jn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Da(e,t)}function fl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const hl=[];function Da(e,t){for(const i of hl)if(i.key===t)return i.val;const n=fl(e,"alphabetic"),r=-(fl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return hl.push({key:t,val:r}),r}function Fa(e,t,n,o,r,i){const{ctx:s,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const h=1-f/u;s.globalAlpha=h,s.fillStyle=c.bgSearchResult,s.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),s.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function cr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},s=n??r.textDark;return s!==i.fillStyle&&(o.fillStyle=s,i.fillStyle=s),i}function Eu(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,Dn({ctx:r,rect:o,theme:i},t,n)}function Gl(e,t,n,o,r,i,s,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+s):c==="center"?e.fillText(t,n+r/2,o+i/2+s):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+s)}function _l(e,t){const n=Oo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ha(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ta(e,t,n,o,r,i,s,l,c,f){const u=l.baseFontFull,h=js(e,t,u,r-l.cellHorizontalPadding*2,f??!1),w=_l(e,u),g=l.lineHeight*w,m=w+g*(h.length-1),b=m+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const v=o+i/2-m/2;let C=Math.max(o+l.cellVerticalPadding,v);for(const x of h)if(Gl(e,x,n,C,r,w,s,l,c),C+=g,C>o+i)break;b&&e.restore()}function Dn(e,t,n,o,r){const{ctx:i,rect:s,theme:l}=e,{x:c,y:f,width:u,height:h}=s;o=o??!1,o||(t=Ha(t,u));const w=Jn(i,l),g=Ai(t)==="rtl";if(n===void 0&&g&&(n="right"),g&&(i.direction="rtl"),t.length>0){let m=!1;n==="right"?(i.textAlign="right",m=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,m=!0),o?Ta(i,t,c,f,u,h,w,l,n,r):Gl(i,t,c,f,u,h,w,l,n),m&&(i.textAlign="start"),g&&(i.direction="inherit")}}function Fn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Aa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function za(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,h=Math.sqrt(f*f+u*u),w=f/h,g=u/h;return{x:f,y:c.y-l.y,len:h,nx:w,ny:g,ang:Math.atan2(g,w)}};let r;const i=t.length;let s=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,s),h=o(c,f),w=u.nx*h.ny-u.ny*h.nx,g=u.nx*h.nx-u.ny*-h.ny;let m=Math.asin(w<-1?-1:w>1?1:w),b=1,v=!1;g<0?m<0?m=Math.PI+m:(m=Math.PI-m,b=-1,v=!0):m>0&&(b=-1,v=!0),r=c.radius!==void 0?c.radius:n;const C=m/2;let x=Math.abs(Math.cos(C)*r/Math.sin(C)),H;x>Math.min(u.len/2,h.len/2)?(x=Math.min(u.len/2,h.len/2),H=Math.abs(x*Math.sin(C)/Math.cos(C))):H=r;let D=c.x+h.nx*x,X=c.y+h.ny*x;D+=-h.ny*H*b,X+=h.nx*H*b,e.arc(D,X,H,u.ang+Math.PI/2*b,h.ang-Math.PI/2*b,v),s=c,c=f}e.closePath()}function Ri(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m){const b={x:0,y:i+f,width:0,height:0},v=typeof h=="number"?h:h[0],C=typeof h=="number"?0:h[1],x=g[e];if(e>=g.length||t>=u||t<-2||e<0)return b;const H=i-r;if(e>=v&&e<g.length-C){const D=s>e?-1:1,[X]=$o(g);b.x+=X+c;for(let A=s;A!==e;A+=D)b.x+=g[D===1?A:A-1].width*D}else if(x.stickyPosition==="left")for(let D=0;D<e;D++)b.x+=g[D].width;else if(x.stickyPosition==="right"){b.x=n;for(let D=e;D<g.length;D++)b.x-=g[D].width}if(b.width=g[e].width+1,t===-1)b.y=r,b.height=H;else if(t===-2){b.y=0,b.height=r;let D=e;const X=g[e].group,A=g[e].sticky;for(;D>0&&Wo(g[D-1].group,X)&&g[D-1].sticky===A;){const Y=g[D-1];b.x-=Y.width,b.width+=Y.width,D--}let F=e;for(;F+1<g.length&&Wo(g[F+1].group,X)&&g[F+1].sticky===A;){const Y=g[F+1];b.width+=Y.width,F++}if(!A){const[Y]=$o(g),z=b.x-Y;z<0&&(b.x-=z,b.width+=z),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-w){let D=u-t;for(b.y=o;D>0;){const X=t+D-1;b.height=typeof m=="number"?m:m(X),b.y-=b.height,D--}b.height+=1}else{const D=l>t?-1:1;if(typeof m=="number"){const X=t-l;b.y+=X*m}else for(let X=l;X!==t;X+=D)b.y+=m(X)*D;b.height=(typeof m=="number"?m:m(t))+1}return b}const zi=1<<21;function kn(e,t){return(t+2)*zi+e}function Kl(e){return e%zi}function Li(e){return Math.floor(e/zi)-2}function Pi(e){const t=Kl(e),n=Li(e);return[t,n]}class Ul{constructor(){We(this,"visibleWindow",{x:0,y:0,width:0,height:0});We(this,"columnsLength",0);We(this,"freezeCols",0);We(this,"freezeRows",[]);We(this,"isInWindow",t=>{const n=typeof this.freezeCols=="number"?this.freezeCols:this.freezeCols[0],o=typeof this.freezeCols=="number"?0:this.freezeCols[1],r=Kl(t),i=Li(t),s=this.visibleWindow,l=r>=s.x&&r<=s.x+s.width||r<n||r>this.columnsLength-o-1,c=i>=s.y&&i<=s.y+s.height||this.freezeRows.includes(i);return l&&c})}setWindow(t,n,o,r){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&this.columnsLength===r&&Po(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.columnsLength=r,this.clearOutOfWindow())}}class La extends Ul{constructor(){super(...arguments);We(this,"cache",new Map);We(this,"setValue",(n,o)=>{this.cache.set(kn(n[0],n[1]),o)});We(this,"getValue",n=>this.cache.get(kn(n[0],n[1])));We(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class lr{constructor(t=[]){We(this,"cells");this.cells=new Set(t.map(n=>kn(n[0],n[1])))}add(t){this.cells.add(kn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(kn(t[0],t[1]))}remove(t){this.cells.delete(kn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Li(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(kn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Pi(t)}}function Pa(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Vl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function ql(){return Vl}const jl=Ct.createContext(Vl);function Iu(){return Ct.useContext(jl)}function Pn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=nn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ei=150;function Ba(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ei}function Zl(e,t,n,o,r,i,s,l,c){let f=0;const u=r===void 0?[]:r.map(g=>{const m=Ba(e,g[o],t,c);return f=Math.max(f,m),m});if(u.length>5&&l){f=0;let g=0;for(const b of u)g+=b;const m=g/u.length;for(let b=0;b<u.length;b++)u[b]>=m*2?u[b]=0:f=Math.max(f,u[b])}const h=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=h;const w=Math.max(Math.ceil(i),Math.min(Math.floor(s),Math.ceil(f)));return{...n,width:w}}function Wa(e,t,n,o,r,i,s,l,c){const f=a.useRef(t),u=a.useRef(n),h=a.useRef(s);f.current=t,u.current=n,h.current=s;const[w,g]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const x=document.createElement("canvas");return x.style.display="none",x.style.opacity="0",x.style.position="fixed",[x,x.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const m=a.useRef({}),b=a.useRef(),[v,C]=a.useState();return a.useLayoutEffect(()=>{const x=u.current;if(x===void 0||e.every(Wr))return;let H=Math.max(1,10-Math.floor(e.length/1e4)),D=0;H<f.current&&H>1&&(H--,D=1);const X={x:0,y:0,width:e.length,height:Math.min(f.current,H)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const Y=x(X,c.signal),z=D>0?x(A,c.signal):void 0;let N;typeof Y=="object"?N=Y:N=await ll(Y),z!==void 0&&(typeof z=="object"?N=[...N,...z]:N=[...N,...await ll(z)]),b.current=e,C(N)})()},[c.signal,e]),a.useMemo(()=>{let H=e.every(Wr)?e:g===null?e.map(F=>Wr(F)?F:{...F,width:Ei}):(g.font=h.current.baseFontFull,e.map((F,Y)=>{if(Wr(F))return F;if(m.current[F.id]!==void 0)return{...F,width:m.current[F.id]};if(v===void 0||b.current!==e||F.id===void 0)return{...F,width:Ei};const z=Zl(g,s,F,Y,v,r,i,!0,l);return m.current[F.id]=z.width,z})),D=0,X=0;const A=[];for(const[F,Y]of H.entries())D+=Y.width,Y.grow!==void 0&&Y.grow>0&&(X+=Y.grow,A.push(F));if(D<o&&A.length>0){const F=[...H],Y=o-D;let z=Y;for(let N=0;N<A.length;N++){const _=A[N],L=(H[_].grow??0)/X,P=N===A.length-1?z:Math.min(z,Math.floor(Y*L));F[_]={...H[_],growOffset:P,width:H[_].width+P},z-=P}H=F}return{sizedColumns:H,nonGrowWidth:D}},[o,e,g,v,s,r,i,l])}const wt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Jl=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Ga=e=>{const t=e.bgColor;return`${wt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},_a=Jl,Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${wt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${wt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},uc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},fc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},hc={headerRowID:$a,headerNumber:Na,headerCode:Oa,headerString:Xa,headerBoolean:Ya,headerAudioUri:_a,headerVideoUri:Ka,headerEmoji:Ua,headerImage:Va,headerUri:Jl,headerPhone:qa,headerMarkdown:ja,headerDate:Za,headerTime:Ja,headerEmail:Qa,headerReference:ec,headerIfThenElse:tc,headerSingleValue:nc,headerLookup:oc,headerTextTemplate:rc,headerMath:ic,headerRollup:lc,headerJoinStrings:sc,headerSplitString:ac,headerGeoDistance:cc,headerArray:dc,rowOwnerOverlay:uc,protectedColumnOverlay:fc,renameIcon:Ga};function gc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class mc{constructor(t,n){We(this,"onSettled");We(this,"spriteMap",new Map);We(this,"headerIcons");We(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,s,l,c=1){const[f,u]=gc(n,l),h=s*Math.ceil(window.devicePixelRatio),w=`${f}_${u}_${h}_${t}`;let g=this.spriteMap.get(w);if(g===void 0){const m=this.headerIcons[t];if(m===void 0)return;g=document.createElement("canvas");const b=g.getContext("2d");if(b===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(m({fgColor:u,bgColor:f}))}`,this.spriteMap.set(w,g);const C=v.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{b.drawImage(v,0,0,h,h)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(g,0,0,h,h,r,i,s,s),c<1&&(o.globalAlpha=1)}}function Ql(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Jr(e,t,n,o,r,i,s,l,c){l=l??t;let f=t,u=e;const h=o-i;let w=!1;for(;f<n&&u<h;){const g=r(u);if(f+g>l&&c(f,u,g,!1,s&&u===o-1)===!0){w=!0;break}f+=g,u++}if(!w){f=n;for(let g=0;g<i;g++){u=o-1-g;const m=r(u);f-=m,c(f,u,m,!0,s&&u===o-1)}}}function Qn(e,t,n,o,r,i,s,l){let c=0,f=0;const u=i+r,h=s===0?0:e.slice(-s).reduce((w,g)=>w+g.width,0);for(let w=0;w<e.length-s;w++){const g=e[w],m=g.sticky?f:c+o;if(l(g,m,u,g.sticky?0:f,h,n)===!0)break;c+=g.width,f+=g.sticky?g.width:0}c=t;for(let w=0;w<s;w++){const g=e[e.length-1-w],m=c-g.width;c-=g.width,l(g,m,u,f,h,n)}}function es(e,t,n,o,r,i){let s=0,l=0;const c=r===0?[]:e.slice(-r),f=c.reduce((u,h)=>u+h.width,0);t-=f;for(let u=0;u<e.length-r;u++){const h=e[u];let w=u+1,g=h.width;for(h.sticky&&(l+=g);w<e.length&&Wo(e[w].group,h.group)&&e[w].sticky===e[u].sticky;){const x=e[w];g+=x.width,w++,u++,x.sticky&&(l+=x.width)}const m=h.sticky?0:n,b=s+m,v=h.sticky?0:Math.max(0,l-b),C=Math.min(g-v,t-(b+v));i([h.sourceIndex,e[w-1].sourceIndex],h.group??"",b+v,0,C,o),s+=g}for(let u=0;u<c.length;u++){const h=c[u];let w=u+1,g=h.width;for(;w<c.length&&Wo(c[w].group,h.group)&&c[w].sticky===c[u].sticky;){const x=c[w];g+=x.width,w++,u++,x.sticky&&(l+=x.width)}const b=t+g-g,v=0,C=g-v;i([h.sourceIndex,c[w-1].sourceIndex],h.group??"",b+v,0,C,o),t+=C}}function ts(e,t,n,o,r,i,s){var w;const[l,c]=e;let f,u;const h=((w=s.find(g=>!g.sticky))==null?void 0:w.sourceIndex)??0;if(c>h){const g=Math.max(l,h);let m=t,b=o;for(let v=i.sourceIndex-1;v>=g;v--)m-=s[v].width,b+=s[v].width;for(let v=i.sourceIndex+1;v<=c;v++)b+=s[v].width;u={x:m,y:n,width:b,height:r}}if(h>l){const g=Math.min(c,h-1);let m=t,b=o;for(let v=i.sourceIndex-1;v>=l;v--)m-=s[v].width,b+=s[v].width;for(let v=i.sourceIndex+1;v<=g;v++)b+=s[v].width;f={x:m,y:n,width:b,height:r}}return[f,u]}function wc(e,t,n,o){if(o==="any")return ns(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),$l([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,s=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:s,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===s?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function ar(e,t,n,o,r,i,s,l){return e<=r+s&&r<=e+n&&t<=i+l&&i<=t+o}function mo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function ns(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function bc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function yc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,s=t+4,l=n+4,c=r-e.x,f=e.x+e.width-s,u=i-e.y,h=e.y+e.height-l,w=c>0?e.x+Math.floor(c/o)*o:e.x,g=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,m=u>0?e.y+Math.floor(u/o)*o:e.y,b=h>0?e.y+e.height-Math.floor(h/o)*o:e.y+e.height;return{x:w,y:m,width:g-w,height:b-m}}function pc(e,t,n,o,r){const[i,s,l,c]=t,[f,u,h,w]=r,{x:g,y:m,width:b,height:v}=e,C=[];if(b<=0||v<=0)return C;const x=g+b,H=m+v,D=g<i,X=m<s,A=g+b>l,F=m+v>c,Y=g>=i&&g<l||x>i&&x<=l||g<i&&x>l,z=m>=s&&m<c||H>s&&H<=c||m<s&&H>c;if(Y&&z){const _=Math.max(g,i),L=Math.max(m,s),P=Math.min(x,l),S=Math.min(H,c);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:f,y:u,width:h-f+1,height:w-u+1}})}if(D&&X){const _=g,L=m,P=Math.min(x,i),S=Math.min(H,s);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:0,y:0,width:f+1,height:u+1}})}if(X&&Y){const _=Math.max(g,i),L=m,P=Math.min(x,l),S=Math.min(H,s);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:f,y:0,width:h-f+1,height:u+1}})}if(X&&A){const _=Math.max(g,l),L=m,P=x,S=Math.min(H,s);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:h,y:0,width:n-h+1,height:u+1}})}if(D&&z){const _=g,L=Math.max(m,s),P=Math.min(x,i),S=Math.min(H,c);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:0,y:u,width:f+1,height:w-u+1}})}if(A&&z){const _=Math.max(g,l),L=Math.max(m,s),P=x,S=Math.min(H,c);C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:h,y:u,width:n-h+1,height:w-u+1}})}if(D&&F){const _=g,L=Math.max(m,c),P=Math.min(x,i),S=H;C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:0,y:w,width:f+1,height:o-w+1}})}if(F&&Y){const _=Math.max(g,i),L=Math.max(m,c),P=Math.min(x,l),S=H;C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:f,y:w,width:h-f+1,height:o-w+1}})}if(A&&F){const _=Math.max(g,l),L=Math.max(m,c),P=x,S=H;C.push({rect:{x:_,y:L,width:P-_,height:S-L},clip:{x:h,y:w,width:n-h+1,height:o-w+1}})}return C}const vc={kind:ne.Loading,allowOverlay:!1};function gl(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C,x,H,D,X,A,F,Y,z,N,_,L,P,S,R,j,ee,we,ke,Te){let $=(X==null?void 0:X.size)??Number.MAX_SAFE_INTEGER;const ae=performance.now();let ie=R.baseFontFull;e.font=ie;const Re={ctx:e},fe=[0,0],U=C>0?bo(f,C,u):0;let xe,et;const ot=Ql(D);return Qn(t,r,c,s,l,i,x,(le,Ge,tt,at,ze,Ee)=>{const dt=Math.max(0,at-Ge),ut=Ge+dt,je=i+1,Z=le.stickyPosition==="right"?le.width-dt:Math.min(le.width-dt,r-Ge-ze),_e=o-i-1;if(D.length>0){let nt=!1;for(let se=0;se<D.length;se++){const J=D[se];if(ar(ut,je,Z,_e,J.x,J.y,J.width,J.height)){nt=!0;break}}if(!nt)return}const Ce=()=>{e.save(),e.beginPath(),e.rect(ut,je,Z,_e),e.clip()},Ae=A.columns.hasIndex(le.sourceIndex),Oe=w(le.group??"").overrideTheme,rt=le.themeOverride===void 0&&Oe===void 0?R:Pn(R,Oe,le.themeOverride),Ue=rt.baseFontFull;Ue!==ie&&(ie=Ue,e.font=Ue),Ce();let Ke;return Jr(Ee,tt,o,f,u,C,H,ot,(nt,se,J,Mt,Ne)=>{var zt,ln,Bn;if(se<0||(fe[0]=le.sourceIndex,fe[1]=se,X!==void 0&&!X.has(fe)))return;if(D.length>0){let Le=!1;for(let gt=0;gt<D.length;gt++){const it=D[gt];if(ar(Ge,nt,le.width,J,it.x,it.y,it.width,it.height)){Le=!0;break}}if(!Le)return}const He=A.rows.hasIndex(se),Pt=m.hasIndex(se),Ze=se<f?h(fe):vc;let Ve=Ge,Fe=le.width,ht=!1,Nt=!1;if(Ze.span!==void 0){const[Le,gt]=Ze.span,it=`${se},${Le},${gt},${le.sticky}`;if(et===void 0&&(et=new Set),et.has(it)){$--;return}else{const Zt=ts(Ze.span,Ge,nt,le.width,J,le,n),Ut=le.sticky?Zt[0]:Zt[1];if(!le.sticky&&Zt[0]!==void 0&&(Nt=!0),Ut!==void 0){Ve=Ut.x,Fe=Ut.width,et.add(it),e.restore(),Ke=void 0,e.save(),e.beginPath();const ft=Math.max(0,at-Ut.x);e.rect(Ut.x+ft,nt,Ut.width-ft,J),xe===void 0&&(xe=[]),xe.push({x:Ut.x+ft,y:nt,width:Ut.width-ft,height:J}),e.clip(),ht=!0}}}const Tt=g==null?void 0:g(se),Ft=Ne&&((zt=le.trailingRowOptions)==null?void 0:zt.themeOverride)!==void 0?(ln=le.trailingRowOptions)==null?void 0:ln.themeOverride:void 0,xt=Ze.themeOverride===void 0&&Tt===void 0&&Ft===void 0?rt:Pn(rt,Tt,Ft,Ze.themeOverride);e.beginPath();const rn=ka(fe,Ze,A);let Bt=Sa(fe,Ze,A,v);const eo=Ze.span!==void 0&&A.columns.some(Le=>Ze.span!==void 0&&Le>=Ze.span[0]&&Le<=Ze.span[1]);rn&&!b&&v?Bt=0:rn&&v&&(Bt=Math.max(Bt,1)),eo&&Bt++,rn||(He&&Bt++,Ae&&!Ne&&Bt++);const wn=Ze.kind===ne.Protected?xt.bgCellMedium:xt.bgCell;let Se;if((Mt||wn!==R.bgCell||le.sticky)&&(Se=nn(wn,Se)),Bt>0||Pt){Pt&&(Se=nn(xt.bgHeader,Se));for(let Le=0;Le<Bt;Le++)Se=nn(xt.accentLight,Se)}else if(F!==void 0){for(const Le of F)if(Le[0]===le.sourceIndex&&Le[1]===se){Se=nn(xt.bgSearchResult,Se);break}}if(Y!==void 0)for(let Le=0;Le<Y.length;Le++){const gt=Y[Le],it=gt.range;gt.style!=="solid-outline"&&it.x<=le.sourceIndex&&le.sourceIndex<it.x+it.width&&it.y<=se&&se<it.y+it.height&&(Se=nn(gt.color,Se))}let Rt=!1;if(X!==void 0){const Le=nt+1,it=(Mt?Le+J-1:Math.min(Le+J-1,o-U))-Le;(it!==J-1||Ve+1<=at)&&(Rt=!0,e.save(),e.beginPath(),e.rect(Ve+1,Le,Fe-1,it),e.clip()),Se=Se===void 0?xt.bgCell:nn(Se,xt.bgCell)}const ct=le.sourceIndex===n.length-1,Kt=se===f-1;Se!==void 0&&(e.fillStyle=Se,Ke!==void 0&&(Ke.fillStyle=Se),X!==void 0?e.fillRect(Ve+1,nt+1,Fe-(ct?2:1),J-(Kt?2:1)):e.fillRect(Ve,nt,Fe,J)),Ze.style==="faded"&&(e.globalAlpha=.6);let bn;for(let Le=0;Le<_.length;Le++){const gt=_[Le];if(gt.item[0]===le.sourceIndex&&gt.item[1]===se){bn=gt;break}}if(Fe>Te&&!Nt){const Le=xt.baseFontFull;Le!==ie&&(e.font=Le,ie=Le),Ke=os(e,Ze,le.sourceIndex,se,ct,Kt,Ve,nt,Fe,J,Bt>0,xt,Se??xt.bgCell,z,N,(bn==null?void 0:bn.hoverAmount)??0,L,S,ae,P,Ke,j,ee,we,ke)}return Rt&&e.restore(),Ze.style==="faded"&&(e.globalAlpha=1),$--,ht&&(e.restore(),(Bn=Ke==null?void 0:Ke.deprep)==null||Bn.call(Ke,Re),Ke=void 0,Ce(),ie=Ue,e.font=Ue),$<=0}),e.restore(),$<=0}),xe}const Qo=[0,0],er={x:0,y:0,width:0,height:0},pi=[void 0,()=>{}];let Ii=!1;function Cc(){Ii=!0}function os(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C,x,H,D,X,A,F,Y){var R,j;let z,N;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(z=v[1][0],N=v[1][1]);let _;Qo[0]=n,Qo[1]=o,er.x=s,er.y=l,er.width=c,er.height=f,pi[0]=A.getValue(Qo),pi[1]=ee=>A.setValue(Qo,ee),Ii=!1;const L={ctx:e,theme:h,col:n,row:o,cell:t,rect:er,highlighted:u,cellFillColor:w,hoverAmount:b,frameTime:x,hoverX:z,drawState:pi,hoverY:N,imageLoader:g,spriteManager:m,hyperWrapping:C,overrideCursor:z!==void 0?Y:void 0,requestAnimationFrame:Cc},P=Fa(L,t.lastUpdated,x,D,r,i),S=F(t);if(S!==void 0){(D==null?void 0:D.renderer)!==S&&((R=D==null?void 0:D.deprep)==null||R.call(D,L),D=void 0);const ee=(j=S.drawPrep)==null?void 0:j.call(S,L,D);H!==void 0&&!zo(L.cell)?H(L,()=>S.draw(L,t)):S.draw(L,t),_=ee===void 0?void 0:{deprep:ee==null?void 0:ee.deprep,fillStyle:ee==null?void 0:ee.fillStyle,font:ee==null?void 0:ee.font,renderer:S}}return(P||Ii)&&(X==null||X(Qo)),_}function Bi(e,t,n,o,r,i,s,l,c=-20,f=-20,u=32,h="center",w="square"){const g=Math.floor(r+s/2),m=w==="circle"?1e4:t.roundingRadius??4;let b=Pl(u,s,t.cellVerticalPadding),v=b/2;const C=Ll(h,o,i,t.cellHorizontalPadding,b),x=zl(C,g,b),H=Bl(o+c,r+f,x);switch(n){case!0:{e.beginPath(),Fn(e,C-b/2,g-b/2,b,b,m),w==="circle"&&(v*=.8,b*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-v+b/4.23,g-v+b/1.97),e.lineTo(C-v+b/2.42,g-v+b/1.44),e.lineTo(C-v+b/1.29,g-v+b/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Kr:case!1:{e.beginPath(),Fn(e,C-b/2+.5,g-b/2+.5,b-1,b-1,m),e.lineWidth=1,e.strokeStyle=H?t.textDark:t.textMedium,e.stroke();break}case Fi:{e.beginPath(),Fn(e,C-b/2,g-b/2,b,b,m),e.fillStyle=H?t.textMedium:t.textLight,e.fill(),w==="circle"&&(v*=.8,b*=.8),e.beginPath(),e.moveTo(C-b/3,g),e.lineTo(C+b/3,g),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:sr()}}function xc(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C,x,H){var N,_,L,P;const D=s+l;if(D<=0)return;e.fillStyle=h.bgHeader,e.fillRect(0,0,r,D);const X=(N=o==null?void 0:o[0])==null?void 0:N[0],A=(_=o==null?void 0:o[0])==null?void 0:_[1],F=(L=o==null?void 0:o[1])==null?void 0:L[0],Y=(P=o==null?void 0:o[1])==null?void 0:P[1],z=h.headerFontFull;e.font=z,Qn(t,r,0,i,0,D,H,(S,R,j,ee,we)=>{var Ge;if(v!==void 0&&!v.has([S.sourceIndex,-1]))return;const ke=Math.max(0,ee-R);let Te=S.stickyPosition==="right"?S.width-ke:Math.min(S.width-ke,r-R-we);e.save(),e.beginPath(),e.rect(R+ke,l,Te,s),e.clip();const $=b(S.group??"").overrideTheme,ae=S.themeOverride===void 0&&$===void 0?h:Pn(h,$,S.themeOverride);S.sticky===!0&&(e.fillStyle=ae.bgHeader,e.fill()),ae.bgHeader!==h.bgHeader&&(e.fillStyle=ae.bgHeader,e.fill()),ae!==h&&(e.font=ae.headerFontFull);const ie=u.columns.hasIndex(S.sourceIndex),Re=c!==void 0||f||S.headerRowMarkerDisabled===!0,fe=!Re&&A===-1&&X===S.sourceIndex,U=Re?0:((Ge=g.find(tt=>tt.item[0]===S.sourceIndex&&tt.item[1]===-1))==null?void 0:Ge.hoverAmount)??0,xe=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===S.sourceIndex,et=ie?ae.accentColor:xe?ae.bgHeaderHasFocus:ae.bgHeader,ot=n?l:0,le=S.sourceIndex===0?0:1;ie?(e.fillStyle=et,e.fillRect(R+le,ot,S.width-le,s)):(xe||U>0)&&(Te=S.stickyPosition==="right"?S.width-le:Math.min(S.width-le,r-R-we),e.beginPath(),e.rect(R+le,ot,Te,s),xe&&(e.fillStyle=ae.bgHeaderHasFocus,e.fill()),U>0&&(e.globalAlpha=U,e.fillStyle=ae.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ls(e,R,ot,S.width,s,S,ie,ae,fe,fe?F:void 0,fe?Y:void 0,xe,U,w,C,x),e.restore()}),n&&kc(e,t,r,i,l,o,h,w,g,m,b,v,H)}function kc(e,t,n,o,r,i,s,l,c,f,u,h,w){const[m,b]=(i==null?void 0:i[0])??[];let v=0;es(t,n,o,r,w,(C,x,H,D,X,A)=>{if(h!==void 0&&!h.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(H,D,X,A),e.clip();const F=u(x),Y=(F==null?void 0:F.overrideTheme)===void 0?s:Pn(s,F.overrideTheme),z=b===-2&&m!==void 0&&m>=C[0]&&m<=C[1],N=z?Y.bgGroupHeaderHovered??Y.bgHeaderHovered:Y.bgGroupHeader??Y.bgHeader;if(N!==s.bgHeader&&(e.fillStyle=N,e.fill()),e.fillStyle=Y.textGroupHeader??Y.textHeader,F!==void 0){let _=H;if(F.icon!==void 0&&(l.drawSprite(F.icon,"normal",e,_+8,(r-20)/2,20,Y),_+=26),e.fillText(F.name,_+8,r/2+Jn(e,s.headerFontFull)),F.actions!==void 0&&z){const L=rs({x:H,y:D,width:X,height:A},F.actions);e.beginPath();const P=L[0].x-10,S=H+X-P;e.rect(P,0,S,r);const R=e.createLinearGradient(P,0,P+S,0),j=wo(N,0);R.addColorStop(0,j),R.addColorStop(10/S,N),R.addColorStop(1,N),e.fillStyle=R,e.fill(),e.globalAlpha=.6;const[ee,we]=(i==null?void 0:i[1])??[-1,-1];for(let ke=0;ke<F.actions.length;ke++){const Te=F.actions[ke],$=L[ke],ae=mo($,ee+H,we);ae&&(e.globalAlpha=1),l.drawSprite(Te.icon,"normal",e,$.x+$.width/2-10,$.y+$.height/2-10,20,Y),ae&&(e.globalAlpha=.6)}e.globalAlpha=1}}H!==0&&f(C[0])&&(e.beginPath(),e.moveTo(H+.5,0),e.lineTo(H+.5,r),e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()),e.restore(),v=H+X}),e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()}const Or=30;function Sc(e,t,n,o,r){return{x:e+n-Or,y:Math.max(t,t+o/2-Or/2),width:Or,height:Math.min(Or,o)}}function rs(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,s=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:s,height:i}),o+=26;return n}function tr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function is(e,t,n,o,r,i,s,l){var C;const c=s.cellHorizontalPadding,f=s.headerIconSize,u=Sc(n,o,r,i);let h=n+c;const w=t.icon===void 0?void 0:{x:h,y:o+(i-f)/2,width:f,height:f},g=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18};w!==void 0&&(h+=Math.ceil(f*1.3));const m={x:h,y:o,width:r-h,height:i};let b;if(t.indicatorIcon!==void 0){const x=e===void 0?((C=Yl(t.title,s.headerFontFull))==null?void 0:C.width)??0:Oo(t.title,e,s.headerFontFull).width;m.width=x,h+=x+c,b={x:h,y:o+(i-f)/2,width:f,height:f}}const v=n+r/2;return{menuBounds:tr(u,v,l),iconBounds:tr(w,v,l),iconOverlayBounds:tr(g,v,l),textBounds:tr(m,v,l),indicatorIconBounds:tr(b,v,l)}}function ml(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const x=i.rowMarkerChecked;x!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=h);const H=i.headerRowMarkerTheme!==void 0?Pn(l,i.headerRowMarkerTheme):l;Bi(e,H,x,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),x!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=s?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(c||g&&s)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let x=s?"selected":"normal";i.style==="highlight"&&(x=s?"selected":"special"),w.drawSprite(i.icon,x,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&w.drawSprite(i.overlayIcon,s?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(C&&o>35){const H=m?35:o-35,D=m?35*.7:o-35*.7,X=H/o,A=D/o,F=e.createLinearGradient(t,0,t+o,0),Y=wo(v,0);F.addColorStop(m?1:0,v),F.addColorStop(X,v),F.addColorStop(A,Y),F.addColorStop(m?0:1,Y),e.fillStyle=F}else e.fillStyle=v;if(m&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,m?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+Jn(e,l.headerFontFull)),m&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!C||!ar(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let x=s?"selected":"normal";i.style==="highlight"&&(x=s?"selected":"special"),w.drawSprite(i.indicatorIcon,x,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(C&&b.menuBounds!==void 0){const x=b.menuBounds,H=f!==void 0&&u!==void 0&&mo(x,f+t,u+n);if(H||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Ur.Triangle){e.beginPath();const D=x.x+x.width/2-5.5,X=x.y+x.height/2-3;za(e,[{x:D,y:X},{x:D+11,y:X},{x:D+5.5,y:X+6}],1),e.fillStyle=v,e.fill()}else if(i.menuIcon===Ur.Dots){e.beginPath();const D=x.x+x.width/2,X=x.y+x.height/2;Aa(e,D,X),e.fillStyle=v,e.fill()}else{const D=x.x+(x.width-l.headerIconSize)/2,X=x.y+(x.height-l.headerIconSize)/2;w.drawSprite(i.menuIcon,"normal",e,D,X,l.headerIconSize,l)}H||(e.globalAlpha=1)}}function ls(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b){const v=Ai(i.title)==="rtl",C=is(e,i,t,n,o,r,l,v);m!==void 0?m({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:s,hoverAmount:w,isHovered:c,hasSelectedCell:h,spriteManager:g,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>ml(e,t,n,o,r,i,s,l,c,f,u,w,g,b,v,C)):ml(e,t,n,o,r,i,s,l,c,f,u,w,g,b,v,C)}function Mc(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C,x,H){if(x!==void 0||t[t.length-1]!==n[t.length-1])return;const D=Ql(C);Qn(t,o,c,s,l,i,b,(X,A,F,Y,z,N)=>{if(X!==t[t.length-1])return;A+=X.width;const _=Math.max(A,Y);_>o||(e.save(),e.beginPath(),e.rect(_,i+1,1e4,r-i-1),e.clip(),Jr(N,F,r,f,u,m,v,D,(L,P,S,R)=>{if(!R&&C.length>0&&!C.some(Te=>ar(A,L,1e4,S,Te.x,Te.y,Te.width,Te.height)))return;const j=w.hasIndex(P),ee=g.hasIndex(P);e.beginPath();const we=h==null?void 0:h(P),ke=we===void 0?H:Pn(H,we);ke.bgCell!==H.bgCell&&(e.fillStyle=ke.bgCell,e.fillRect(A,L,1e4,S)),ee&&(e.fillStyle=ke.bgHeader,e.fillRect(A,L,1e4,S)),j&&(e.fillStyle=ke.accentLight,e.fillRect(A,L,1e4,S))}),e.restore())})}function Rc(e,t,n,o,r,i,s,l,c){let f=!1;for(const b of t)if(!b.sticky){f=s(b.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,h=c.borderColor,[w,g]=f?$o(t):[0,0];let m;if(w!==0&&(m=yi(h,c.bgCell),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,o),e.strokeStyle=m,e.stroke()),g!==0){const b=h===u&&m!==void 0?m:yi(u,c.bgCell);e.beginPath(),e.moveTo(n-g+.5,0),e.lineTo(n-g+.5,o),e.strokeStyle=b,e.stroke()}if(r>0){const b=h===u&&m!==void 0?m:yi(u,c.bgCell),v=bo(i,r,l);e.beginPath(),e.moveTo(0,o-v+.5),e.lineTo(n,o-v+.5),e.strokeStyle=b,e.stroke()}}const ss=(e,t,n)=>{let o=0,r=t,i=0,s=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),s=Math.max(s,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:s}};function Ec(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m){var L;const b=m.bgCell,{minX:v,maxX:C,minY:x,maxY:H}=ss(l,i,s),D=[],X=s-bo(g,w,f);let A=c,F=n,Y=0;for(;A+r<X;){const P=A+r,S=f(F);if(P>=x&&P<=H-1){const R=u==null?void 0:u(F),j=R==null?void 0:R.bgCell;j!==void 0&&j!==b&&F>=g-w&&D.push({x:v,y:P,w:C-v,h:S,color:j})}A+=S,F<g-w&&(Y=A),F++}let z=0;const N=Math.min(X,H)-Y;if(N>0)for(let P=0;P<t.length;P++){const S=t[P];if(S.width===0)continue;const R=S.sticky?z:z+o,j=(L=S.themeOverride)==null?void 0:L.bgCell;j!==void 0&&j!==b&&R>=v&&R<=C&&h(P+1)&&D.push({x:R,y:Y,w:S.width,h:N,color:j}),z+=S.width}if(D.length===0)return;let _;e.beginPath();for(let P=D.length-1;P>=0;P--){const S=D[P];_===void 0?_=S.color:S.color!==_&&(e.fillStyle=_,e.fill(),e.beginPath(),_=S.color),e.rect(S.x,S.y,S.w,S.h)}_!==void 0&&(e.fillStyle=_,e.fill()),e.beginPath()}function wl(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C=!1){var P;if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,s);for(const S of c)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const x=v.horizontalBorderColor??v.borderColor,H=v.borderColor,{minX:D,maxX:X,minY:A,maxY:F}=ss(l,i,s),Y=[];e.beginPath();let z=.5;for(let S=0;S<t.length;S++){const R=t[S];if(R.width===0)continue;if((P=t[S+1])!=null&&P.sticky&&t[S+1].stickyPosition!=="left")break;z+=R.width;const j=R.sticky?z:z+o;j>=D&&j<=X&&g(S+1)&&Y.push({x1:j,y1:Math.max(f,A),x2:j,y2:Math.min(s,F),color:H})}let N=i+.5;for(let S=t.length-1;S>=0;S--){const R=t[S];if(R.width===0)continue;if(!R.sticky)break;N-=R.width;const j=N;j>=D&&j<=X&&g(S+1)&&Y.push({x1:j,y1:Math.max(f,A),x2:j,y2:Math.min(s,F),color:H})}let _=s+.5;for(let S=b-m;S<b;S++){const R=h(S);_-=R,Y.push({x1:D,y1:_,x2:X,y2:_,color:x})}if(C!==!0){let S=u+.5,R=n;const j=_;for(;S+r<j;){const ee=S+r;if(ee>=A&&ee<=F-1){const we=w==null?void 0:w(R);Y.push({x1:D,y1:ee,x2:X,y2:ee,color:(we==null?void 0:we.horizontalBorderColor)??(we==null?void 0:we.borderColor)??x})}S+=h(R),R++}}const L=Js(Y,S=>S.color);for(const S of Object.keys(L)){e.strokeStyle=S;for(const R of L[S])e.moveTo(R.x1,R.y1),e.lineTo(R.x2,R.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Ic(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C,x){const H=[];e.imageSmoothingEnabled=!1;const D=Math.min(r.cellYOffset,s),X=Math.max(r.cellYOffset,s);let A=0;if(typeof C=="number")A+=(X-D)*C;else for(let R=D;R<X;R++)A+=C(R);s>r.cellYOffset&&(A=-A),A+=c-r.translateY;const F=Math.min(r.cellXOffset,i),Y=Math.max(r.cellXOffset,i);let z=0;for(let R=F;R<Y;R++)z+=b[R].width;i>r.cellXOffset&&(z=-z),z+=l-r.translateX;const[N,_]=$o(v);if(z!==0&&A!==0)return{regions:[]};const L=f>0?bo(w,f,C):0,P=u-N-Math.abs(z)-_,S=h-g-L-Math.abs(A)-1;if(P>150&&S>150){const R={sx:0,sy:0,sw:u*m,sh:h*m,dx:0,dy:0,dw:u*m,dh:h*m};if(A>0?(R.sy=(g+1)*m,R.sh=S*m,R.dy=(A+g+1)*m,R.dh=S*m,H.push({x:0,y:g,width:u,height:A+1})):A<0&&(R.sy=(-A+g+1)*m,R.sh=S*m,R.dy=(g+1)*m,R.dh=S*m,H.push({x:0,y:h+A-L,width:u,height:-A+L})),z>0?(R.sx=N*m,R.sw=P*m,R.dx=(z+N)*m,R.dw=P*m,H.push({x:N-1,y:0,width:z+2,height:h})):z<0&&(R.sx=(N-z)*m,R.sw=P*m,R.dx=N*m,R.dw=P*m,H.push({x:u+z-_,y:0,width:-z+_,height:h})),e.setTransform(1,0,0,1,0,0),x){if(N>0&&z!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const j=N*m,ee=h*m;e.drawImage(t,0,0,j,ee,0,0,j,ee)}if(_>0&&z!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const j=(u-_)*m,ee=_*m,we=h*m;e.drawImage(t,j,0,ee,we,j,0,ee,we)}if(L>0&&z===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const j=(h-L)*m,ee=u*m,we=L*m;e.drawImage(t,0,j,ee,we,0,j,ee,we)}}e.drawImage(t,R.sx,R.sy,R.sw,R.sh,R.dx,R.dy,R.dw,R.dh),e.scale(m,m)}return e.imageSmoothingEnabled=!0,{regions:H}}function Dc(e,t,n,o,r,i,s,l,c,f,u){const h=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Qn(c,i,n,o,r,l,u,(w,g,m,b)=>{if(w.sourceIndex===f){const v=Math.max(g,b)+1;return h.push({x:v,y:0,width:i-v,height:s}),!0}}),h}function Fc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Po(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:s,...l}=r,{width:c,...f}=i;if(!Po(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function bl(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b){const v=m==null?void 0:m.filter(N=>N.style!=="no-outline"),C=typeof c=="number"?c:c[0],x=typeof c=="number"?0:c[1];if(v===void 0||v.length===0)return;const[H,D]=$o(l),X=bo(g,w,h),A=[C,0,l.length-x,g-w],F=[H,0,t-D,n-X],Y=v.map(N=>{const _=N.range,L=N.style??"dashed";return pc(_,A,t,n,F).map(P=>{const S=P.rect,R=Ri(S.x,S.y,t,n,u,f+u,o,r,i,s,g,c,w,l,h),j=S.width===1&&S.height===1?R:Ri(S.x+S.width-1,S.y+S.height-1,t,n,u,f+u,o,r,i,s,g,c,w,l,h);return S.x+S.width>=l.length&&(j.width-=1),S.y+S.height>=g&&(j.height-=1),{color:N.color,style:L,clip:P.clip,rect:yc({x:R.x,y:R.y,width:j.x+j.width-R.x,height:j.y+j.height-R.y},t,n,8)}})}),z=()=>{e.lineWidth=1;let N=!1;for(const _ of Y)for(const L of _)if((L==null?void 0:L.rect)!==void 0&&ar(0,0,t,n,L.rect.x,L.rect.y,L.rect.width,L.rect.height)){const P=N,S=!bc(L.clip,L.rect);e.beginPath(),S&&(e.save(),e.rect(L.clip.x,L.clip.y,L.clip.width,L.clip.height),e.clip()),L.style==="dashed"&&!N?(e.setLineDash([5,3]),N=!0):(L.style==="solid"||L.style==="solid-outline")&&N&&(e.setLineDash([]),N=!1),e.strokeStyle=L.style==="solid-outline"?nn(nn(L.color,b.borderColor),b.bgCell):wo(L.color,1),e.closePath(),e.strokeRect(L.rect.x+.5,L.rect.y+.5,L.rect.width-1,L.rect.height-1),S&&(e.restore(),N=P)}N&&e.setLineDash([])};return z(),z}function yl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function vi(e,t,n,o,r,i,s,l,c,f,u,h,w,g,m,b,v,C){if(u.current===void 0)return;const x=u.current.range,H=u.current.cell,D=[x.x+x.width-1,x.y+x.height-1];if(H[1]>=C&&D[1]>=C||!s.some(R=>R.sourceIndex===H[0]||R.sourceIndex===D[0]))return;const[A,F]=u.current.cell,Y=w(u.current.cell),z=Y.span??[A,A],N=F>=C-g,_=g>0&&!N?bo(C,g,h)-1:0,L=D[1];let P;if(Qn(s,t,o,r,i,f,m,(R,j,ee,we,ke,Te)=>{if(R.sticky&&A>R.sourceIndex)return;const $=R.sourceIndex<z[0],ae=R.sourceIndex>z[1],ie=R.sourceIndex===D[0];if(!(!ie&&($||ae)))return Jr(Te,ee,n,C,h,g,b,void 0,(Re,fe,U)=>{if(fe!==F&&fe!==L)return;let xe=j,et=R.width;if(Y.span!==void 0){const le=ts(Y.span,j,Re,R.width,U,R,l),Ge=R.sticky?le[0]:le[1];Ge!==void 0&&(xe=Ge.x,et=Ge.width)}return fe===L&&ie&&v&&(P=()=>{var le;we>xe&&!R.sticky&&(e.beginPath(),e.rect(we,0,t-we,n),e.clip()),e.beginPath(),e.rect(xe+et-4,Re+U-4,4,4),e.fillStyle=((le=R.themeOverride)==null?void 0:le.accentColor)??c.accentColor,e.fill()}),P!==void 0}),P!==void 0}),P===void 0)return;const S=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-_),e.clip(),P==null||P(),e.restore()};return S(),S}function Hc(e,t,n,o,r,i,s,l,c,f){f===void 0||f.size===0||(e.beginPath(),es(t,n,i,o,c,(u,h,w,g,m,b)=>{f.hasItemInRectangle({x:u[0],y:-2,width:u[1]-u[0]+1,height:1})&&e.rect(w,g,m,b)}),Qn(t,n,l,i,s,r,c,(u,h,w,g,m)=>{const b=Math.max(0,g-h),v=h+b+1,C=u.stickyPosition==="right"?u.width-b:Math.min(u.width-b-1,n-h-m);f.has([u.sourceIndex,-1])&&e.rect(v,o,C,r-o)}),e.clip())}function Tc(e,t,n,o,r,i,s,l,c,f,u,h){let w=0;return Qn(e,n,s,r,i,o,h,(g,m,b,v,C,x)=>(Jr(x,b,t,l,c,f,u,void 0,(H,D,X,A)=>{A||(w=Math.max(D,w))}),!0)),w}function pl(e,t){var Rt;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:s,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:h,freezeColumns:w,dragAndDropState:g,theme:m,drawFocus:b,headerHeight:v,groupHeaderHeight:C,disabledRows:x,rowHeight:H,verticalBorder:D,overrideCursor:X,isResizing:A,selection:F,fillHandle:Y,freezeTrailingRows:z,rows:N,getCellContent:_,getGroupDetails:L,getRowThemeOverride:P,isFocused:S,drawHeaderCallback:R,prelightCells:j,drawCellCallback:ee,highlightRegions:we,resizeCol:ke,imageLoader:Te,lastBlitData:$,hoverValues:ae,hyperWrapping:ie,hoverInfo:Re,spriteManager:fe,maxScaleFactor:U,hasAppendRow:xe,touchMode:et,enqueue:ot,renderStateProvider:le,getCellRenderer:Ge,renderStrategy:tt,bufferACtx:at,bufferBCtx:ze,damage:Ee,minimumCellWidth:dt,resizeIndicator:ut}=e;if(r===0||i===0)return;const je=tt==="double-buffer",Z=Math.min(U,Math.ceil(window.devicePixelRatio??1)),_e=typeof w=="number"?w:w[0],Ce=typeof w=="number"?0:w[1],Ae=tt!=="direct"&&Fc(e,t),Oe=n.canvas;(Oe.width!==r*Z||Oe.height!==i*Z)&&(Oe.width=r*Z,Oe.height=i*Z,Oe.style.width=r+"px",Oe.style.height=i+"px");const rt=o.canvas,Ue=h?C+v:v,Ke=Ue+1;(rt.width!==r*Z||rt.height!==Ke*Z)&&(rt.width=r*Z,rt.height=Ke*Z,rt.style.width=r+"px",rt.style.height=Ke+"px");const nt=at.canvas,se=ze.canvas;je&&(nt.width!==r*Z||nt.height!==i*Z)&&(nt.width=r*Z,nt.height=i*Z,$.current!==void 0&&($.current.aBufferScroll=void 0)),je&&(se.width!==r*Z||se.height!==i*Z)&&(se.width=r*Z,se.height=i*Z,$.current!==void 0&&($.current.bBufferScroll=void 0));const J=$.current;if(Ae===!0&&s===(J==null?void 0:J.cellXOffset)&&l===(J==null?void 0:J.cellYOffset)&&c===(J==null?void 0:J.translateX)&&f===(J==null?void 0:J.translateY))return;let Mt=null;je&&(Mt=n);const Ne=o;let He;je?Ee!==void 0?He=(J==null?void 0:J.lastBuffer)==="b"?ze:at:He=(J==null?void 0:J.lastBuffer)==="b"?at:ze:He=n;const Pt=He.canvas,Ze=je?Pt===nt?se:nt:Oe,Ve=typeof H=="number"?()=>H:H;Ne.save(),He.save(),Ne.beginPath(),He.beginPath(),Ne.textBaseline="middle",He.textBaseline="middle",Z!==1&&(Ne.scale(Z,Z),He.scale(Z,Z));const Fe=Gr(u,s,r,w,g,c);let ht=[];const Nt=b&&((Rt=F.current)==null?void 0:Rt.cell[1])===l&&f===0;let Tt=!1;if(we!==void 0){for(const ct of we)if(ct.style!=="no-outline"&&ct.range.y===l&&f===0){Tt=!0;break}}const Ft=()=>{xc(Ne,Fe,h,Re,r,c,v,C,g,A,F,m,fe,ae,D,L,Ee,R,et,Ce),wl(Ne,Fe,l,c,f,r,i,void 0,void 0,C,Ue,Ve,P,D,z,N,m,!0),Ne.beginPath(),Ne.moveTo(0,Ke-.5),Ne.lineTo(r,Ke-.5),Ne.strokeStyle=nn(m.headerBottomBorderColor??m.horizontalBorderColor??m.borderColor,m.bgHeader),Ne.stroke(),Tt&&bl(Ne,r,i,s,l,c,f,u,w,v,C,H,z,N,we,m),Nt&&vi(Ne,r,i,l,c,f,Fe,u,m,Ue,F,Ve,_,z,Ce,xe,Y,N)};if(Ee!==void 0){const ct=Fe[Fe.length-1].sourceIndex+1,Kt=Ee.hasItemInRegion([{x:s,y:-2,width:ct,height:2},{x:s,y:l,width:ct,height:300},{x:0,y:l,width:_e,height:300},{x:0,y:-2,width:_e,height:2},{x:s,y:N-z,width:ct,height:z,when:z>0},{x:ct-Ce,y:l,width:Ce,height:300},{x:ct-Ce,y:-2,width:Ce,height:2}]),bn=zt=>{gl(zt,Fe,u,i,r,Ue,c,f,l,N,Ve,_,L,P,x,S,b,z,Ce,xe,ht,Ee,F,j,we,Te,fe,ae,Re,ee,ie,m,ot,le,Ge,X,dt);const ln=F.current;Y&&b&&ln!==void 0&&Ee.has(Ol(ln.range))&&vi(zt,r,i,l,c,f,Fe,u,m,Ue,F,Ve,_,z,Ce,xe,Y,N)};Kt&&(bn(He),Mt!==null&&(Mt.save(),Mt.scale(Z,Z),Mt.textBaseline="middle",bn(Mt),Mt.restore()),Ee.hasHeader()&&(Hc(Ne,Fe,r,C,Ue,c,f,l,Ce,Ee),Ft())),He.restore(),Ne.restore();return}if((Ae!==!0||s!==(J==null?void 0:J.cellXOffset)||c!==(J==null?void 0:J.translateX)||Nt!==(J==null?void 0:J.mustDrawFocusOnHeader)||Tt!==(J==null?void 0:J.mustDrawHighlightRingsOnHeader))&&Ft(),Ae===!0){tn(Ze!==void 0&&J!==void 0);const{regions:ct}=Ic(He,Ze,Ze===nt?J.aBufferScroll:J.bBufferScroll,Ze===nt?J.bBufferScroll:J.aBufferScroll,J,s,l,c,f,z,r,i,N,Ue,Z,u,Fe,H,je);ht=ct}else Ae!==!1&&(tn(J!==void 0),ht=Dc(J,s,l,c,f,r,i,Ue,Fe,Ae,Ce));Rc(He,Fe,r,i,z,N,D,Ve,m);const xt=bl(He,r,i,s,l,c,f,u,w,v,C,H,z,N,we,m),rn=b?vi(He,r,i,l,c,f,Fe,u,m,Ue,F,Ve,_,z,Ce,xe,Y,N):void 0;if(He.fillStyle=m.bgCell,ht.length>0){He.beginPath();for(const ct of ht)He.rect(ct.x,ct.y,ct.width,ct.height);He.clip(),He.fill(),He.beginPath()}else He.fillRect(0,0,r,i);const Bt=gl(He,Fe,u,i,r,Ue,c,f,l,N,Ve,_,L,P,x,S,b,z,Ce,xe,ht,Ee,F,j,we,Te,fe,ae,Re,ee,ie,m,ot,le,Ge,X,dt);Mc(He,Fe,u,r,i,Ue,c,f,l,N,Ve,P,F.rows,x,z,Ce,xe,ht,Ee,m),Ec(He,Fe,l,c,f,r,i,ht,Ue,Ve,P,D,z,N,m),wl(He,Fe,l,c,f,r,i,ht,Bt,C,Ue,Ve,P,D,z,N,m),xt==null||xt(),rn==null||rn(),A&&ut!=="none"&&Qn(Fe,r,0,c,0,Ue,Ce,(ct,Kt)=>ct.sourceIndex===ke?(yl(Ne,Kt+ct.width,0,Ue+1,nn(m.resizeIndicatorColor??m.accentLight,m.bgHeader)),ut==="full"&&yl(He,Kt+ct.width,Ue,i,nn(m.resizeIndicatorColor??m.accentLight,m.bgCell)),!0):!1),Mt!==null&&(Mt.fillStyle=m.bgCell,Mt.fillRect(0,0,r,i),Mt.drawImage(He.canvas,0,0));const eo=Tc(Fe,i,r,Ue,c,f,l,N,Ve,z,xe,Ce);Te==null||Te.setWindow({x:s,y:l,width:Fe.length,height:eo-l},w,Array.from({length:z},(ct,Kt)=>N-1-Kt),u.length);const wn=J!==void 0&&(s!==J.cellXOffset||c!==J.translateX),Se=J!==void 0&&(l!==J.cellYOffset||f!==J.translateY);$.current={cellXOffset:s,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:Nt,mustDrawHighlightRingsOnHeader:Tt,lastBuffer:je?Pt===nt?"a":"b":void 0,aBufferScroll:Pt===nt?[wn,Se]:J==null?void 0:J.aBufferScroll,bBufferScroll:Pt===se?[wn,Se]:J==null?void 0:J.bBufferScroll},He.restore(),Ne.restore()}const Ac=80;function zc(e){const t=e-1;return t*t*t+1}class Lc{constructor(t){We(this,"callback");We(this,"currentHoveredItem");We(this,"leavingItems",[]);We(this,"lastAnimationTime");We(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>rr(o.item,t.item))||this.leavingItems.push(t)});We(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>rr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});We(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});We(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});We(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:zc(t.hoverAmount)})));We(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Ac;for(const i of this.leavingItems)i.hoverAmount=en(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=en(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});We(this,"setHovered",t=>{var n;if(!rr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Pc{constructor(t){We(this,"fn");We(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Wi(e){return new Pc(e)}const Bc=Wi(()=>window.navigator.userAgent.includes("Firefox")),Vr=Wi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),qr=Wi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Wc(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(s),s=()=>{const l=t.current.map(Pi);t.current=[],o.current(new lr(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:s)},[]);return a.useCallback(i=>{t.current.length===0&&r();const s=kn(i[0],i[1]);t.current.includes(s)||t.current.push(s)},[r])}const Zn="header",gn="group-header",jr="out-of-bounds";var Lo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Lo||(Lo={}));function as(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const vl=6,$c=(e,t)=>{if(e.kind===ne.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Oc=(e,t)=>{var ro,Xt;const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:s,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:h,rows:w,getCellContent:g,getRowThemeOverride:m,onHeaderMenuClick:b,onHeaderIndicatorClick:v,enableGroups:C,isFilling:x,onCanvasFocused:H,onCanvasBlur:D,isFocused:X,selection:A,freezeColumns:F,onContextMenu:Y,freezeTrailingRows:z,fixedShadowX:N=!0,fixedShadowY:_=!0,drawFocusRing:L,onMouseDown:P,onMouseUp:S,onMouseMoveRaw:R,onMouseMove:j,onItemHovered:ee,dragAndDropState:we,firstColAccessible:ke,onKeyDown:Te,onKeyUp:$,highlightRegions:ae,canvasRef:ie,onDragStart:Re,onDragEnd:fe,eventTargetRef:U,isResizing:xe,resizeColumn:et,isDragging:ot,isDraggable:le=!1,allowResize:Ge,disabledRows:tt,hasAppendRow:at,getGroupDetails:ze,theme:Ee,prelightCells:dt,headerIcons:ut,verticalBorder:je,drawCell:Z,drawHeader:_e,onCellFocused:Ce,onDragOverCell:Ae,onDrop:Oe,onDragLeave:rt,imageWindowLoader:Ue,smoothScrollX:Ke=!1,smoothScrollY:nt=!1,experimental:se,getCellRenderer:J,resizeIndicator:Mt="full"}=e,Ne=e.translateX??0,He=e.translateY??0,Pt=typeof F=="number"?F:F[0],Ze=typeof F=="number"?0:F[1],Ve=Math.max(Pt,Math.min(i.length-1,s)),Fe=a.useRef(null),ht=a.useRef((se==null?void 0:se.eventTarget)??window),Nt=ht.current,Tt=Ue,Ft=a.useRef(),[xt,rn]=a.useState(!1),Bt=a.useRef([]),eo=a.useRef(),[wn,Se]=a.useState(),[Rt,ct]=a.useState(),Kt=a.useRef(null),[bn,zt]=a.useState(),[ln,Bn]=a.useState(!1),Le=a.useRef(ln);Le.current=ln;const gt=a.useMemo(()=>new mc(ut,()=>{po.current=void 0,oo.current()}),[ut]),it=C?u+c:c,Zt=a.useRef(-1),Ut=((se==null?void 0:se.enableFirefoxRescaling)??!1)&&Bc.value,ft=((se==null?void 0:se.enableSafariRescaling)??!1)&&Vr.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!Ut&&!ft||(Zt.current!==-1&&rn(!0),window.clearTimeout(Zt.current),Zt.current=window.setTimeout(()=>{rn(!1),Zt.current=-1},200))},[l,Ve,Ne,He,Ut,ft]);const vt=Ca(i,F),to=a.useMemo(()=>N?$o(vt,we):[0,0],[N,vt,we]),It=a.useCallback((k,V,ue)=>{const ce=k.getBoundingClientRect();if(V>=vt.length||ue>=w)return;const Q=ce.width/n,oe=Ri(V,ue,n,o,u,it,Ve,l,Ne,He,w,F,z,vt,h);return Q!==1&&(oe.x*=Q,oe.y*=Q,oe.width*=Q,oe.height*=Q),oe.x+=ce.x,oe.y+=ce.y,oe},[n,o,u,it,Ve,l,Ne,He,w,F,z,vt,h]),Ht=a.useCallback((k,V,ue,ce)=>{const Q=k.getBoundingClientRect(),oe=Q.width/n,he=(V-Q.left)/oe,me=(ue-Q.top)/oe,te=5,qe=Gr(vt,Ve,n,F,void 0,Ne);let ye=0,Je=0;ce instanceof MouseEvent&&(ye=ce.button,Je=ce.buttons);const $e=Ma(he,qe,F,n,Ne),De=Ra(me,o,C,c,u,w,h,l,He,z),Xe=(ce==null?void 0:ce.shiftKey)===!0,qt=(ce==null?void 0:ce.ctrlKey)===!0,kt=(ce==null?void 0:ce.metaKey)===!0,Yt=ce!==void 0&&!(ce instanceof MouseEvent)||(ce==null?void 0:ce.pointerType)==="touch",yn=[he<0?-1:n<he?1:0,me<it?-1:o<me?1:0];let jt;if($e===-1||me<0||he<0||De===void 0||he>n||me>o){const be=he>n?1:he<0?-1:0,yt=me>o?1:me<0?-1:0;let Gt=be*2,_n=yt*2;be===0&&(Gt=$e===-1?Lo.EndPadding:Lo.Center),yt===0&&(_n=De===void 0?Lo.EndPadding:Lo.Center);let $t=!1;if($e===-1&&De===-1){const io=It(k,vt.length-1,-1);tn(io!==void 0),$t=V<io.x+io.width+te}const lt=he>n&&he<n+Mi()||me>o&&me<o+Mi();jt={kind:jr,location:[$e!==-1?$e:he<0?0:vt.length-1,De??w-1],region:[Gt,_n],shiftKey:Xe,ctrlKey:qt,metaKey:kt,isEdge:$t,isTouch:Yt,button:ye,buttons:Je,scrollEdge:yn,isMaybeScrollbar:lt}}else if(De<=-1){let be=It(k,$e,De);tn(be!==void 0);let yt=be!==void 0&&be.x+be.width-V<=te;const Gt=$e-1;V-be.x<=te&&Gt>=0&&$e<vt.length-Ze?(yt=!0,be=It(k,Gt,De),tn(be!==void 0),jt={kind:C&&De===-2?gn:Zn,location:[Gt,De],bounds:be,group:vt[Gt].group??"",isEdge:yt,shiftKey:Xe,ctrlKey:qt,metaKey:kt,isTouch:Yt,localEventX:V-be.x,localEventY:ue-be.y,button:ye,buttons:Je,scrollEdge:yn}):jt={kind:C&&De===-2?gn:Zn,group:vt[$e].group??"",location:[$e,De],bounds:be,isEdge:yt,shiftKey:Xe,ctrlKey:qt,metaKey:kt,isTouch:Yt,localEventX:V-be.x,localEventY:ue-be.y,button:ye,buttons:Je,scrollEdge:yn}}else{const be=It(k,$e,De);tn(be!==void 0);const yt=be!==void 0&&be.x+be.width-V<te;let Gt=!1;if(f&&A.current!==void 0){const _n=Ol(A.current.range),$t=It(k,_n[0],_n[1]);if($t!==void 0){const lt=$t.x+$t.width-2,io=$t.y+$t.height-2;Gt=Math.abs(lt-V)<vl&&Math.abs(io-ue)<vl}}jt={kind:"cell",location:[$e,De],bounds:be,isEdge:yt,shiftKey:Xe,ctrlKey:qt,isFillHandle:Gt,metaKey:kt,isTouch:Yt,localEventX:V-be.x,localEventY:ue-be.y,button:ye,buttons:Je,scrollEdge:yn}}return jt},[n,vt,Ve,Ne,o,C,c,u,w,h,l,He,z,It,f,A,it,F,Ze]),[Hn]=wn??[],dr=a.useRef(()=>{}),Wn=a.useRef(wn);Wn.current=wn;const[Jt,Tn]=a.useMemo(()=>{const k=document.createElement("canvas"),V=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",V.style.display="none",V.style.opacity="0",V.style.position="fixed",[k.getContext("2d",{alpha:!1}),V.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Jt===null||Tn===null))return document.documentElement.append(Jt.canvas),document.documentElement.append(Tn.canvas),()=>{Jt.canvas.remove(),Tn.canvas.remove()}},[Jt,Tn]);const yo=a.useMemo(()=>new La,[]),ur=Ut&&xt?1:ft&&xt?2:5,fr=(se==null?void 0:se.disableMinimumCellWidth)===!0?1:10,po=a.useRef(),no=a.useRef(null),vo=a.useRef(null),Co=a.useCallback(()=>{var he;const k=Fe.current,V=Kt.current;if(k===null||V===null||(no.current===null&&(no.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),vo.current===null&&(vo.current=V.getContext("2d",{alpha:!1}),V.width=0,V.height=0),no.current===null||vo.current===null||Jt===null||Tn===null))return;let ue=!1;const ce=me=>{ue=!0,zt(me)},Q=po.current,oe={headerCanvasCtx:vo.current,canvasCtx:no.current,bufferACtx:Jt,bufferBCtx:Tn,width:n,height:o,cellXOffset:Ve,cellYOffset:l,translateX:Math.round(Ne),translateY:Math.round(He),mappedColumns:vt,enableGroups:C,freezeColumns:F,dragAndDropState:we,theme:Ee,headerHeight:c,groupHeaderHeight:u,disabledRows:tt??st.empty(),rowHeight:h,verticalBorder:je,isResizing:xe,resizeCol:et,isFocused:X,selection:A,fillHandle:f,drawCellCallback:Z,hasAppendRow:at,overrideCursor:ce,maxScaleFactor:ur,freezeTrailingRows:z,rows:w,drawFocus:L,getCellContent:g,getGroupDetails:ze??(me=>({name:me})),getRowThemeOverride:m,drawHeaderCallback:_e,prelightCells:dt,highlightRegions:ae,imageLoader:Tt,lastBlitData:eo,damage:Ft.current,hoverValues:Bt.current,hoverInfo:Wn.current,spriteManager:gt,scrolling:xt,hyperWrapping:(se==null?void 0:se.hyperWrapping)??!1,touchMode:ln,enqueue:dr.current,renderStateProvider:yo,renderStrategy:(se==null?void 0:se.renderStrategy)??(Vr.value?"double-buffer":"single-buffer"),getCellRenderer:J,minimumCellWidth:fr,resizeIndicator:Mt};oe.damage===void 0?(po.current=oe,pl(oe,Q)):pl(oe,void 0),!ue&&(oe.damage===void 0||oe.damage.has((he=Wn==null?void 0:Wn.current)==null?void 0:he[0]))&&zt(void 0)},[Jt,Tn,n,o,Ve,l,Ne,He,vt,C,F,we,Ee,c,u,tt,h,je,xe,at,et,X,A,f,z,w,L,ur,g,ze,m,Z,_e,dt,ae,Tt,gt,xt,se==null?void 0:se.hyperWrapping,se==null?void 0:se.renderStrategy,ln,yo,J,fr,Mt]),oo=a.useRef(Co);a.useLayoutEffect(()=>{Co(),oo.current=Co},[Co]),a.useLayoutEffect(()=>{(async()=>{var V;((V=document==null?void 0:document.fonts)==null?void 0:V.ready)!==void 0&&(await document.fonts.ready,po.current=void 0,oo.current())})()},[]);const $n=a.useCallback(k=>{Ft.current=k,oo.current(),Ft.current=void 0},[]),hr=Wc($n);dr.current=hr;const gr=a.useCallback(k=>{$n(new lr(k.map(V=>V.cell)))},[$n]);Tt.setCallback($n);const[Qr,ei]=a.useState(!1),[On,Nn]=Hn??[],mr=On!==void 0&&Nn===-1,wr=On!==void 0&&Nn===-2;let br=!1,No=!1,mt=bn;if(mt===void 0&&On!==void 0&&Nn!==void 0&&Nn>-1&&Nn<w){const k=g([On,Nn],!0);br=k.kind===mn.NewRow||k.kind===mn.Marker&&k.markerKind!=="number",No=k.kind===ne.Boolean&&Hi(k),mt=k.cursor}const yr=ot?"grabbing":(Rt??!1)||xe?"col-resize":Qr||x?"crosshair":mt!==void 0?mt:mr||br||No||wr?"pointer":"default",xo=a.useMemo(()=>({contain:"strict",display:"block",cursor:yr}),[yr]),Xo=a.useRef("default"),ko=U==null?void 0:U.current;ko!=null&&Xo.current!==xo.cursor&&(ko.style.cursor=Xo.current=xo.cursor);const An=a.useCallback((k,V,ue,ce)=>{if(ze===void 0)return;const Q=ze(k);if(Q.actions!==void 0){const oe=rs(V,Q.actions);for(const[he,me]of oe.entries())if(mo(me,ue+V.x,ce+me.y))return Q.actions[he]}},[ze]),zn=a.useCallback((k,V,ue,ce)=>{const Q=vt[V];if(!ot&&!xe&&!(Rt??!1)){const oe=It(k,V,-1);tn(oe!==void 0);const he=is(void 0,Q,oe.x,oe.y,oe.width,oe.height,Ee,Ai(Q.title)==="rtl");if(Q.hasMenu===!0&&he.menuBounds!==void 0&&mo(he.menuBounds,ue,ce))return{area:"menu",bounds:he.menuBounds};if(Q.indicatorIcon!==void 0&&he.indicatorIconBounds!==void 0&&mo(he.indicatorIconBounds,ue,ce))return{area:"indicator",bounds:he.indicatorIconBounds}}},[vt,It,Rt,ot,xe,Ee]),Xn=a.useRef(0),an=a.useRef(),Yn=a.useRef(!1),pr=a.useCallback(k=>{const V=Fe.current,ue=U==null?void 0:U.current;if(V===null||k.target!==V&&k.target!==ue)return;Yn.current=!0;let ce,Q;if(k instanceof MouseEvent?(ce=k.clientX,Q=k.clientY):(ce=k.touches[0].clientX,Q=k.touches[0].clientY),k.target===ue&&ue!==null){const he=ue.getBoundingClientRect();if(ce>he.right||Q>he.bottom)return}const oe=Ht(V,ce,Q,k);an.current=oe.location,oe.isTouch&&(Xn.current=Date.now()),Le.current!==oe.isTouch&&Bn(oe.isTouch),!(oe.kind===Zn&&zn(V,oe.location[0],ce,Q)!==void 0)&&(oe.kind===gn&&An(oe.group,oe.bounds,oe.localEventX,oe.localEventY)!==void 0||(P==null||P(oe),!oe.isTouch&&le!==!0&&le!==oe.kind&&oe.button<3&&oe.button!==1&&k.preventDefault()))},[U,le,Ht,An,zn,P]);Lt("touchstart",pr,Nt,!1),Lt("mousedown",pr,Nt,!1);const cn=a.useRef(0),Vt=a.useCallback(k=>{var Je,$e;const V=cn.current;cn.current=Date.now();const ue=Fe.current;if(Yn.current=!1,S===void 0||ue===null)return;const ce=U==null?void 0:U.current,Q=k.target!==ue&&k.target!==ce;let oe,he,me=!0;if(k instanceof MouseEvent){if(oe=k.clientX,he=k.clientY,me=k.button<3,k.pointerType==="touch")return}else oe=k.changedTouches[0].clientX,he=k.changedTouches[0].clientY;let te=Ht(ue,oe,he,k);te.isTouch&&Xn.current!==0&&Date.now()-Xn.current>500&&(te={...te,isLongTouch:!0}),V!==0&&Date.now()-V<(te.isTouch?1e3:500)&&(te={...te,isDoubleClick:!0}),Le.current!==te.isTouch&&Bn(te.isTouch),!Q&&k.cancelable&&me&&k.preventDefault();const[qe]=te.location,ye=zn(ue,qe,oe,he);if(te.kind===Zn&&ye!==void 0){(te.button!==0||((Je=an.current)==null?void 0:Je[0])!==qe||(($e=an.current)==null?void 0:$e[1])!==-1)&&S(te,!0);return}else if(te.kind===gn){const De=An(te.group,te.bounds,te.localEventX,te.localEventY);if(De!==void 0){te.button===0&&De.onClick(te);return}}S(te,Q)},[S,U,Ht,zn,An]);Lt("mouseup",Vt,Nt,!1),Lt("touchend",Vt,Nt,!1);const vr=a.useCallback(k=>{var qe,ye;const V=Fe.current;if(V===null)return;const ue=U==null?void 0:U.current,ce=k.target!==V&&k.target!==ue;let Q,oe,he=!0;k instanceof MouseEvent?(Q=k.clientX,oe=k.clientY,he=k.button<3):(Q=k.changedTouches[0].clientX,oe=k.changedTouches[0].clientY);const me=Ht(V,Q,oe,k);Le.current!==me.isTouch&&Bn(me.isTouch),!ce&&k.cancelable&&he&&k.preventDefault();const[te]=me.location;if(me.kind===Zn){const Je=zn(V,te,Q,oe);Je!==void 0&&me.button===0&&((qe=an.current)==null?void 0:qe[0])===te&&((ye=an.current)==null?void 0:ye[1])===-1&&(Je.area==="menu"?b==null||b(te,Je.bounds):Je.area==="indicator"&&(v==null||v(te,Je.bounds)))}else if(me.kind===gn){const Je=An(me.group,me.bounds,me.localEventX,me.localEventY);Je!==void 0&&me.button===0&&Je.onClick(me)}},[U,Ht,zn,b,v,An]);Lt("click",vr,Nt,!1);const Ie=a.useCallback(k=>{const V=Fe.current,ue=U==null?void 0:U.current;if(V===null||k.target!==V&&k.target!==ue||Y===void 0)return;const ce=Ht(V,k.clientX,k.clientY,k);Y(ce,()=>{k.cancelable&&k.preventDefault()})},[U,Ht,Y]);Lt("contextmenu",Ie,(U==null?void 0:U.current)??null,!1);const Yo=a.useCallback(k=>{Ft.current=new lr(k.map(V=>V.item)),Bt.current=k,oo.current(),Ft.current=void 0},[]),Cr=a.useMemo(()=>new Lc(Yo),[Yo]),dn=a.useRef(Cr);dn.current=Cr,a.useLayoutEffect(()=>{const k=dn.current;if(Hn===void 0||Hn[1]<0){k.setHovered(Hn);return}const V=g(Hn,!0),ue=J(V),ce=ue===void 0&&V.kind===ne.Custom||(ue==null?void 0:ue.needsHover)!==void 0&&(typeof ue.needsHover=="boolean"?ue.needsHover:ue.needsHover(V));k.setHovered(ce?Hn:void 0)},[g,J,Hn]);const xr=a.useRef(),Sn=a.useCallback(k=>{var me;const V=Fe.current;if(V===null)return;const ue=U==null?void 0:U.current,ce=k.target!==V&&k.target!==ue,Q=Ht(V,k.clientX,k.clientY,k);if(Q.kind!=="out-of-bounds"&&ce&&!Yn.current&&!Q.isTouch)return;const oe=(te,qe)=>{Se(ye=>ye===te||(ye==null?void 0:ye[0][0])===(te==null?void 0:te[0][0])&&(ye==null?void 0:ye[0][1])===(te==null?void 0:te[0][1])&&((ye==null?void 0:ye[1][0])===(te==null?void 0:te[1][0])&&(ye==null?void 0:ye[1][1])===(te==null?void 0:te[1][1])||!qe)?ye:te)};if(!as(Q,xr.current))zt(void 0),ee==null||ee(Q),oe(Q.kind===jr?void 0:[Q.location,[Q.localEventX,Q.localEventY]],!0),xr.current=Q;else if(Q.kind==="cell"||Q.kind===Zn||Q.kind===gn){let te=!1,qe=!0;if(Q.kind==="cell"){const Je=g(Q.location);qe=((me=J(Je))==null?void 0:me.needsHoverPosition)??Je.kind===ne.Custom,te=qe}else te=!0;const ye=[Q.location,[Q.localEventX,Q.localEventY]];oe(ye,qe),Wn.current=ye,te&&$n(new lr([Q.location]))}const he=Q.location[0]>=(ke?0:1);ct(Q.kind===Zn&&Q.isEdge&&he&&Ge===!0),ei(Q.kind==="cell"&&Q.isFillHandle),R==null||R(k),j(Q)},[U,Ht,ke,Ge,R,j,ee,g,J,$n]);Lt("mousemove",Sn,Nt,!0);const Go=a.useCallback(k=>{const V=Fe.current;if(V===null)return;let ue,ce;A.current!==void 0&&(ue=It(V,A.current.cell[0],A.current.cell[1]),ce=A.current.cell),Te==null||Te({bounds:ue,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:ce})},[Te,A,It]),kr=a.useCallback(k=>{const V=Fe.current;if(V===null)return;let ue,ce;A.current!==void 0&&(ue=It(V,A.current.cell[0],A.current.cell[1]),ce=A.current.cell),$==null||$({bounds:ue,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:ce})},[$,A,It]),Sr=a.useCallback(k=>{if(Fe.current=k,ie!==void 0&&(ie.current=k),se!=null&&se.eventTarget)ht.current=se.eventTarget;else if(k===null)ht.current=window;else{const V=k.getRootNode();V===document&&(ht.current=window),ht.current=V}},[ie,se==null?void 0:se.eventTarget]),ti=a.useCallback(k=>{const V=Fe.current;if(V===null||le===!1||xe){k.preventDefault();return}let ue,ce;const Q=Ht(V,k.clientX,k.clientY);if(le!==!0&&Q.kind!==le){k.preventDefault();return}const oe=(Je,$e)=>{ue=Je,ce=$e};let he,me,te;const qe=(Je,$e,De)=>{he=Je,me=$e,te=De};let ye=!1;if(Re==null||Re({...Q,setData:oe,setDragImage:qe,preventDefault:()=>ye=!0,defaultPrevented:()=>ye}),!ye&&ue!==void 0&&ce!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(ue,ce),k.dataTransfer.effectAllowed="copyLink",he!==void 0&&me!==void 0&&te!==void 0)k.dataTransfer.setDragImage(he,me,te);else{const[Je,$e]=Q.location;if($e!==void 0){const De=document.createElement("canvas"),Xe=It(V,Je,$e);tn(Xe!==void 0);const qt=Math.ceil(window.devicePixelRatio??1);De.width=Xe.width*qt,De.height=Xe.height*qt;const kt=De.getContext("2d");kt!==null&&(kt.scale(qt,qt),kt.textBaseline="middle",$e===-1?(kt.font=Ee.headerFontFull,kt.fillStyle=Ee.bgHeader,kt.fillRect(0,0,De.width,De.height),ls(kt,0,0,Xe.width,Xe.height,vt[Je],!1,Ee,!1,void 0,void 0,!1,0,gt,_e,!1)):(kt.font=Ee.baseFontFull,kt.fillStyle=Ee.bgCell,kt.fillRect(0,0,De.width,De.height),os(kt,g([Je,$e]),0,$e,!1,!1,0,0,Xe.width,Xe.height,!1,Ee,Ee.bgCell,Tt,gt,1,void 0,!1,0,void 0,void 0,void 0,yo,J,()=>{}))),De.style.left="-100%",De.style.position="absolute",De.style.width=`${Xe.width}px`,De.style.height=`${Xe.height}px`,document.body.append(De),k.dataTransfer.setDragImage(De,Xe.width/2,Xe.height/2),window.setTimeout(()=>{De.remove()},0)}}else k.preventDefault()},[le,xe,Ht,Re,It,Ee,vt,gt,_e,g,Tt,yo,J]);Lt("dragstart",ti,(U==null?void 0:U.current)??null,!1,!1);const _o=a.useRef(),Mn=a.useCallback(k=>{const V=Fe.current;if(Oe!==void 0&&k.preventDefault(),V===null||Ae===void 0)return;const ue=Ht(V,k.clientX,k.clientY),[ce,Q]=ue.location,oe=ce-(ke?0:1),[he,me]=_o.current??[];(he!==oe||me!==Q)&&(_o.current=[oe,Q],Ae([oe,Q],k.dataTransfer))},[ke,Ht,Ae,Oe]);Lt("dragover",Mn,(U==null?void 0:U.current)??null,!1,!1);const Gn=a.useCallback(()=>{_o.current=void 0,fe==null||fe()},[fe]);Lt("dragend",Gn,(U==null?void 0:U.current)??null,!1,!1);const un=a.useCallback(k=>{const V=Fe.current;if(V===null||Oe===void 0)return;k.preventDefault();const ue=Ht(V,k.clientX,k.clientY),[ce,Q]=ue.location,oe=ce-(ke?0:1);Oe([oe,Q],k.dataTransfer)},[ke,Ht,Oe]);Lt("drop",un,(U==null?void 0:U.current)??null,!1,!1);const E=a.useCallback(()=>{rt==null||rt()},[rt]);Lt("dragleave",E,(U==null?void 0:U.current)??null,!1,!1);const bt=a.useRef(A);bt.current=A;const Rn=a.useRef(null),Ko=a.useCallback(k=>{var V;Fe.current===null||!Fe.current.contains(document.activeElement)||(k===null&&bt.current.current!==void 0?(V=ie==null?void 0:ie.current)==null||V.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),Rn.current=k)},[ie]);a.useImperativeHandle(t,()=>({focus:()=>{var V;const k=Rn.current;k===null||!document.contains(k)?(V=ie==null?void 0:ie.current)==null||V.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,V)=>{if(!(ie===void 0||ie.current===null))return It(ie.current,k??0,V??-1)},damage:gr,getMouseArgsForPosition:(k,V,ue)=>{if(!(ie===void 0||ie.current===null))return Ht(ie.current,k,V,ue)}}),[ie,gr,It]);const So=a.useRef(),ni=aa(()=>{var me,te,qe;if(n<50||(se==null?void 0:se.disableAccessibilityTree)===!0)return null;let k=Gr(vt,Ve,n,F,we,Ne);const V=ke?0:-1;!ke&&((me=k[0])==null?void 0:me.sourceIndex)===0&&(k=k.slice(1));const[ue,ce]=((te=A.current)==null?void 0:te.cell)??[],Q=(qe=A.current)==null?void 0:qe.range,oe=k.map(ye=>ye.sourceIndex),he=go(l,Math.min(w,l+r));return ue!==void 0&&ce!==void 0&&!(oe.includes(ue)&&he.includes(ce))&&Ko(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":w+1,"aria-multiselectable":"true","aria-colcount":vt.length+V},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},k.map(ye=>a.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(ye.sourceIndex),"aria-colindex":ye.sourceIndex+1+V,tabIndex:-1,onFocus:Je=>{if(Je.target!==Rn.current)return Ce==null?void 0:Ce([ye.sourceIndex,-1])},key:ye.sourceIndex},ye.title)))),a.createElement("tbody",{role:"rowgroup"},he.map(ye=>a.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(ye),key:ye,"aria-rowindex":ye+2},k.map(Je=>{const $e=Je.sourceIndex,De=kn($e,ye),Xe=ue===$e&&ce===ye,qt=Q!==void 0&&$e>=Q.x&&$e<Q.x+Q.width&&ye>=Q.y&&ye<Q.y+Q.height,kt=`glide-cell-${$e}-${ye}`,Yt=[$e,ye],yn=g(Yt,!0);return a.createElement("td",{key:De,role:"gridcell","aria-colindex":$e+1+V,"aria-selected":qt,"aria-readonly":zo(yn)||!or(yn),id:kt,"data-testid":kt,onClick:()=>{const jt=ie==null?void 0:ie.current;if(jt!=null)return Te==null?void 0:Te({bounds:It(jt,$e,ye),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:Yt})},onFocusCapture:jt=>{var be,yt;if(!(jt.target===Rn.current||((be=So.current)==null?void 0:be[0])===$e&&((yt=So.current)==null?void 0:yt[1])===ye))return So.current=Yt,Ce==null?void 0:Ce(Yt)},ref:Xe?Ko:void 0,tabIndex:-1},$c(yn,J))})))))},[n,vt,Ve,we,Ne,w,l,r,A,Ko,g,ie,Te,It,Ce,F],200),Mo=Pt===0||!N?0:Ve>Pt?1:en(-Ne/100,0,1);let oi=0;U!=null&&U.current&&(oi=((ro=U==null?void 0:U.current)==null?void 0:ro.scrollLeft)+n-((Xt=U==null?void 0:U.current)==null?void 0:Xt.scrollWidth));const B=Ze===0||!N?0:Ve+Gr(vt,Ve,n,F,we,Ne).filter(k=>!k.sticky).length<i.length-Ze?1:en(-oi/100,0,1),Wt=-l*32+He,St=_?en(-Wt/100,0,1):0,ri=a.useMemo(()=>{if(!Mo&&!St&&!B)return null;const k="opacity 0.2s",V={position:"absolute",top:0,left:to[0],width:n-to[0],height:o,opacity:Mo,pointerEvents:"none",transition:Ke?void 0:k,boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},ue={position:"absolute",top:0,right:to[1],width:n-to[1],height:o,opacity:B,pointerEvents:"none",transition:Ke?void 0:k,boxShadow:"inset -13px 0 10px -13px rgba(0, 0, 0, 0.2)"},ce={position:"absolute",top:it,left:0,width:n,height:o,opacity:St,pointerEvents:"none",transition:nt?void 0:k,boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,Mo>0&&a.createElement("div",{id:"shadow-x",style:V}),B>0&&a.createElement("div",{id:"shadow-x",style:ue}),St>0&&a.createElement("div",{id:"shadow-y",style:ce}))},[Mo,St,to,n,Ke,it,o,nt,B]),ii=a.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Go,onKeyUp:kr,onFocus:H,onBlur:D,ref:Sr,style:xo},ni),a.createElement("canvas",{ref:Kt,style:ii}),ri)},Nc=a.memo(a.forwardRef(Oc));function nr(e,t,n,o){return en(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Xc=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,s]=a.useState(),[l,c]=a.useState(),[f,u]=a.useState(!1),[h,w]=a.useState(),[g,m]=a.useState(),[b,v]=a.useState(),[C,x]=a.useState(!1),[H,D]=a.useState(),{onHeaderMenuClick:X,onHeaderIndicatorClick:A,getCellContent:F,onColumnMoved:Y,onColumnResize:z,onColumnResizeStart:N,onColumnResizeEnd:_,gridRef:L,maxColumnWidth:P,minColumnWidth:S,onRowMoved:R,lockColumns:j,onColumnProposeMove:ee,onMouseDown:we,onMouseUp:ke,onItemHovered:Te,onDragStart:$,canvasRef:ae}=e,ie=(z??_??N)!==void 0,{columns:Re,selection:fe}=e,U=fe.columns,xe=a.useCallback(Z=>{const[_e,Ce]=Z.location;i!==void 0&&l!==_e&&_e>=j?(u(!0),c(_e)):g!==void 0&&Ce!==void 0?(x(!0),v(Math.max(0,Ce))):o===void 0&&!f&&!C&&(Te==null||Te(Z))},[i,g,l,Te,j,o,f,C]),et=Y!==void 0,ot=a.useCallback(Z=>{var _e;if(Z.button===0){const[Ce,Ae]=Z.location;if(Z.kind==="out-of-bounds"&&Z.isEdge&&ie){const Oe=(_e=L==null?void 0:L.current)==null?void 0:_e.getBounds(Re.length-1,-1);Oe!==void 0&&(n(Oe.x),r(Re.length-1))}else if(Z.kind==="header"&&Ce>=j){const Oe=ae==null?void 0:ae.current;if(Z.isEdge&&ie&&Oe){n(Z.bounds.x),r(Ce);const Ue=Oe.getBoundingClientRect().width/Oe.offsetWidth,Ke=Z.bounds.width/Ue;N==null||N(Re[Ce],Ke,Ce,Ke+(Re[Ce].growOffset??0))}else Z.kind==="header"&&et&&(w(Z.bounds.x),s(Ce))}else Z.kind==="cell"&&j>0&&Ce===0&&Ae!==void 0&&R!==void 0&&(D(Z.bounds.y),m(Ae))}we==null||we(Z)},[we,ie,j,R,L,Re,et,N,ae]),le=a.useCallback((Z,_e)=>{f||C||X==null||X(Z,_e)},[f,C,X]),Ge=a.useCallback((Z,_e)=>{f||C||A==null||A(Z,_e)},[f,C,A]),tt=a.useRef(-1),at=a.useCallback(()=>{tt.current=-1,m(void 0),v(void 0),D(void 0),x(!1),s(void 0),c(void 0),w(void 0),u(!1),r(void 0),n(void 0)},[]),ze=a.useCallback((Z,_e)=>{if(Z.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Ae of U){if(Ae===o)continue;const Oe=Re[Ae],rt=nr(Oe,tt.current,S,P);z==null||z(Oe,rt,Ae,rt+(Oe.growOffset??0))}const Ce=nr(Re[o],tt.current,S,P);if(_==null||_(Re[o],Ce,o,Ce+(Re[o].growOffset??0)),U.hasIndex(o))for(const Ae of U){if(Ae===o)continue;const Oe=Re[Ae],rt=nr(Oe,tt.current,S,P);_==null||_(Oe,rt,Ae,rt+(Oe.growOffset??0))}}at(),i!==void 0&&l!==void 0&&(ee==null?void 0:ee(i,l))!==!1&&(Y==null||Y(i,l)),g!==void 0&&b!==void 0&&(R==null||R(g,b))}ke==null||ke(Z,_e)},[ke,o,i,l,g,b,U,_,Re,S,P,z,Y,R,at,ee]),Ee=a.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(ee==null?void 0:ee(i,l))!==!1)return{src:i,dest:l}},[i,l,ee]),dt=a.useCallback(Z=>{const _e=ae==null?void 0:ae.current;if(i!==void 0&&h!==void 0)Math.abs(Z.clientX-h)>20&&u(!0);else if(g!==void 0&&H!==void 0)Math.abs(Z.clientY-H)>20&&x(!0);else if(o!==void 0&&t!==void 0&&_e){const Ae=_e.getBoundingClientRect().width/_e.offsetWidth,Oe=(Z.clientX-t)/Ae,rt=Re[o],Ue=nr(rt,Oe,S,P);if(z==null||z(rt,Ue,o,Ue+(rt.growOffset??0)),tt.current=Oe,(U==null?void 0:U.first())===o)for(const Ke of U){if(Ke===o)continue;const nt=Re[Ke],se=nr(nt,tt.current,S,P);z==null||z(nt,se,Ke,se+(nt.growOffset??0))}}},[i,h,g,H,o,t,Re,S,P,z,U,ae]),ut=a.useCallback((Z,_e)=>{if(g===void 0||b===void 0)return F(Z,_e);let[Ce,Ae]=Z;return Ae===b?Ae=g:(Ae>b&&(Ae-=1),Ae>=g&&(Ae+=1)),F([Ce,Ae],_e)},[g,b,F]),je=a.useCallback(Z=>{$==null||$(Z),Z.defaultPrevented()||at()},[at,$]);return a.createElement(Nc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ut,isResizing:o!==void 0,onHeaderMenuClick:le,onHeaderIndicatorClick:Ge,isDragging:f,onItemHovered:xe,onDragStart:je,onMouseDown:ot,allowResize:ie,onMouseUp:ze,dragAndDropState:Ee,onMouseMoveRaw:dt,ref:L})};function Yc(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=s=>{for(const l of s){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Gc=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),s=a.useRef(0),l=a.useRef(t);l.current=t;const c=n.current;a.useEffect(()=>{const f=()=>{var w,g;if(r.current===!1&&c!==null){const m=[c.scrollLeft,c.scrollTop];if(((w=i.current)==null?void 0:w[0])===m[0]&&((g=i.current)==null?void 0:g[1])===m[1])if(s.current>10){i.current=null,r.current=null;return}else s.current++;else s.current=0,l.current(m[0],m[1]),i.current=m;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},h=w=>{w.touches.length===0&&(r.current=!1,s.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const w=c;return w.addEventListener("touchstart",u),w.addEventListener("touchend",h),()=>{w.removeEventListener("touchstart",u),w.removeEventListener("touchend",h),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},_c=()=>e=>e.isSafari?"scroll":"auto",Kc=on("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[_c()]}});function Uc(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return Lt("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Lt("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Vc=e=>{var ie,Re;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:s,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:h,rightElementProps:w,kineticScrollPerfHack:g=!1,scrollRef:m,initialSize:b}=e,v=[],C=(w==null?void 0:w.sticky)??!1,x=(w==null?void 0:w.fill)??!1,H=a.useRef(0),D=a.useRef(0),X=a.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,F=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),Y=a.useRef(null),z=Uc(200),[N,_]=a.useState(!0),L=a.useRef(0);a.useLayoutEffect(()=>{if(!N||z||F.current.lockDirection===void 0)return;const fe=X.current;if(fe===null)return;const[U,xe]=F.current.lockDirection;U!==void 0?fe.scrollLeft=U:xe!==void 0&&(fe.scrollTop=xe),F.current.lockDirection=void 0},[z,N]);const P=a.useCallback((fe,U)=>{var je;const xe=X.current;if(xe===null)return;U=U??xe.scrollTop,fe=fe??xe.scrollLeft;const et=F.current.scrollTop,ot=F.current.scrollLeft,le=fe-ot,Ge=U-et;z&&le!==0&&Ge!==0&&(Math.abs(le)>3||Math.abs(Ge)>3)&&c&&F.current.lockDirection===void 0&&(F.current.lockDirection=Math.abs(le)<Math.abs(Ge)?[ot,void 0]:[void 0,et]);const tt=F.current.lockDirection;fe=(tt==null?void 0:tt[0])??fe,U=(tt==null?void 0:tt[1])??U,F.current.scrollLeft=fe,F.current.scrollTop=U;const at=xe.clientWidth,ze=xe.clientHeight,Ee=U,dt=D.current-Ee,ut=xe.scrollHeight-ze;if(D.current=Ee,ut>0&&(Math.abs(dt)>2e3||Ee===0||Ee===ut)&&o>xe.scrollHeight+5){const Z=Ee/ut,_e=(o-ze)*Z;H.current=_e-Ee}tt!==void 0&&(window.clearTimeout(L.current),_(!1),L.current=window.setTimeout(()=>_(!0),200)),i({x:fe,y:Ee+H.current,width:at-u,height:ze-f,paddingRight:((je=Y.current)==null?void 0:je.clientWidth)??0})},[f,u,o,i,c,z]);Gc(g&&Vr.value,P,X);const S=a.useRef(P);S.current=P;const R=a.useRef(),j=a.useRef(!1);a.useLayoutEffect(()=>{j.current?P():j.current=!0},[P,f,u]);const ee=a.useCallback(fe=>{X.current=fe,m!==void 0&&(m.current=fe)},[m]);let we=0,ke=0;for(v.push(a.createElement("div",{key:we++,style:{width:r,height:0}}));ke<o;){const fe=Math.min(5e6,o-ke);v.push(a.createElement("div",{key:we++,style:{width:0,height:fe}})),ke+=fe}const{ref:Te,width:$,height:ae}=Yc(b);return typeof window<"u"&&(((ie=R.current)==null?void 0:ie.height)!==ae||((Re=R.current)==null?void 0:Re.width)!==$)&&(window.setTimeout(()=>S.current(),0),R.current={width:$,height:ae}),($??0)===0||(ae??0)===0?a.createElement("div",{ref:Te}):a.createElement("div",{ref:Te},a.createElement(Kc,{isSafari:Vr.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:ee,style:R.current,draggable:s,onDragStart:fe=>{s||(fe.stopPropagation(),fe.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>P()},a.createElement("div",{className:"dvn-scroll-inner"+(h===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},v),h!==void 0&&a.createElement(a.Fragment,null,!x&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:Y,style:{height:ae,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:x?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},h))))))},qc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:s,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:h,onVisibleRegionChanged:w,scrollRef:g,preventDiagonalScrolling:m,rightElement:b,rightElementProps:v,overscrollX:C,overscrollY:x,initialSize:H,smoothScrollX:D=!1,smoothScrollY:X=!1,isDraggable:A}=e,{paddingRight:F,paddingBottom:Y}=c??{},[z,N]=u,_=a.useRef(),L=a.useRef(),P=a.useRef(),S=a.useRef(),R=typeof l=="number"?l:l[0],j=f+Math.max(0,C??0);let ee=s?r+i:r;if(typeof o=="number")ee+=n*o;else for(let $=0;$<n;$++)ee+=o($);x!==void 0&&(ee+=x);const we=a.useRef(),ke=a.useCallback(()=>{var tt,at;if(we.current===void 0)return;const $={...we.current};let ae=0,ie=$.x<0?-$.x:0,Re=0,fe=0;$.x=$.x<0?0:$.x;let U=0;for(let ze=0;ze<R;ze++)U+=t[ze].width;for(const ze of t){const Ee=ae-U;if($.x>=Ee+ze.width)ae+=ze.width,fe++,Re++;else if($.x>Ee)ae+=ze.width,D?ie+=Ee-$.x:fe++,Re++;else if($.x+$.width>Ee)ae+=ze.width,Re++;else break}let xe=0,et=0,ot=0;if(typeof o=="number")X?(et=Math.floor($.y/o),xe=et*o-$.y):et=Math.ceil($.y/o),ot=Math.ceil($.height/o)+et,xe<0&&ot++;else{let ze=0;for(let Ee=0;Ee<n;Ee++){const dt=o(Ee),ut=ze+(X?0:dt/2);if($.y>=ze+dt)ze+=dt,et++,ot++;else if($.y>ut)ze+=dt,X?xe+=ut-$.y:et++,ot++;else if($.y+$.height>dt/2+ze)ze+=dt,ot++;else break}}const le={x:fe,y:et,width:Re-fe,height:ot-et},Ge=_.current;(Ge===void 0||Ge.y!==le.y||Ge.x!==le.x||Ge.height!==le.height||Ge.width!==le.width||L.current!==ie||P.current!==xe||$.width!==((tt=S.current)==null?void 0:tt[0])||$.height!==((at=S.current)==null?void 0:at[1]))&&(w==null||w(le,$.width,$.height,$.paddingRight??0,ie,xe),_.current=le,L.current=ie,P.current=xe,S.current=[$.width,$.height])},[t,o,n,w,R,D,X]),Te=a.useCallback($=>{we.current=$,ke()},[ke]);return a.useEffect(()=>{ke()},[ke]),a.createElement(Vc,{scrollRef:g,className:h,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:m,draggable:A===!0||typeof A=="string",scrollWidth:j+(F??0),scrollHeight:ee+(Y??0),clientHeight:N,rightElement:b,paddingBottom:Y,paddingRight:F,rightElementProps:v,update:Te,initialSize:H},a.createElement(Xc,{eventTargetRef:g,width:z,height:N,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},jc=on("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Zc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Jc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Qc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),ed=10,td=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:s,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:h=!1,onSearchClose:w}=e,[g]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[m,b]=a.useState(""),v=s??m,C=a.useCallback($=>{b($),c==null||c($)},[c]),[x,H]=a.useState(),D=a.useRef(x);D.current=x,a.useEffect(()=>{l!==void 0&&(l.length>0?H($=>({rowsSearched:o,results:l.length,selectedIndex:($==null?void 0:$.selectedIndex)??-1})):H(void 0))},[o,l]);const X=a.useRef();X.current===void 0&&(X.current=new AbortController);const A=a.useRef(),[F,Y]=a.useState([]),z=l??F,N=a.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0,X.current.abort())},[]),_=a.useRef(n);_.current=n;const L=a.useCallback($=>{const ae=new RegExp($.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ie=_.current,Re=Math.min(10,o),fe=0;H(void 0),Y([]);const U=[],xe=async()=>{var ut;if(f===void 0)return;const et=performance.now(),ot=o-fe;let le=f({x:0,y:ie,width:r.length,height:Math.min(Re,ot,o-ie)},X.current.signal);typeof le=="function"&&(le=await le());let Ge=!1;for(const[je,Z]of le.entries())for(const[_e,Ce]of Z.entries()){let Ae;switch(Ce.kind){case ne.Text:case ne.Number:Ae=Ce.displayData;break;case ne.Uri:case ne.Markdown:Ae=Ce.data;break;case ne.Boolean:Ae=typeof Ce.data=="boolean"?Ce.data.toString():void 0;break;case ne.Image:case ne.Bubble:Ae=Ce.data.join("🐳");break;case ne.Custom:Ae=Ce.copyData;break}Ae!==void 0&&ae.test(Ae)&&(U.push([_e,je+ie]),Ge=!0)}const tt=performance.now();Ge&&Y([...U]),fe+=le.length,tn(fe<=o);const at=((ut=D.current)==null?void 0:ut.selectedIndex)??-1;H({results:U.length,rowsSearched:fe,selectedIndex:at}),u==null||u(U,at),ie+Re>=o?ie=0:ie+=Re;const ze=tt-et,Ee=Math.max(ze,1),dt=ed/Ee;Re=Math.ceil(Re*dt),fe<o&&U.length<1e3&&(A.current=window.requestAnimationFrame(xe))};N(),A.current=window.requestAnimationFrame(xe)},[N,r.length,f,u,o]),P=a.useCallback(()=>{var $;w==null||w(),H(void 0),Y([]),u==null||u([],-1),N(),($=t==null?void 0:t.current)==null||$.focus()},[N,t,w,u]),S=a.useCallback($=>{C($.target.value),l===void 0&&($.target.value===""?(H(void 0),Y([]),N()):L($.target.value))},[L,N,C,l]);a.useEffect(()=>{h&&i.current!==null&&(C(""),i.current.focus({preventScroll:!0}))},[h,i,C]);const R=a.useCallback($=>{var ie;if((ie=$==null?void 0:$.stopPropagation)==null||ie.call($),x===void 0)return;const ae=(x.selectedIndex+1)%x.results;H({...x,selectedIndex:ae}),u==null||u(z,ae)},[x,u,z]),j=a.useCallback($=>{var ie;if((ie=$==null?void 0:$.stopPropagation)==null||ie.call($),x===void 0)return;let ae=(x.selectedIndex-1)%x.results;ae<0&&(ae+=x.results),H({...x,selectedIndex:ae}),u==null||u(z,ae)},[u,z,x]),ee=a.useCallback($=>{($.ctrlKey||$.metaKey)&&$.nativeEvent.code==="KeyF"||$.key==="Escape"?(P(),$.stopPropagation(),$.preventDefault()):$.key==="Enter"&&($.shiftKey?j():R())},[P,R,j]);a.useEffect(()=>()=>{N()},[N]);const[we,ke]=a.useState(!1);a.useEffect(()=>{if(h)ke(!0);else{const $=setTimeout(()=>ke(!1),150);return()=>clearTimeout($)}},[h]);const Te=a.useMemo(()=>{if(!h&&!we)return null;let $;x!==void 0&&($=x.results>=1e3?"over 1000":`${x.results} result${x.results!==1?"s":""}`,x.selectedIndex>=0&&($=`${x.selectedIndex+1} of ${$}`));const ae=fe=>{fe.stopPropagation()},Re={width:`${Math.floor(((x==null?void 0:x.rowsSearched)??0)/o*100)}%`};return a.createElement(jc,{className:h?"":"out",onMouseDown:ae,onMouseMove:ae,onMouseUp:ae,onClick:ae},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:g,"aria-hidden":!h,"data-testid":"search-input",ref:i,onChange:S,value:v,tabIndex:h?void 0:-1,onKeyDownCapture:ee}),a.createElement("button",{"aria-label":"Previous Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:j,disabled:((x==null?void 0:x.results)??0)===0},Zc),a.createElement("button",{"aria-label":"Next Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:R,disabled:((x==null?void 0:x.results)??0)===0},Jc),w!==void 0&&a.createElement("button",{"aria-label":"Close Search","aria-hidden":!h,"data-testid":"search-close-button",tabIndex:h?void 0:-1,onClick:P},Qc)),x!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},$)),a.createElement("div",{className:"gdg-search-progress",style:Re})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:g},"Type to search")))},[h,we,x,o,g,i,S,v,ee,j,R,w,P]);return a.createElement(a.Fragment,null,a.createElement(qc,{prelightCells:z,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Te)};class nd extends a.PureComponent{constructor(){super(...arguments);We(this,"wrapperRef",a.createRef());We(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("touchend",this.clickOutside,!0),n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("touchend",this.clickOutside,!0),n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return a.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const od=()=>e=>Math.max(16,e.targetHeight-10),rd=on("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[od(),"px"]}}),id=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[s,l]=Ct.useState(n);return Ct.createElement(nd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Ct.createElement(rd,{targetHeight:t.height,"data-testid":"group-rename-input",value:s,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,s.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(s):c.key==="Escape"&&o()},autoFocus:!0}))};function ld(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Pe(e,t,n){const o=cs(e,t);return o&&(n.didMatch=!0),o}function cs(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(cs(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const s=e.split("+"),l=s.pop();if(!ld(l,t))return!1;if(s[0]==="any")return!0;for(const c of s)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":qr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function sd(e,t,n,o,r,i,s){const l=Ct.useCallback((u,h,w,g)=>{var H;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!s&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const m=n==="mixed"&&(w||g==="drag"),b=o==="mixed"&&m,v=r==="mixed"&&m;let C={current:u===void 0?void 0:{...u,rangeStack:g==="drag"?((H=e.current)==null?void 0:H.rangeStack)??[]:[]},columns:b?e.columns:st.empty(),rows:v?e.rows:st.empty()};w&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,h)},[o,e,n,i,s,r,t]),c=Ct.useCallback((u,h,w)=>{u=u??e.rows,h!==void 0&&(u=u.add(h));let g;if(r==="exclusive"&&u.length>0)g={current:void 0,columns:st.empty(),rows:u};else{const m=w&&n==="mixed",b=w&&o==="mixed";g={current:m?e.current:void 0,columns:b?e.columns:st.empty(),rows:u}}t(g,!1)},[o,e,n,r,t]),f=Ct.useCallback((u,h,w)=>{u=u??e.columns,h!==void 0&&(u=u.add(h));let g;if(o==="exclusive"&&u.length>0)g={current:void 0,rows:st.empty(),columns:u};else{const m=w&&n==="mixed",b=w&&r==="mixed";g={current:m?e.current:void 0,rows:b?e.rows:st.empty(),columns:u}}t(g,!1)},[o,e,n,r,t]);return[l,c,f]}function ad(e,t,n,o,r){const i=a.useCallback(f=>{if(e===!0){const u=[];for(let h=f.y;h<f.y+f.height;h++){const w=[];for(let g=f.x;g<f.x+f.width;g++)g<0||h>=r?w.push({kind:ne.Loading,allowOverlay:!1}):w.push(t([g,h]));u.push(w)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),s=e!==void 0?i:void 0,l=a.useCallback(f=>{if(s===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const h=s(u,o.signal);return typeof h=="function"?async()=>(await h()).map(w=>[{kind:ne.Loading,allowOverlay:!1},...w]):h.map(w=>[{kind:ne.Loading,allowOverlay:!1},...w])}return s(u,o.signal)},[o.signal,s,n]);return[e!==void 0?l:void 0,s]}function cd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case ne.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Fi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ne.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ne.Image:case ne.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ne.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ne.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ne.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ne.Markdown:case ne.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ne.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ne.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ne.Protected:return{formatted:"************",rawValue:"",format:"string"};default:sr()}}function dd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(s=>s.span!==void 0&&s.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:cd(s))})}function Cl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function ud(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(s=>Cl(s,!0)).join(",")):r.push(Cl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ci(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function xl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function fd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function hd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ci(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((s,l)=>`<li gdg-raw-value=${xl(r.rawValue[l])}>`+Ci(s)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${xl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ci(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function gd(e,t){const n=dd(e,t),o=ud(n),r=hd(n);return{textPlain:o,textHtml:r}}function kl(e){var s;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,h=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",w=c.querySelectorAll("br");for(const b of w)b.replaceWith(`
`);const g=c.getAttribute("gdg-raw-value"),m=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((s=c.querySelector("a"))==null?void 0:s.getAttribute("href"))??"",formatted:c.textContent??"",format:m});else if(c.querySelector("ol")!==null){const b=c.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...b].map(v=>v.textContent??""),format:"string-array"})}else if(g!==null)i==null||i.push({rawValue:fd(g),formatted:c.textContent??"",format:m});else{let b=c.textContent??"";h&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:m})}}}return i!==void 0&&r.push(i),r}function md(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let s=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const w=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w);const g=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g)}else{const w=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}let u=c.x-n,h=c.x+c.width-1-n;for(const w of f)for(const g of w)g.span!==void 0&&(u=Math.min(g.span[0],u),h=Math.max(g.span[1],h));u===c.x-n&&h===c.x+c.width-1-n?s=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:h-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!s);return e}function Sl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function wd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let s=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,s)),r=s+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Sl(e.slice(r,s))),r=s+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}s++}return r<e.length&&o.push(Sl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Ml(e,t,n){var l;const o=gd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},s=(c,f)=>{var u,h;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(h=n==null?void 0:n.clipboardData)==null||h.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?s(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function ds(e){return e!==!0}function Rl(e){return typeof e=="string"?e:`${e}px`}const bd=()=>e=>e.innerWidth,yd=()=>e=>e.innerHeight,pd=on("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[bd()],"wmyidgi-1":[yd()]}}),vd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(pd,{innerHeight:Rl(n),innerWidth:Rl(t),...r},o)},Cd=2,xd=1300;function kd(e,t,n){const o=Ct.useRef(0),[r,i]=e??[0,0];Ct.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let s=!1,l=0;const c=f=>{var u;if(!s){if(l===0)l=f;else{const h=f-l;o.current=Math.min(1,o.current+h/xd);const w=o.current**1.618*h*Cd;(u=t.current)==null||u.scrollBy(r*w,i*w),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{s=!0}},[t,r,i,n])}function Sd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:s,remSize:l}){const[c,f,u,h,w,g]=Ct.useMemo(()=>{if(!s||l===16)return[e,t,n,o,r,i];const m=l/16,b=e,v=ql();return[typeof b=="number"?b*m:C=>Math.ceil(b(C)*m),Math.ceil(t*m),Math.ceil(n*m),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??v.headerIconSize)*m,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??v.cellHorizontalPadding)*m,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??v.cellVerticalPadding)*m},Math.ceil((r??0)*m),Math.ceil((i??0)*m)]},[n,t,r,i,l,e,s,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:h,overscrollX:w,overscrollY:g}}const qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Be(e,t){return e===!0?t:e===!1?"":e}function El(e){const t=qr.value;return{activateCell:Be(e.activateCell," |Enter|shift+Enter"),clear:Be(e.clear,"any+Escape"),closeOverlay:Be(e.closeOverlay,"any+Escape"),acceptOverlayDown:Be(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Be(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Be(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Be(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Be(e.delete,t?"Backspace|Delete":"Delete"),downFill:Be(e.downFill,"primary+_68"),scrollToSelectedCell:Be(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Be(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Be(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Be(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Be(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Be(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Be(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Be(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Be(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Be(e.goToFirstCell,"primary+Home"),goToFirstColumn:Be(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Be(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Be(e.goToLastCell,"primary+End"),goToLastColumn:Be(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Be(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Be(e.goToNextPage,"PageDown"),goToPreviousPage:Be(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Be(e.rightFill,"primary+_82"),search:Be(e.search,"primary+f"),selectAll:Be(e.selectAll,"primary+a"),selectColumn:Be(e.selectColumn,"ctrl+ "),selectGrowDown:Be(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Be(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Be(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Be(e.selectGrowUp,"shift+ArrowUp"),selectRow:Be(e.selectRow,"shift+ "),selectToFirstCell:Be(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Be(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Be(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Be(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Be(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Be(e.selectToLastRow,"primary+shift+ArrowDown")}}function Md(e){const t=ha(e);return Ct.useMemo(()=>{if(t===void 0)return El(qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??qn.selectToLastCell};return El({...qn,...n})},[t])}function Rd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const s={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(s.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),s}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function $i(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let h=0;h<l.subGroups.length;h++){const w=h<l.subGroups.length-1?l.subGroups[h+1].headerIndex:c;o(l.subGroups[h],w,f||l.isCollapsed)}}const r=Rd(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,s=0;for(const l of n)l.contentIndex=s,s+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function Di(e,t){if(t===void 0||$i.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Ed(e,t,n,o){const r=Ct.useMemo(()=>e===void 0?void 0:$i(e,t),[e,t]),i=Ct.useMemo(()=>r==null?void 0:r.reduce((u,h)=>(u[h.rowIndex]=h,u),{}),[r]),s=Ct.useMemo(()=>r===void 0?t:r.reduce((u,h)=>u+(h.isCollapsed?1:h.rows+1),0),[r,t]),l=Ct.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=Ct.useCallback(u=>{if(r===void 0)return u;let h=u;for(const w of r){if(h===0)return;if(h--,!w.isCollapsed){if(h<w.rows)return w.contentIndex+h;h-=w.rows}}return u},[r]),f=jn(o??(e==null?void 0:e.themeOverride),Ct.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:h,contentIndex:w,groupIndex:g}=Di(u,r);return h?e.themeOverride:o==null?void 0:o(u,g,w)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:s,rowNumberMapper:c,getRowThemeOverride:f}}function Id(e,t){const n=Ct.useMemo(()=>e===void 0?void 0:$i(e,t),[e,t]);return{getRowGroupingForPath:fs,updateRowGroupingByPath:us,mapper:Ct.useCallback(o=>{if(typeof o=="number")return Di(o,n);const r=Di(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function us(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,s)=>s===o?{...i,...n}:i):e.map((i,s)=>s===o?{...i,subGroups:us(i.subGroups??[],r,n)}:i)}function fs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:fs(e[n].subGroups??[],o)}function Dd(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Fd(e,t,n,o,r){const[i,s]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:s}),[o,s,i]),[c,f,u]=fa(l),h=a.useRef(r);h.current=r;const w=Dd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),g=(c.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&w.current!==null&&g){if(w.current.scrollTop===t)return;w.current.scrollTop=t,w.current.scrollTop!==t&&u(),h.current()}},[t,g,u,w]);const m=(c.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&w.current!==null&&m){if(w.current.scrollLeft===e)return;w.current.scrollLeft=e,w.current.scrollLeft!==e&&u(),h.current()}},[e,m,u,w]),{visibleRegion:c,setVisibleRegion:f,scrollRef:w}}const Hd=a.lazy(async()=>await Hl(()=>import("./data-grid-overlay-editor-BX12Laym.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));let Td=0;function Ad(e){return ea(ol(ol(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return go((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Nr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Xr={kind:ne.Loading,allowOverlay:!1},Yr={columns:st.empty(),rows:st.empty(),current:void 0},zd=(e,t)=>{var el,tl,nl;const[n,o]=a.useState(Yr),[r,i]=a.useState(),s=a.useRef(null),l=a.useRef(null),[c,f]=a.useState(),u=a.useRef(),h=typeof window>"u"?null:window,{imageEditorOverride:w,getRowThemeOverride:g,markdownDivCreateNode:m,width:b,height:v,columns:C,rows:x,getCellContent:H,onCellClicked:D,onCellActivated:X,onFillPattern:A,onFinishedEditing:F,coercePasteValue:Y,drawHeader:z,drawCell:N,editorBloom:_,onHeaderClicked:L,onColumnProposeMove:P,rangeSelectionColumnSpanning:S=!0,spanRangeBehavior:R="default",onGroupHeaderClicked:j,onCellContextMenu:ee,className:we,onHeaderContextMenu:ke,getCellsForSelection:Te,onGroupHeaderContextMenu:$,onGroupHeaderRenamed:ae,onCellEdited:ie,onCellsEdited:Re,onSearchResultsChanged:fe,searchResults:U,onSearchValueChange:xe,searchValue:et,onKeyDown:ot,onKeyUp:le,keybindings:Ge,editOnType:tt=!0,onRowAppended:at,onColumnMoved:ze,validateCell:Ee,highlightRegions:dt,rangeSelect:ut="rect",columnSelect:je="multi",rowSelect:Z="multi",rangeSelectionBlending:_e="exclusive",columnSelectionBlending:Ce="exclusive",rowSelectionBlending:Ae="exclusive",onDelete:Oe,onDragStart:rt,onMouseMove:Ue,onPaste:Ke,copyHeaders:nt=!1,freezeColumns:se=0,cellActivationBehavior:J="second-click",rowSelectionMode:Mt="auto",onHeaderMenuClick:Ne,onHeaderIndicatorClick:He,getGroupDetails:Pt,rowGrouping:Ze,onSearchClose:Ve,onItemHovered:Fe,onSelectionCleared:ht,showSearch:Nt,onVisibleRegionChanged:Tt,gridSelection:Ft,onGridSelectionChange:xt,minColumnWidth:rn=50,maxColumnWidth:Bt=500,maxColumnAutoWidth:eo,provideEditor:wn,trailingRowOptions:Se,freezeTrailingRows:Rt=0,allowedFillDirections:ct="orthogonal",scrollOffsetX:Kt,scrollOffsetY:bn,verticalBorder:zt,onDragOverCell:ln,onDrop:Bn,onColumnResize:Le,onColumnResizeEnd:gt,onColumnResizeStart:it,customRenderers:Zt,fillHandle:Ut,experimental:ft,fixedShadowX:vt,fixedShadowY:to,headerIcons:It,imageWindowLoader:Ht,initialSize:Hn,isDraggable:dr,onDragLeave:Wn,onRowMoved:Jt,overscrollX:Tn,overscrollY:yo,preventDiagonalScrolling:ur,rightElement:fr,rightElementProps:po,trapFocus:no=!1,smoothScrollX:vo,smoothScrollY:Co,scaleToRem:oo=!1,rowHeight:$n=34,headerHeight:hr=36,groupHeaderHeight:gr=hr,theme:Qr,isOutsideClick:ei,renderers:On,resizeIndicator:Nn,scrollToActiveCell:mr=!0,drawFocusRing:wr=!0,portalElementRef:br}=e,No=wr==="no-editor"?r===void 0:wr,mt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,sn=(mt==null?void 0:mt.kind)??e.rowMarkers??"none",yr=(mt==null?void 0:mt.width)??e.rowMarkerWidth,xo=(mt==null?void 0:mt.startIndex)??e.rowMarkerStartIndex??1,Xo=(mt==null?void 0:mt.theme)??e.rowMarkerTheme,ko=mt==null?void 0:mt.headerTheme,An=mt==null?void 0:mt.headerAlwaysVisible,zn=Z!=="multi",Xn=(mt==null?void 0:mt.checkboxStyle)??"square",an=Math.max(rn,20),Yn=Math.max(Bt,an),pr=Math.max(eo??Yn,an),cn=typeof se=="number"?se:se[0],Vt=typeof se=="number"?0:se[1],vr=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ie,rowNumberMapper:Yo,rowHeight:Cr,getRowThemeOverride:dn}=Ed(Ze,x,$n,g),xr=a.useMemo(()=>Number.parseFloat(vr.fontSize),[vr]),{rowHeight:Sn,headerHeight:Go,groupHeaderHeight:kr,theme:Sr,overscrollX:ti,overscrollY:_o}=Sd({groupHeaderHeight:gr,headerHeight:hr,overscrollX:Tn,overscrollY:yo,remSize:xr,rowHeight:Cr,scaleToRem:oo,theme:Qr}),Mn=Md(Ge),Gn=yr??(x>1e4?48:x>1e3?44:x>100?36:32),un=sn!=="none",E=un?1:0,bt=at!==void 0,Rn=(Se==null?void 0:Se.sticky)===!0,[Ko,So]=a.useState(!1),ni=Nt??Ko,Mo=a.useCallback(()=>{Ve!==void 0?Ve():So(!1)},[Ve]),B=a.useMemo(()=>Ft===void 0?void 0:Nr(Ft,E),[Ft,E])??n,Wt=a.useRef();Wt.current===void 0&&(Wt.current=new AbortController),a.useEffect(()=>()=>Wt==null?void 0:Wt.current.abort(),[]);const[St,ri]=ad(Te,H,E,Wt.current,Ie),ii=a.useCallback((d,y,p)=>{if(Ee===void 0)return!0;const M=[d[0]-E,d[1]];return Ee==null?void 0:Ee(M,y,p)},[E,Ee]),ro=a.useRef(Ft),Xt=a.useCallback((d,y)=>{y&&(d=md(d,St,E,R,Wt.current)),xt!==void 0?(ro.current=Nr(d,-E),xt(ro.current)):o(d)},[xt,St,E,R]),k=jn(Le,a.useCallback((d,y,p,M)=>{Le==null||Le(C[p-E],y,p-E,M)},[Le,E,C])),V=jn(gt,a.useCallback((d,y,p,M)=>{gt==null||gt(C[p-E],y,p-E,M)},[gt,E,C])),ue=jn(it,a.useCallback((d,y,p,M)=>{it==null||it(C[p-E],y,p-E,M)},[it,E,C])),ce=jn(z,a.useCallback((d,y)=>(z==null?void 0:z({...d,columnIndex:d.columnIndex-E},y))??!1,[z,E])),Q=jn(N,a.useCallback((d,y)=>(N==null?void 0:N({...d,col:d.col-E},y))??!1,[N,E])),oe=a.useCallback(d=>{if(Oe!==void 0){const y=Oe(Nr(d,-E));return typeof y=="boolean"?y:Nr(y,E)}return!0},[Oe,E]),[he,me,te]=sd(B,Xt,_e,Ce,Ae,ut,S),qe=a.useMemo(()=>Pn(ql(),Sr),[Sr]),[ye,Je]=a.useState([0,0,0]),$e=a.useMemo(()=>{if(On===void 0)return{};const d={};for(const y of On)d[y.kind]=y;return d},[On]),De=a.useCallback(d=>d.kind!==ne.Custom?$e[d.kind]:Zt==null?void 0:Zt.find(y=>y.isMatch(d)),[Zt,$e]);let{sizedColumns:Xe,nonGrowWidth:qt}=Wa(C,Ie,ri,ye[0]-(E===0?0:Gn)-ye[2],an,pr,qe,De,Wt.current);sn!=="none"&&(qt+=Gn);const kt=a.useMemo(()=>Xe.some(d=>d.group!==void 0),[Xe]),Yt=kt?Go+kr:Go,yn=B.rows.length,jt=sn==="none"?void 0:yn===0?!1:yn===Ie?!0:void 0,be=a.useMemo(()=>sn==="none"?Xe:[{title:"",width:Gn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Xo,rowMarker:Xn,rowMarkerChecked:jt,headerRowMarkerTheme:ko,headerRowMarkerAlwaysVisible:An,headerRowMarkerDisabled:zn},...Xe],[sn,Xe,Gn,Xo,Xn,jt,ko,An,zn]),yt=a.useRef({height:1,width:1,x:0,y:0}),Gt=a.useRef(!1),{setVisibleRegion:_n,visibleRegion:$t,scrollRef:lt}=Fd(Kt,bn,Sn,yt,()=>Gt.current=!0);yt.current=$t;const io=$t.x+E,Mr=$t.y,At=a.useRef(null),_t=a.useCallback(d=>{var y;d===!0?(y=At.current)==null||y.focus():window.requestAnimationFrame(()=>{var p;(p=At.current)==null||p.focus()})},[]),Ot=bt?Ie+1:Ie,fn=a.useCallback(d=>{const y=E===0?d:d.map(M=>({...M,location:[M.location[0]-E,M.location[1]]})),p=Re==null?void 0:Re(y);if(p!==!0)for(const M of y)ie==null||ie(M.location,M.value);return p},[ie,Re,E]),[lo,li]=a.useState(),Rr=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,Ro=No?(el=B.current)==null?void 0:el.cell:void 0,Er=Ro==null?void 0:Ro[0],Ir=Ro==null?void 0:Ro[1],ws=a.useMemo(()=>{if((dt===void 0||dt.length===0)&&(Rr??Er??Ir??lo)===void 0)return;const d=[];if(dt!==void 0)for(const y of dt){const p=be.length-y.range.x-E;p>0&&d.push({color:y.color,range:{...y.range,x:y.range.x+E,width:Math.min(p,y.range.width)},style:y.style})}return lo!==void 0&&d.push({color:wo(qe.accentColor,0),range:lo,style:"dashed"}),Rr!==void 0&&d.push({color:wo(qe.accentColor,.5),range:Rr,style:"solid-outline"}),Er!==void 0&&Ir!==void 0&&d.push({color:qe.accentColor,range:{x:Er,y:Ir,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[lo,Rr,Er,Ir,dt,be.length,qe.accentColor,E]),Oi=a.useRef(be);Oi.current=be;const Qt=a.useCallback(([d,y],p=!1)=>{var O,T,W,G,K,q,ge;const M=bt&&y===Ot-1;if(d===0&&un){if(M)return Xr;const re=Yo(y);return re===void 0?Xr:{kind:mn.Marker,allowOverlay:!1,checkboxStyle:Xn,checked:(B==null?void 0:B.rows.hasIndex(y))===!0,markerKind:sn==="clickable-number"?"number":sn,row:xo+re,drawHandle:Jt!==void 0,cursor:sn==="clickable-number"?"pointer":void 0}}else if(M){const ve=d===E?(Se==null?void 0:Se.hint)??"":"",de=Oi.current[d];if(((O=de==null?void 0:de.trailingRowOptions)==null?void 0:O.disabled)===!0)return Xr;{const Ye=((T=de==null?void 0:de.trailingRowOptions)==null?void 0:T.hint)??ve,Me=((W=de==null?void 0:de.trailingRowOptions)==null?void 0:W.addIcon)??(Se==null?void 0:Se.addIcon);return{kind:mn.NewRow,hint:Ye,allowOverlay:!1,icon:Me}}}else{const re=d-E;if(p||(ft==null?void 0:ft.strict)===!0){const de=yt.current,Ye=de.x>re||re>de.x+de.width||de.y>y||y>de.y+de.height||y>=ai.current,Me=re===((K=(G=de.extras)==null?void 0:G.selected)==null?void 0:K[0])&&y===((q=de.extras)==null?void 0:q.selected[1]);let pe=!1;if(((ge=de.extras)==null?void 0:ge.freezeRegions)!==void 0){for(const Qe of de.extras.freezeRegions)if(mo(Qe,re,y)){pe=!0;break}}if(Ye&&!Me&&!pe)return Xr}let ve=H([re,y]);return E!==0&&ve.span!==void 0&&(ve={...ve,span:[ve.span[0]+E,ve.span[1]+E]}),ve}},[bt,Ot,un,Yo,Xn,B==null?void 0:B.rows,sn,xo,Jt,E,Se==null?void 0:Se.hint,Se==null?void 0:Se.addIcon,ft==null?void 0:ft.strict,H]),si=a.useCallback(d=>{let y=(Pt==null?void 0:Pt(d))??{name:d};return ae!==void 0&&d!==""&&(y={icon:y.icon,name:y.name,overrideTheme:y.overrideTheme,actions:[...y.actions??[],{title:"Rename",icon:"renameIcon",onClick:p=>di({group:y.name,bounds:p.bounds})}]}),y},[Pt,ae]),Dr=a.useCallback(d=>{var W;const[y,p]=d.cell,M=be[y],I=(M==null?void 0:M.group)!==void 0?(W=si(M.group))==null?void 0:W.overrideTheme:void 0,O=M==null?void 0:M.themeOverride,T=dn==null?void 0:dn(p);i({...d,theme:Pn(qe,I,O,T,d.content.themeOverride)})},[dn,be,si,qe]),Eo=a.useCallback((d,y,p)=>{var T;if(B.current===void 0)return;const[M,I]=B.current.cell,O=Qt([M,I]);if(O.kind!==ne.Boolean&&O.allowOverlay){let W=O;if(p!==void 0)switch(W.kind){case ne.Number:{const G=na(()=>p==="-"?-0:Number.parseFloat(p),0);W={...W,data:Number.isNaN(G)?0:G};break}case ne.Text:case ne.Markdown:case ne.Uri:W={...W,data:p};break}Dr({target:d,content:W,initialValue:p,cell:[M,I],highlight:p===void 0,forceEditMode:p!==void 0})}else O.kind===ne.Boolean&&y&&O.readonly!==!0&&(fn([{location:B.current.cell,value:{...O,data:ds(O.data)}}]),(T=At.current)==null||T.damage([{cell:B.current.cell}]))},[Qt,B,fn,Dr]),Ni=a.useCallback((d,y)=>{var I;const p=(I=At.current)==null?void 0:I.getBounds(d,y);if(p===void 0||lt.current===null)return;const M=Qt([d,y]);M.allowOverlay&&Dr({target:p,content:M,initialValue:void 0,highlight:!0,cell:[d,y],forceEditMode:!0})},[Qt,lt,Dr]),Et=a.useCallback((d,y,p="both",M=0,I=0,O=void 0)=>{if(lt.current!==null){const T=At.current,W=l.current,G=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,K=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,q=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ge=typeof y!="number"&&y.unit==="px"?y.amount:void 0;if(T!==null&&W!==null){let re={x:0,y:0,width:0,height:0},ve=0,de=0;if((G!==void 0||K!==void 0)&&(re=T.getBounds((G??0)+E,K??0)??re,re.width===0||re.height===0))return;const Ye=W.getBoundingClientRect(),Me=Ye.width/W.offsetWidth;if(q!==void 0&&(re={...re,x:q-Ye.left-lt.current.scrollLeft,width:1}),ge!==void 0&&(re={...re,y:ge+Ye.top-lt.current.scrollTop,height:1}),re!==void 0){const pe={x:re.x-M,y:re.y-I,width:re.width+2*M,height:re.height+2*I};let Qe=0;for(let fo=0;fo<cn;fo++)Qe+=Xe[fo].width;let pt=0;for(let fo=Xe.length-1;fo>=Xe.length-1-Vt;fo--)pt+=Xe[fo].width;let Dt=0;const uo=Rt+(Rn?1:0);uo>0&&(Dt=bo(Ot,uo,Sn));let Cn=Qe*Me+Ye.left+E*Gn*Me,In=Ye.right-pt*Me,xn=Ye.top+Yt*Me,To=Ye.bottom-Dt*Me;const Pr=re.width+M*2;switch(O==null?void 0:O.hAlign){case"start":In=Cn+Pr;break;case"end":Cn=In-Pr;break;case"center":Cn=Math.floor((Cn+In)/2)-Pr/2,In=Cn+Pr;break}const Br=re.height+I*2;switch(O==null?void 0:O.vAlign){case"start":To=xn+Br;break;case"end":xn=To-Br;break;case"center":xn=Math.floor((xn+To)/2)-Br/2,To=xn+Br;break}Cn>pe.x?ve=pe.x-Cn:In<pe.x+pe.width&&(ve=pe.x+pe.width-In),xn>pe.y?de=pe.y-xn:To<pe.y+pe.height&&(de=pe.y+pe.height-To),p==="vertical"||typeof d=="number"&&(d<cn||d>=be.length-Vt)?ve=0:(p==="horizontal"||typeof y=="number"&&y>=Ot-uo)&&(de=0),(ve!==0||de!==0)&&(Me!==1&&(ve/=Me,de/=Me),lt.current.scrollTo({left:ve+lt.current.scrollLeft,top:de+lt.current.scrollTop,behavior:(O==null?void 0:O.behavior)??"auto"}))}}}},[E,Rt,Gn,lt,Yt,cn,Vt,be.length,Xe,Ot,Rn,Sn]),Xi=a.useRef(Ni),Yi=a.useRef(H),ai=a.useRef(Ie);Xi.current=Ni,Yi.current=H,ai.current=Ie;const Io=a.useCallback(async(d,y=!0,p)=>{var K;const M=be[d];if(((K=M==null?void 0:M.trailingRowOptions)==null?void 0:K.disabled)===!0)return;const I=at==null?void 0:at();let O,T=!0;I!==void 0&&(O=await I,O==="top"&&(T=!1),typeof O=="number"&&(T=!1));let W=0;const G=()=>{if(ai.current<=Ie){W<500&&window.setTimeout(G,W),W=50+W*2;return}const q=typeof O=="number"?O:T?Ie:0;Lr.current(d-E,q,"both",0,0,p?{behavior:p}:void 0),he({cell:[d,q],range:{x:d,y:q,width:1,height:1}},!1,!1,"edit");const ge=Yi.current([d-E,q]);ge.allowOverlay&&or(ge)&&ge.readonly!==!0&&y&&window.setTimeout(()=>{Xi.current(d,q)},0)};G()},[be,at,E,Ie,he]),Fr=a.useCallback(d=>{var p,M;const y=((M=(p=Xe[d])==null?void 0:p.trailingRowOptions)==null?void 0:M.targetColumn)??(Se==null?void 0:Se.targetColumn);if(typeof y=="number")return y+(un?1:0);if(typeof y=="object"){const I=C.indexOf(y);if(I>=0)return I+(un?1:0)}},[Xe,C,un,Se==null?void 0:Se.targetColumn]),Kn=a.useRef(),Do=a.useRef(),Uo=a.useCallback((d,y)=>{var I;const[p,M]=y;return Pn(qe,(I=be[p])==null?void 0:I.themeOverride,dn==null?void 0:dn(M),d.themeOverride)},[dn,be,qe]),{mapper:so}=Id(Ze,x),pn=Ze==null?void 0:Ze.navigationBehavior,Vo=a.useCallback(d=>{var q,ge,re;const y=qr.value?d.metaKey:d.ctrlKey,p=y&&Z==="multi",M=y&&je==="multi",[I,O]=d.location,T=B.columns,W=B.rows,[G,K]=((q=B.current)==null?void 0:q.cell)??[];if(d.kind==="cell"){if(Do.current=void 0,ao.current=[I,O],I===0&&un){if(bt===!0&&O===Ie||sn==="number"||Z==="none")return;const ve=Qt(d.location);if(ve.kind!==mn.Marker)return;if(Jt!==void 0){const Me=De(ve);tn((Me==null?void 0:Me.kind)===mn.Marker);const pe=(ge=Me==null?void 0:Me.onClick)==null?void 0:ge.call(Me,{...d,cell:ve,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Uo(ve,d.location),preventDefault:()=>{}});if(pe===void 0||pe.checked===ve.checked)return}i(void 0),_t();const de=W.hasIndex(O),Ye=Kn.current;if(Z==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Ye!==void 0&&W.hasIndex(Ye)){const Me=[Math.min(Ye,O),Math.max(Ye,O)+1];p||Mt==="multi"?me(void 0,Me,!0):me(st.fromSingleSelection(Me),void 0,p)}else Z==="multi"&&(p||d.isTouch||Mt==="multi")?de?me(W.remove(O),void 0,!0):(me(void 0,O,!0),Kn.current=O):de&&W.length===1?me(st.empty(),void 0,y):(me(st.fromSingleSelection(O),void 0,y),Kn.current=O)}else if(I>=E&&bt&&O===Ie){const ve=Fr(I);Io(ve??I)}else if(G!==I||K!==O){const ve=Qt(d.location),de=De(ve);if((de==null?void 0:de.onSelect)!==void 0){let pe=!1;if(de.onSelect({...d,cell:ve,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>pe=!0,theme:Uo(ve,d.location)}),pe)return}if(pn==="block"&&so(O).isGroupHeader)return;const Ye=Rn&&O===Ie,Me=Rn&&B!==void 0&&((re=B.current)==null?void 0:re.cell[1])===Ie;if((d.shiftKey||d.isLongTouch===!0)&&G!==void 0&&K!==void 0&&B.current!==void 0&&!Me){if(Ye)return;const pe=Math.min(I,G),Qe=Math.max(I,G),pt=Math.min(O,K),Dt=Math.max(O,K);he({...B.current,range:{x:pe,y:pt,width:Qe-pe+1,height:Dt-pt+1}},!0,y,"click"),Kn.current=void 0,_t()}else he({cell:[I,O],range:{x:I,y:O,width:1,height:1}},!0,y,"click"),Kn.current=void 0,i(void 0),_t()}}else if(d.kind==="header")if(ao.current=[I,O],i(void 0),un&&I===0)Kn.current=void 0,Do.current=void 0,Z==="multi"&&(W.length!==Ie?me(st.fromSingleSelection([0,Ie]),void 0,y):me(st.empty(),void 0,y),_t());else{const ve=Do.current;if(je==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ve!==void 0&&T.hasIndex(ve)){const de=[Math.min(ve,I),Math.max(ve,I)+1];M?te(void 0,de,y):te(st.fromSingleSelection(de),void 0,y)}else M?(T.hasIndex(I)?te(T.remove(I),void 0,y):te(void 0,I,y),Do.current=I):je!=="none"&&(T.hasIndex(I)?te(T.remove(I),void 0,y):te(st.fromSingleSelection(I),void 0,y),Do.current=I);Kn.current=void 0,_t()}else d.kind===gn?ao.current=[I,O]:d.kind===jr&&!d.isMaybeScrollbar&&(Xt(Yr,!1),i(void 0),_t(),ht==null||ht(),Kn.current=void 0,Do.current=void 0)},[Z,je,B,un,E,bt,Ie,sn,Qt,Jt,_t,Mt,De,Uo,me,Fr,Io,pn,so,Rn,he,te,Xt,ht]),qo=a.useRef(!1),ao=a.useRef(),Gi=a.useRef($t),hn=a.useRef(),bs=a.useCallback(d=>{if(Fo.current=!1,Gi.current=yt.current,d.button!==0&&d.button!==1){hn.current=void 0;return}const y=performance.now();hn.current={button:d.button,time:y,location:d.location},(d==null?void 0:d.kind)==="header"&&(qo.current=!0);const p=d.kind==="cell"&&d.isFillHandle;!p&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:B,fillHandle:p}),ao.current=void 0,!d.isTouch&&d.button===0&&!p?Vo(d):!d.isTouch&&d.button===1&&(ao.current=d.location))},[B,Vo]),[ci,di]=a.useState(),_i=a.useCallback(d=>{if(d.kind!==gn||je!=="multi")return;const y=qr.value?d.metaKey:d.ctrlKey,[p]=d.location,M=B.columns;if(p<E)return;const I=be[p];let O=p,T=p;for(let W=p-1;W>=E&&Wo(I.group,be[W].group);W--)O--;for(let W=p+1;W<be.length&&Wo(I.group,be[W].group);W++)T++;if(_t(),y)if(M.hasAll([O,T+1])){let W=M;for(let G=O;G<=T;G++)W=W.remove(G);te(W,void 0,y)}else te(void 0,[O,T+1],y);else te(st.fromSingleSelection([O,T+1]),void 0,y)},[je,_t,B.columns,be,E,te]),Fo=a.useRef(!1),Hr=a.useCallback(async d=>{if(St!==void 0&&k!==void 0){const y=yt.current.y,p=yt.current.height;let M=St({x:d,y,width:1,height:Math.min(p,Ie-y)},Wt.current.signal);typeof M!="object"&&(M=await M());const I=Xe[d-E],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=qe.baseFontFull;const W=Zl(T,qe,I,0,M,an,Yn,!1,De);k==null||k(I,W.width,d,W.width)}}},[Xe,St,Yn,qe,an,k,E,Ie,De]),[ys,ui]=a.useState(),Ho=a.useCallback(async(d,y)=>{var W,G;const p=(W=d.current)==null?void 0:W.range;if(p===void 0||St===void 0||y.current===void 0)return;const M=y.current.range;if(A!==void 0){let K=!1;if(A({fillDestination:{...M,x:M.x-E},patternSource:{...p,x:p.x-E},preventDefault:()=>K=!0}),K)return}let I=St(p,Wt.current.signal);typeof I!="object"&&(I=await I());const O=I,T=[];for(let K=0;K<M.width;K++)for(let q=0;q<M.height;q++){const ge=[M.x+K,M.y+q];if($l(ge,p))continue;const re=O[q%p.height][K%p.width];zo(re)||!or(re)||T.push({location:ge,value:{...re}})}fn(T),(G=At.current)==null||G.damage(T.map(K=>({cell:K.location})))},[St,fn,A,E]),Ki=a.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Ho(d,B)},[Ho,B]),Ui=a.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Ho(d,B)},[Ho,B]),ps=a.useCallback((d,y)=>{var q,ge;const p=c;if(f(void 0),li(void 0),ui(void 0),qo.current=!1,y)return;if((p==null?void 0:p.fillHandle)===!0&&B.current!==void 0&&((q=p.previousSelection)==null?void 0:q.current)!==void 0){if(lo===void 0)return;const re={...B,current:{...B.current,range:ns(p.previousSelection.current.range,lo)}};Ho(p.previousSelection,re),Xt(re,!0);return}const[M,I]=d.location,[O,T]=ao.current??[],W=()=>{Fo.current=!0},G=re=>{var de,Ye,Me;const ve=re.isTouch||O===M&&T===I;if(ve&&(D==null||D([M-E,I],{...re,preventDefault:W})),re.button===1)return!Fo.current;if(!Fo.current){const pe=Qt(d.location),Qe=De(pe);if(Qe!==void 0&&Qe.onClick!==void 0&&ve){const Dt=Qe.onClick({...re,cell:pe,posX:re.localEventX,posY:re.localEventY,bounds:re.bounds,theme:Uo(pe,d.location),preventDefault:W});Dt!==void 0&&!zo(Dt)&&Ao(Dt)&&(fn([{location:re.location,value:Dt}]),(de=At.current)==null||de.damage([{cell:re.location}]))}if(Fo.current||B.current===void 0)return!1;let pt=!1;switch(pe.activationBehaviorOverride??J){case"double-click":case"second-click":{if(((Me=(Ye=p==null?void 0:p.previousSelection)==null?void 0:Ye.current)==null?void 0:Me.cell)===void 0)break;const[Dt,uo]=B.current.cell,[Cn,In]=p.previousSelection.current.cell;pt=M===Dt&&M===Cn&&I===uo&&I===In&&(re.isDoubleClick===!0||J==="second-click");break}case"single-click":{pt=!0;break}}if(pt)return X==null||X([M-E,I]),Eo(re.bounds,!1),!0}return!1},K=d.location[0]-E;if(d.isTouch){const re=yt.current,ve=Gi.current;if(re.x!==ve.x||re.y!==ve.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&rr((ge=B.current)==null?void 0:ge.cell,d.location)){ee==null||ee([K,d.location[1]],{...d,preventDefault:W});return}else if(d.kind==="header"&&B.columns.hasIndex(M)){ke==null||ke(K,{...d,preventDefault:W});return}else if(d.kind===gn){if(K<0)return;$==null||$(K,{...d,preventDefault:W});return}}d.kind==="cell"?G(d)||Vo(d):d.kind===gn?j==null||j(K,{...d,preventDefault:W}):(d.kind===Zn&&(L==null||L(K,{...d,preventDefault:W})),Vo(d));return}if(d.kind==="header"){if(K<0)return;d.isEdge?d.isDoubleClick===!0&&Hr(M):d.button===0&&M===O&&I===T&&(L==null||L(K,{...d,preventDefault:W}))}if(d.kind===gn){if(K<0)return;d.button===0&&M===O&&I===T&&(j==null||j(K,{...d,preventDefault:W}),Fo.current||_i(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&G(d),ao.current=void 0},[c,B,E,lo,Ho,Xt,D,Qt,De,J,Uo,fn,X,Eo,ee,ke,$,Vo,j,L,Hr,_i]),vs=a.useCallback(d=>{const y={...d,location:[d.location[0]-E,d.location[1]]};Ue==null||Ue(y),c!==void 0&&d.buttons===0&&(f(void 0),li(void 0),ui(void 0),qo.current=!1),ui(p=>{var M;return qo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(p==null?void 0:p[0])&&d.scrollEdge[1]===p[1]?p:c===void 0||(((M=hn.current)==null?void 0:M.location[0])??0)<E?void 0:d.scrollEdge})},[c,Ue,E]),Cs=a.useCallback((d,y)=>{Ne==null||Ne(d-E,y)},[Ne,E]),xs=a.useCallback((d,y)=>{He==null||He(d-E,y)},[He,E]),En=(tl=B==null?void 0:B.current)==null?void 0:tl.cell,ks=a.useCallback((d,y,p,M,I,O)=>{Gt.current=!1;let T=En;T!==void 0&&(T=[T[0]-E,T[1]]);const W=cn===0?void 0:{x:0,y:d.y,width:cn,height:d.height},G=Vt===0?void 0:{x:Xe.length-Vt,y:d.y,width:Vt,height:d.height},K=[];W!==void 0&&K.push(W),G!==void 0&&K.push(G),Rt>0&&(K.push({x:d.x-E,y:Ie-Rt,width:d.width,height:Rt}),cn>0&&K.push({x:0,y:Ie-Rt,width:cn,height:Rt}),Vt>0&&K.push({x:Xe.length-Vt,y:Ie-Rt,width:Vt,height:Rt}));const q={x:d.x-E,y:d.y,width:d.width,height:bt&&d.y+d.height>=Ie?d.height-1:d.height,tx:I,ty:O,extras:{selected:T,freezeRegion:W,freezeRegions:K}};yt.current=q,_n(q),Je([y,p,M]),Tt==null||Tt(q,q.tx,q.ty,q.extras)},[En,E,bt,Ie,cn,Vt,Xe.length,Rt,_n,Tt]),Ss=jn(P,a.useCallback((d,y)=>(P==null?void 0:P(d-E,y-E))!==!1,[P,E])),Ms=jn(ze,a.useCallback((d,y)=>{ze==null||ze(d-E,y-E),je!=="none"&&te(st.fromSingleSelection(y),void 0,!0)},[je,ze,E,te])),fi=a.useRef(!1),Rs=a.useCallback(d=>{if(d.location[0]===0&&E>0){d.preventDefault();return}rt==null||rt({...d,location:[d.location[0]-E,d.location[1]]}),d.defaultPrevented()||(fi.current=!0),f(void 0)},[rt,E]),Es=a.useCallback(()=>{fi.current=!1},[]),Vi=Ze==null?void 0:Ze.selectionBehavior,Tr=a.useCallback(d=>{if(Vi!=="block-spanning")return;const{isGroupHeader:y,path:p,groupRows:M}=so(d);if(y)return[d,d];const I=p[p.length-1],O=d-I,T=d+M-I-1;return[O,T]},[so,Vi]),hi=a.useRef(),gi=a.useCallback(d=>{var y,p,M;if(!as(d,hi.current)&&(hi.current=d,!(((y=hn==null?void 0:hn.current)==null?void 0:y.button)!==void 0&&hn.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((p=hn.current)==null?void 0:p.location[0])===0&&d.location[0]===0&&E===1&&Z==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(hn.current.location[1])&&B.rows.hasIndex(hn.current.location[1])){const I=Math.min(hn.current.location[1],d.location[1]),O=Math.max(hn.current.location[1],d.location[1])+1;me(st.fromSingleSelection([I,O]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!fi.current&&!qo.current&&(ut==="rect"||ut==="multi-rect")){const[I,O]=B.current.cell;let[T,W]=d.location;if(W<0&&(W=yt.current.y),c.fillHandle===!0&&((M=c.previousSelection)==null?void 0:M.current)!==void 0){const G=c.previousSelection.current.range;W=Math.min(W,bt?Ie-1:Ie);const K=wc(G,T,W,ct);li(K)}else{if(bt&&O===Ie)return;if(bt&&W===Ie)if(d.kind===jr)W--;else return;T=Math.max(T,E);const q=Tr(O);W=q===void 0?W:en(W,q[0],q[1]);const ge=T-I,re=W-O,ve={x:ge>=0?I:T,y:re>=0?O:W,width:Math.abs(ge)+1,height:Math.abs(re)+1};he({...B.current,range:ve},!0,!1,"drag")}}Fe==null||Fe({...d,location:[d.location[0]-E,d.location[1]]})}},[c,E,Z,B,ut,Fe,me,bt,Ie,ct,Tr,he]),Is=a.useCallback(()=>{var T,W;const d=hi.current;if(d===void 0)return;const[y,p]=d.scrollEdge;let[M,I]=d.location;const O=yt.current;y===-1?M=((W=(T=O.extras)==null?void 0:T.freezeRegion)==null?void 0:W.x)??O.x:y===1&&(M=O.x+O.width),p===-1?I=Math.max(0,O.y):p===1&&(I=Math.min(Ie-1,O.y+O.height)),M=en(M,0,be.length-1),I=en(I,0,Ie-1),gi({...d,location:[M,I]})},[be.length,gi,Ie]);kd(ys,lt,Is);const vn=a.useCallback(d=>{if(B.current===void 0)return;const[y,p]=d,[M,I]=B.current.cell,O=B.current.range;let T=O.x,W=O.x+O.width,G=O.y,K=O.y+O.height;const[q,ge]=Tr(I)??[0,Ie-1],re=ge+1;if(p!==0)switch(p){case 2:{K=re,G=I,Et(0,K,"vertical");break}case-2:{G=q,K=I+1,Et(0,G,"vertical");break}case 1:{G<I?(G++,Et(0,G,"vertical")):(K=Math.min(re,K+1),Et(0,K,"vertical"));break}case-1:{K>I+1?(K--,Et(0,K,"vertical")):(G=Math.max(q,G-1),Et(0,G,"vertical"));break}default:sr()}if(y!==0)if(y===2)W=be.length,T=M,Et(W-1-E,0,"horizontal");else if(y===-2)T=E,W=M+1,Et(T-E,0,"horizontal");else{let ve=[];if(St!==void 0){const de=St({x:T,y:G,width:W-T-E,height:K-G},Wt.current.signal);typeof de=="object"&&(ve=Ad(de))}if(y===1){let de=!1;if(T<M){if(ve.length>0){const Ye=go(T+1,M+1).find(Me=>!ve.includes(Me-E));Ye!==void 0&&(T=Ye,de=!0)}else T++,de=!0;de&&Et(T,0,"horizontal")}de||(W=Math.min(be.length,W+1),Et(W-1-E,0,"horizontal"))}else if(y===-1){let de=!1;if(W>M+1){if(ve.length>0){const Ye=go(W-1,M,-1).find(Me=>!ve.includes(Me-E));Ye!==void 0&&(W=Ye,de=!0)}else W--,de=!0;de&&Et(W-E,0,"horizontal")}de||(T=Math.max(E,T-1),Et(T-E,0,"horizontal"))}else sr()}he({cell:B.current.cell,range:{x:T,y:G,width:W-T,height:K-G}},!0,!1,"keyboard-select")},[St,Tr,B,be.length,E,Ie,Et,he]),mi=a.useRef(mr);mi.current=mr;const Un=a.useCallback((d,y,p,M)=>{const I=Ot-(p?0:1);d=en(d,E,Xe.length-1+E),y=en(y,0,I);const O=En==null?void 0:En[0],T=En==null?void 0:En[1];if(d===O&&y===T)return!1;if(M&&B.current!==void 0){const W=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&W.push(B.current.range),Xt({...B,current:{cell:[d,y],range:{x:d,y,width:1,height:1},rangeStack:W}},!0)}else he({cell:[d,y],range:{x:d,y,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===y&&(u.current=void 0),mi.current&&Et(d-E,y),!0},[Ot,E,Xe.length,En,B,Et,Xt,he]),Ds=a.useCallback((d,y)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Ao(d)&&(fn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var I;(I=At.current)==null||I.damage([{cell:r.cell}])})),_t(!0),i(void 0);const[p,M]=y;if(B.current!==void 0&&(p!==0||M!==0)){const I=B.current.cell[1]===Ot-1&&d!==void 0;Un(en(B.current.cell[0]+p,0,be.length-1),en(B.current.cell[1]+M,0,Ot-1),I,!1)}F==null||F(d,y)},[r==null?void 0:r.cell,_t,B,F,fn,Ot,Un,be.length]),Fs=a.useMemo(()=>`gdg-overlay-${Td++}`,[]),co=a.useCallback(d=>{var p,M,I,O;_t();const y=[];for(let T=d.x;T<d.x+d.width;T++)for(let W=d.y;W<d.y+d.height;W++){const G=H([T-E,W]);if(!G.allowOverlay&&G.kind!==ne.Boolean)continue;let K;if(G.kind===ne.Custom){const q=De(G),ge=(p=q==null?void 0:q.provideEditor)==null?void 0:p.call(q,G);(q==null?void 0:q.onDelete)!==void 0?K=q.onDelete(G):oa(ge)&&(K=(M=ge==null?void 0:ge.deletedValue)==null?void 0:M.call(ge,G))}else if(Ao(G)&&G.allowOverlay||G.kind===ne.Boolean){const q=De(G);K=(I=q==null?void 0:q.onDelete)==null?void 0:I.call(q,G)}K!==void 0&&!zo(K)&&Ao(K)&&y.push({location:[T,W],value:K})}fn(y),(O=At.current)==null||O.damage(y.map(T=>({cell:T.location})))},[_t,H,De,fn,E]),jo=r!==void 0,qi=a.useCallback(d=>{var Ye,Me;const y=()=>{d.stopPropagation(),d.preventDefault()},p={didMatch:!1},{bounds:M}=d,I=B.columns,O=B.rows,T=Mn;if(!jo&&Pe(T.clear,d,p))Xt(Yr,!1),ht==null||ht();else if(!jo&&Pe(T.selectAll,d,p))Xt({columns:st.empty(),rows:st.empty(),current:{cell:((Ye=B.current)==null?void 0:Ye.cell)??[E,0],range:{x:E,y:0,width:C.length,height:Ie},rangeStack:[]}},!1);else if(Pe(T.search,d,p))(Me=s==null?void 0:s.current)==null||Me.focus({preventScroll:!0}),So(!0);else if(Pe(T.delete,d,p)){const pe=(oe==null?void 0:oe(B))??!0;if(pe!==!1){const Qe=pe===!0?B:pe;if(Qe.current!==void 0){co(Qe.current.range);for(const pt of Qe.current.rangeStack)co(pt)}for(const pt of Qe.rows)co({x:E,y:pt,width:C.length,height:1});for(const pt of Qe.columns)co({x:pt,y:0,width:1,height:Ie})}}if(p.didMatch)return y(),!0;if(B.current===void 0)return!1;let[W,G]=B.current.cell;const[,K]=B.current.cell;let q=!1,ge=!1;if(Pe(T.scrollToSelectedCell,d,p)?Lr.current(W-E,G):je!=="none"&&Pe(T.selectColumn,d,p)?I.hasIndex(W)?te(I.remove(W),void 0,!0):je==="single"?te(st.fromSingleSelection(W),void 0,!0):te(void 0,W,!0):Z!=="none"&&Pe(T.selectRow,d,p)?O.hasIndex(G)?me(O.remove(G),void 0,!0):Z==="single"?me(st.fromSingleSelection(G),void 0,!0):me(void 0,G,!0):!jo&&M!==void 0&&Pe(T.activateCell,d,p)?G===Ie&&bt?window.setTimeout(()=>{const pe=Fr(W);Io(pe??W)},0):(X==null||X([W-E,G]),Eo(M,!0)):B.current.range.height>1&&Pe(T.downFill,d,p)?Ui():B.current.range.width>1&&Pe(T.rightFill,d,p)?Ki():Pe(T.goToNextPage,d,p)?G+=Math.max(1,yt.current.height-4):Pe(T.goToPreviousPage,d,p)?G-=Math.max(1,yt.current.height-4):Pe(T.goToFirstCell,d,p)?(i(void 0),G=0,W=0):Pe(T.goToLastCell,d,p)?(i(void 0),G=Number.MAX_SAFE_INTEGER,W=Number.MAX_SAFE_INTEGER):Pe(T.selectToFirstCell,d,p)?(i(void 0),vn([-2,-2])):Pe(T.selectToLastCell,d,p)?(i(void 0),vn([2,2])):jo?(Pe(T.closeOverlay,d,p)&&i(void 0),Pe(T.acceptOverlayDown,d,p)&&(i(void 0),G++),Pe(T.acceptOverlayUp,d,p)&&(i(void 0),G--),Pe(T.acceptOverlayLeft,d,p)&&(i(void 0),W--),Pe(T.acceptOverlayRight,d,p)&&(i(void 0),W++)):(Pe(T.goDownCell,d,p)?G+=1:Pe(T.goUpCell,d,p)?G-=1:Pe(T.goRightCell,d,p)?W+=1:Pe(T.goLeftCell,d,p)?W-=1:Pe(T.goDownCellRetainSelection,d,p)?(G+=1,q=!0):Pe(T.goUpCellRetainSelection,d,p)?(G-=1,q=!0):Pe(T.goRightCellRetainSelection,d,p)?(W+=1,q=!0):Pe(T.goLeftCellRetainSelection,d,p)?(W-=1,q=!0):Pe(T.goToLastRow,d,p)?G=Ie-1:Pe(T.goToFirstRow,d,p)?G=Number.MIN_SAFE_INTEGER:Pe(T.goToLastColumn,d,p)?W=Number.MAX_SAFE_INTEGER:Pe(T.goToFirstColumn,d,p)?W=Number.MIN_SAFE_INTEGER:(ut==="rect"||ut==="multi-rect")&&(Pe(T.selectGrowDown,d,p)?vn([0,1]):Pe(T.selectGrowUp,d,p)?vn([0,-1]):Pe(T.selectGrowRight,d,p)?vn([1,0]):Pe(T.selectGrowLeft,d,p)?vn([-1,0]):Pe(T.selectToLastRow,d,p)?vn([0,2]):Pe(T.selectToFirstRow,d,p)?vn([0,-2]):Pe(T.selectToLastColumn,d,p)?vn([2,0]):Pe(T.selectToFirstColumn,d,p)&&vn([-2,0])),ge=p.didMatch),pn!==void 0&&pn!=="normal"&&G!==K){const pe=pn==="skip-up"||pn==="skip"||pn==="block",Qe=pn==="skip-down"||pn==="skip"||pn==="block",pt=G<K;if(pt&&pe){for(;G>=0&&so(G).isGroupHeader;)G--;G<0&&(G=K)}else if(!pt&&Qe){for(;G<Ie&&so(G).isGroupHeader;)G++;G>=Ie&&(G=K)}}const ve=Un(W,G,!1,q),de=p.didMatch;return de&&(ve||!ge||no)&&y(),de},[pn,jo,B,Mn,je,Z,ut,E,so,Ie,Un,Xt,ht,C.length,oe,no,co,te,me,bt,Fr,Io,X,Eo,Ui,Ki,vn]),Zo=a.useCallback(d=>{let y=!1;if(ot!==void 0&&ot({...d,...d.location&&{location:[d.location[0]-E,d.location[1]]},cancel:()=>{y=!0}}),y||qi(d)||B.current===void 0)return;const[p,M]=B.current.cell,I=yt.current;if(tt&&!d.metaKey&&!d.ctrlKey&&B.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&or(H([p-E,Math.max(0,Math.min(M,Ie-1))]))){if((!bt||M!==Ie)&&(I.y>M||M>I.y+I.height||I.x>p||p>I.x+I.width))return;Eo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[tt,ot,qi,B,H,E,Ie,bt,Eo]),Hs=a.useCallback((d,y)=>{const p=d.location[0]-E;if(d.kind==="header"&&(ke==null||ke(p,{...d,preventDefault:y})),d.kind===gn){if(p<0)return;$==null||$(p,{...d,preventDefault:y})}if(d.kind==="cell"){const[M,I]=d.location;ee==null||ee([p,I],{...d,preventDefault:y}),xa(B,d.location)||Un(M,I,!1,!1)}},[B,ee,$,ke,E,Un]),wi=a.useCallback(async d=>{var T,W,G;if(!Mn.paste)return;function y(K,q,ge,re){var de,Ye;const ve=typeof ge=="object"?(ge==null?void 0:ge.join(`
`))??"":(ge==null?void 0:ge.toString())??"";if(!zo(K)&&or(K)&&K.readonly!==!0){const Me=Y==null?void 0:Y(ve,K);if(Me!==void 0&&Ao(Me))return{location:q,value:Me};const pe=De(K);if(pe===void 0)return;if(pe.kind===ne.Custom){tn(K.kind===ne.Custom);const Qe=(de=pe.onPaste)==null?void 0:de.call(pe,ve,K.data);return Qe===void 0?void 0:{location:q,value:{...K,data:Qe}}}else{const Qe=(Ye=pe.onPaste)==null?void 0:Ye.call(pe,ve,K,{formatted:re,formattedString:typeof re=="string"?re:re==null?void 0:re.join(`
`),rawValue:ge});return Qe===void 0?void 0:(tn(Qe.kind===K.kind),{location:q,value:Qe})}}}const p=B.columns,M=B.rows,I=((T=lt.current)==null?void 0:T.contains(document.activeElement))===!0||((W=l.current)==null?void 0:W.contains(document.activeElement))===!0;let O;if(B.current!==void 0?O=[B.current.range.x,B.current.range.y]:p.length===1?O=[p.first()??0,0]:M.length===1&&(O=[E,M.first()??0]),I&&O!==void 0){let K,q;const ge="text/plain",re="text/html";if(navigator.clipboard.read!==void 0){const Me=await navigator.clipboard.read();for(const pe of Me){if(pe.types.includes(re)){const pt=await(await pe.getType(re)).text(),Dt=kl(pt);if(Dt!==void 0){K=Dt;break}}pe.types.includes(ge)&&(q=await(await pe.getType(ge)).text())}}else if(navigator.clipboard.readText!==void 0)q=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(re)){const Me=d.clipboardData.getData(re);K=kl(Me)}K===void 0&&d.clipboardData.types.includes(ge)&&(q=d.clipboardData.getData(ge))}else return;const[ve,de]=O,Ye=[];do{if(Ke===void 0){const Me=Qt(O),pe=q??(K==null?void 0:K.map(pt=>pt.map(Dt=>Dt.rawValue).join("	")).join("	"))??"",Qe=y(Me,O,pe,void 0);Qe!==void 0&&Ye.push(Qe);break}if(K===void 0){if(q===void 0)return;K=wd(q)}if(Ke===!1||typeof Ke=="function"&&(Ke==null?void 0:Ke([O[0]-E,O[1]],K.map(Me=>Me.map(pe=>{var Qe;return((Qe=pe.rawValue)==null?void 0:Qe.toString())??""}))))!==!0)return;for(const[Me,pe]of K.entries()){if(Me+de>=Ie)break;for(const[Qe,pt]of pe.entries()){const Dt=[Qe+ve,Me+de],[uo,Cn]=Dt;if(uo>=be.length||Cn>=Ot)continue;const In=Qt(Dt),xn=y(In,Dt,pt.rawValue,pt.formatted);xn!==void 0&&Ye.push(xn)}}}while(!1);fn(Ye),(G=At.current)==null||G.damage(Ye.map(Me=>({cell:Me.location})))}},[Y,De,Qt,B,Mn.paste,lt,be.length,fn,Ot,Ke,E,Ie]);Lt("paste",wi,h,!1,!0);const Jo=a.useCallback(async(d,y)=>{var T,W;if(!Mn.copy)return;const p=y===!0||((T=lt.current)==null?void 0:T.contains(document.activeElement))===!0||((W=l.current)==null?void 0:W.contains(document.activeElement))===!0,M=B.columns,I=B.rows,O=(G,K)=>{if(!nt)Ml(G,K,d);else{const q=K.map(ge=>({kind:ne.Text,data:C[ge].title,displayData:C[ge].title,allowOverlay:!1}));Ml([q,...G],K,d)}};if(p&&St!==void 0){if(B.current!==void 0){let G=St(B.current.range,Wt.current.signal);typeof G!="object"&&(G=await G()),O(G,go(B.current.range.x-E,B.current.range.x+B.current.range.width-E))}else if(I!==void 0&&I.length>0){const K=[...I].map(q=>{const ge=St({x:E,y:q,width:C.length,height:1},Wt.current.signal);return typeof ge=="object"?ge[0]:ge().then(re=>re[0])});if(K.some(q=>q instanceof Promise)){const q=await Promise.all(K);O(q,go(C.length))}else O(K,go(C.length))}else if(M.length>0){const G=[],K=[];for(const q of M){let ge=St({x:q,y:0,width:1,height:Ie},Wt.current.signal);typeof ge!="object"&&(ge=await ge()),G.push(ge),K.push(q-E)}if(G.length===1)O(G[0],K);else{const q=G.reduce((ge,re)=>ge.map((ve,de)=>[...ve,...re[de]]));O(q,K)}}}},[C,St,B,Mn.copy,E,lt,Ie,nt]);Lt("copy",Jo,h,!1,!1);const Ts=a.useCallback(async d=>{var p,M;if(!(!Mn.cut||!(((p=lt.current)==null?void 0:p.contains(document.activeElement))===!0||((M=l.current)==null?void 0:M.contains(document.activeElement))===!0))&&(await Jo(d),B.current!==void 0)){let I={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:st.empty(),columns:st.empty()};const O=oe==null?void 0:oe(I);if(O===!1||(I=O===!0?I:O,I.current===void 0))return;co(I.current.range)}},[co,B,Mn.cut,Jo,lt,oe]);Lt("cut",Ts,h,!1,!1);const As=a.useCallback((d,y)=>{if(fe!==void 0){E!==0&&(d=d.map(I=>[I[0]-E,I[1]])),fe(d,y);return}if(d.length===0||y===-1)return;const[p,M]=d[y];u.current!==void 0&&u.current[0]===p&&u.current[1]===M||(u.current=[p,M],Un(p,M,!1,!1))},[fe,E,Un]),[Ar,zr]=((nl=Ft==null?void 0:Ft.current)==null?void 0:nl.cell)??[],Lr=a.useRef(Et);Lr.current=Et,a.useLayoutEffect(()=>{var d,y,p,M;mi.current&&!Gt.current&&Ar!==void 0&&zr!==void 0&&(Ar!==((y=(d=ro.current)==null?void 0:d.current)==null?void 0:y.cell[0])||zr!==((M=(p=ro.current)==null?void 0:p.current)==null?void 0:M.cell[1]))&&Lr.current(Ar,zr),Gt.current=!1},[Ar,zr]);const ji=B.current!==void 0&&(B.current.cell[0]>=be.length||B.current.cell[1]>=Ot);a.useLayoutEffect(()=>{ji&&Xt(Yr,!1)},[ji,Xt]);const zs=a.useMemo(()=>bt===!0&&(Se==null?void 0:Se.tint)===!0?st.fromSingleSelection(Ot-1):st.empty(),[Ot,bt,Se==null?void 0:Se.tint]),Ls=a.useCallback(d=>typeof zt=="boolean"?zt:(zt==null?void 0:zt(d-E))??!0,[E,zt]),Ps=a.useMemo(()=>{if(ci===void 0||l.current===null)return null;const{bounds:d,group:y}=ci,p=l.current.getBoundingClientRect();return a.createElement(id,{bounds:d,group:y,canvasBounds:p,onClose:()=>di(void 0),onFinish:M=>{di(void 0),ae==null||ae(y,M)}})},[ae,ci]),Bs=Math.min(be.length,cn+(un?1:0));a.useImperativeHandle(t,()=>({appendRow:(d,y)=>Io(d+E,y),updateCells:d=>{var y;return E!==0&&(d=d.map(p=>({cell:[p.cell[0]+E,p.cell[1]]}))),(y=At.current)==null?void 0:y.damage(d)},getBounds:(d,y)=>{var p;if(!((l==null?void 0:l.current)===null||(lt==null?void 0:lt.current)===null)){if(d===void 0&&y===void 0){const M=l.current.getBoundingClientRect(),I=M.width/lt.current.clientWidth;return{x:M.x-lt.current.scrollLeft*I,y:M.y-lt.current.scrollTop*I,width:lt.current.scrollWidth*I,height:lt.current.scrollHeight*I}}return(p=At.current)==null?void 0:p.getBounds((d??0)+E,y)}},focus:()=>{var d;return(d=At.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Jo(void 0,!0);break;case"paste":await wi();break}},scrollTo:Et,remeasureColumns:d=>{for(const y of d)Hr(y+E)},getMouseArgsForPosition:(d,y,p)=>{if((At==null?void 0:At.current)===null)return;const M=At.current.getMouseArgsForPosition(d,y,p);if(M!==void 0)return{...M,location:[M.location[0]-E,M.location[1]]}}}),[Io,Hr,lt,Jo,Zo,wi,E,Et]);const[Zi,Ji]=En??[],Ws=a.useCallback(d=>{const[y,p]=d;if(p===-1){je!=="none"&&(te(st.fromSingleSelection(y),void 0,!1),_t());return}Zi===y&&Ji===p||(he({cell:d,range:{x:y,y:p,width:1,height:1}},!0,!1,"keyboard-nav"),Et(y,p))},[je,_t,Et,Zi,Ji,he,te]),[$s,Os]=a.useState(!1),Qi=a.useRef(Tl(d=>{Os(d)},5)),Ns=a.useCallback(()=>{Qi.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&he({cell:[E,Mr],range:{x:E,y:Mr,width:1,height:1}},!0,!1,"keyboard-select")},[Mr,B,c,E,he]),Xs=a.useCallback(()=>{Qi.current(!1)},[]),[Ys,Gs]=a.useMemo(()=>{let d;const y=(ft==null?void 0:ft.scrollbarWidthOverride)??Mi(),p=Ie+(bt?1:0);if(typeof Sn=="number")d=Yt+p*Sn;else{let I=0;const O=Math.min(p,10);for(let T=0;T<O;T++)I+=Sn(T);I=Math.floor(I/O),d=Yt+p*I}d+=y;const M=be.reduce((I,O)=>O.width+I,0)+y;return[`${Math.min(1e5,M)}px`,`${Math.min(1e5,d)}px`]},[be,ft==null?void 0:ft.scrollbarWidthOverride,Sn,Ie,bt,Yt]),_s=a.useMemo(()=>Pa(qe),[qe]);return a.createElement(jl.Provider,{value:qe},a.createElement(vd,{style:_s,className:we,inWidth:b??Ys,inHeight:v??Gs},a.createElement(td,{fillHandle:Ut,drawFocusRing:No,experimental:ft,fixedShadowX:vt,fixedShadowY:to,getRowThemeOverride:dn,headerIcons:It,imageWindowLoader:Ht,initialSize:Hn,isDraggable:dr,onDragLeave:Wn,onRowMoved:Jt,overscrollX:ti,overscrollY:_o,preventDiagonalScrolling:ur,rightElement:fr,rightElementProps:po,smoothScrollX:vo,smoothScrollY:Co,className:we,enableGroups:kt,onCanvasFocused:Ns,onCanvasBlur:Xs,canvasRef:l,onContextMenu:Hs,theme:qe,cellXOffset:io,cellYOffset:Mr,accessibilityHeight:$t.height,onDragEnd:Es,columns:be,nonGrowWidth:qt,drawHeader:ce,onColumnProposeMove:Ss,drawCell:Q,disabledRows:zs,freezeColumns:[Bs,Vt],lockColumns:E,firstColAccessible:E===0,getCellContent:Qt,minColumnWidth:an,maxColumnWidth:Yn,searchInputRef:s,showSearch:ni,onSearchClose:Mo,highlightRegions:ws,getCellsForSelection:St,getGroupDetails:si,headerHeight:Go,isFocused:$s,groupHeaderHeight:kt?kr:0,freezeTrailingRows:Rt+(bt&&(Se==null?void 0:Se.sticky)===!0?1:0),hasAppendRow:bt,onColumnResize:k,onColumnResizeEnd:V,onColumnResizeStart:ue,onCellFocused:Ws,onColumnMoved:Ms,onDragStart:Rs,onHeaderMenuClick:Cs,onHeaderIndicatorClick:xs,onItemHovered:gi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:vs,onKeyDown:Zo,onKeyUp:le,onMouseDown:bs,onMouseUp:ps,onDragOverCell:ln,onDrop:Bn,onSearchResultsChanged:As,onVisibleRegionChanged:ks,clientSize:ye,rowHeight:Sn,searchResults:U,searchValue:et,onSearchValueChange:xe,rows:Ot,scrollRef:lt,selection:B,translateX:$t.tx,translateY:$t.ty,verticalBorder:Ls,gridRef:At,getCellRenderer:De,resizeIndicator:Nn}),Ps,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(Hd,{...r,validateCell:ii,bloom:_,id:Fs,getCellRenderer:De,className:(ft==null?void 0:ft.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:wn,imageEditorOverride:w,portalElementRef:br,onFinishEditing:Ds,markdownDivCreateNode:m,isOutsideClick:ei,customEventTarget:ft==null?void 0:ft.eventTarget}))))},Ld=a.forwardRef(zd),hs=20;function Il(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:s,height:l,x:c,y:f}=r,u=t.maxSize??hs,h=Math.floor(r.y+l/2),w=Pl(u,l,i.cellVerticalPadding),g=Ll(t.contentAlign??"center",c,s,i.cellHorizontalPadding,w),m=zl(g,h,w),b=Bl(c+n,f+o,m);return Hi(t)&&b}const Pd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ne.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Bd(e,e.cell.data,Hi(e.cell),e.cell.maxSize??hs,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Il(e)&&e.preventDefault()},onClick:e=>{if(Il(e))return{...e.cell,data:ds(e.cell.data)}},onPaste:(e,t)=>{let n=Kr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Fi),n===t.data?void 0:{...t,data:n}}};function Bd(e,t,n,o,r){if(!n&&t===Kr)return;const{ctx:i,hoverAmount:s,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:h,cell:{contentAlign:w}}=e,{x:g,y:m,width:b,height:v}=c;let C=!1;if(r>0){let x=n?1-r+r*s:.4;if(t===Kr&&(x*=s),x===0)return;x<1&&(C=!0,i.globalAlpha=x)}Bi(i,l,t,g,m,b,v,f,u,h,o,w),C&&(i.globalAlpha=1)}const Wd=on("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),$d=e=>{const{bubbles:t}=e;return a.createElement(Wd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"boe-bubble"},n)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Od={getAccessibilityString:e=>Wl(e.data),kind:ne.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Nd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement($d,{bubbles:t.data})},onPaste:()=>{}};function Nd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:s,y:l,width:c,height:f}=n;let u=s+o.cellHorizontalPadding;const h=[];for(const w of t){if(u>s+c)break;const g=Oo(w,r,o.baseFontFull).width;h.push({x:u,width:g}),u+=g+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const w of h)Fn(r,w.x,l+(f-o.bubbleHeight)/2,w.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[w,g]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[w],g.x+o.bubblePadding,l+f/2+Jn(r,o))}const Xd=on("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Yd=e=>{const{drilldowns:t}=e;return a.createElement(Xd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},Gd={getAccessibilityString:e=>Wl(e.data.map(t=>t.text)),kind:ne.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Kd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Yd,{drilldowns:t.data})},onPaste:()=>{}},xi={};function _d(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,s=n-i*2,l=4,c=n*r,f=o+i,u=o*3,h=(u+i*2)*r,w=`${e},${t},${r},${n}`;if(xi[w]!==void 0)return{el:xi[w],height:c,width:h,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const g=document.createElement("canvas"),m=g.getContext("2d");return m===null?null:(g.width=h,g.height=c,m.scale(r,r),xi[w]=g,m.beginPath(),Fn(m,i,i,u,s,o),m.shadowColor="rgba(24, 25, 34, 0.4)",m.shadowBlur=1,m.fillStyle=e,m.fill(),m.shadowColor="rgba(24, 25, 34, 0.3)",m.shadowOffsetY=1,m.shadowBlur=5,m.fillStyle=e,m.fill(),m.shadowOffsetY=0,m.shadowBlur=0,m.shadowBlur=0,m.beginPath(),Fn(m,i+.5,i+.5,u,s,o),m.strokeStyle=t,m.lineWidth=1,m.stroke(),{el:g,height:c,width:h,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Kd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:s,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,h=_l(r,u),w=Math.min(n.height,Math.max(16,Math.ceil(h*o.lineHeight)*2)),g=Math.floor(n.y+(n.height-w)/2),m=w-10,b=o.bubblePadding,v=o.bubbleMargin;let C=c+o.cellHorizontalPadding;const x=o.roundingRadius??6,H=_d(o.bgCell,o.drilldownBorder,w,x),D=[];for(const X of t){if(C>c+f)break;const F=Oo(X.text,r,u).width;let Y=0;X.img!==void 0&&i.loadOrGetImage(X.img,s,l)!==void 0&&(Y=m-8+4);const z=F+Y+b*2;D.push({x:C,width:z}),C+=z+v}if(H!==null){const{el:X,height:A,middleWidth:F,sideWidth:Y,width:z,dpr:N,padding:_}=H,L=Y/N,P=_/N;for(const S of D){const R=Math.floor(S.x),j=Math.floor(S.width),ee=j-(L-P)*2;r.imageSmoothingEnabled=!1,r.drawImage(X,0,0,Y,A,R-P,g,L,w),ee>0&&r.drawImage(X,Y,0,F,A,R+(L-P),g,ee,w),r.drawImage(X,z-Y,0,Y,A,R+j-(L-P),g,L,w),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[X,A]of D.entries()){const F=t[X];let Y=A.x+b;if(F.img!==void 0){const z=i.loadOrGetImage(F.img,s,l);if(z!==void 0){const N=m-8;let _=0,L=0,P=z.width,S=z.height;P>S?(_+=(P-S)/2,P=S):S>P&&(L+=(S-P)/2,S=P),r.beginPath(),Fn(r,Y,g+w/2-N/2,N,N,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(z,_,L,P,S,Y,g+w/2-N/2,N,N),r.restore(),Y+=N+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(F.text,Y,g+w/2+Jn(r,o))}}const Ud={getAccessibilityString:e=>e.data.join(", "),kind:ne.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Vd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ga;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ki=4;function Vd(e,t,n,o){const{rect:r,col:i,row:s,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:h,height:w,width:g}=r,m=w-l.cellVerticalPadding*2,b=[];let v=0;for(let x=0;x<t.length;x++){const H=t[x];if(H.length===0)continue;const D=f.loadOrGetImage(H,i,s);if(D!==void 0){b[x]=D;const X=D.width*(m/D.height);v+=X+ki}}if(v===0)return;v-=ki;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+g-l.cellHorizontalPadding-v):o==="center"&&(C=Math.floor(u+g/2-v/2));for(const x of b){if(x===void 0)continue;const H=x.width*(m/x.height);n>0&&(c.beginPath(),Fn(c,C,h+l.cellVerticalPadding,H,m,n),c.save(),c.clip()),c.drawImage(x,C,h+l.cellVerticalPadding,H,m),n>0&&c.restore(),C+=H+ki}}function qd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const jd={getAccessibilityString:()=>"",kind:ne.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:s}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(qd(n,o)*t.skeletonWidthVariability));const c=s.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*s.cellVerticalPadding);Fn(r,i.x+c,i.y+(i.height-f)/2,l,f,s.roundingRadius??3),r.fillStyle=wo(s.textDark,.1),r.fill()},onPaste:()=>{}},Zd=()=>e=>e.targetWidth,Dl=on("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Zd(),"px"]}}),Jd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:s,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,h]=a.useState(c===""||o),w=a.useCallback(()=>{h(m=>!m)},[]),g=c?"gdg-ml-6":"";return u?a.createElement(Dl,{targetWidth:i.width-20},a.createElement(Zr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:m=>{m.key==="Enter"&&m.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${g}`,onClick:()=>s(t)},a.createElement(sa,null))):a.createElement(Dl,{targetWidth:i.width},a.createElement(wa,{contents:c,createNode:r}),!f&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${g}`,onClick:w},a.createElement(Ti,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Qd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:cr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Dn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:s,validatedSelection:l}=e;return a.createElement(Jd,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:s,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},eu={getAccessibilityString:e=>e.row.toString(),kind:mn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:tu,measure:()=>44,draw:e=>ou(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:s}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=s/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function tu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=nu,n.textAlign="center",i}function nu(e){const{ctx:t}=e;t.textAlign="start"}function ou(e,t,n,o,r,i){const{ctx:s,rect:l,hoverAmount:c,theme:f}=e,{x:u,y:h,width:w,height:g}=l,m=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&m>0){s.globalAlpha=m;const b=7*(n?c:1);if(Bi(s,f,n,r?u+b:u,h,r?w-b:w,g,!0,void 0,void 0,18,"center",i),r){s.globalAlpha=c,s.beginPath();for(const v of[3,6])for(const C of[-5,-1,3])s.rect(u+v,h+g/2+C,2,2);s.fillStyle=f.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),v=f.markerFontFull,C=u+w/2;o==="both"&&c!==0&&(s.globalAlpha=1-c),s.fillStyle=f.textLight,s.font=v,s.fillText(b,C,h+g/2+Jn(s,v)),c!==0&&(s.globalAlpha=1)}}const ru={getAccessibilityString:()=>"",kind:mn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>iu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function iu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:s,spriteManager:l}=e,{x:c,y:f,width:u,height:h}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,h-2),o.fillStyle=s.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const w=t!=="";let g=0;if(n!==void 0){const b=h-8,v=c+8/2,C=f+8/2;l.drawSprite(n,"normal",o,v,C,b,s,w?1:i),g=b}else{g=24;const m=12,b=w?m:i*m,v=w?0:(1-i)*m*.5,C=s.cellHorizontalPadding+4;b>0&&(o.moveTo(c+C+v,f+h/2),o.lineTo(c+C+v+b,f+h/2),o.moveTo(c+C+v+b*.5,f+h/2-b*.5),o.lineTo(c+C+v+b*.5,f+h/2+b*.5),o.lineWidth=2,o.strokeStyle=s.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=s.textMedium,o.fillText(t,g+c+s.cellHorizontalPadding+.5,f+h/2+Jn(o,s)),o.beginPath()}function gs(e,t,n,o,r,i,s){e.textBaseline="alphabetic";const l=lu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Fn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??wo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",s==null||s("text")}function lu(e,t,n,o,r){const i=o.cellHorizontalPadding,s=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+s/2+1,width:t.width-i,height:t.height-s-1};const l=Oo(n,e,o.baseFontFull,"alphabetic"),c=t.height-s,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const su=a.lazy(async()=>await Hl(()=>import("./number-overlay-editor-BBwg_rcV.js"),__vite__mapDeps([6,1,3,7]),import.meta.url)),au={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:cr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:s}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&gs(o,r,f,c,i,t,s),Dn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(su,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},cu={getAccessibilityString:()=>"",measure:()=>108,kind:ne.Protected,needsHover:!1,needsHoverPosition:!1,draw:du,onPaste:()=>{}};function du(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:s}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+s/2,u=Math.cos(al(30))*l,h=Math.sin(al(30))*l;for(let w=0;w<12;w++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-h),t.lineTo(c-u,f+h),t.moveTo(c-u,f-h),t.lineTo(c+u,f+h),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const uu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>cr(e,t,e.theme.textLight),draw:e=>Dn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return Ct.createElement(Zr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},fu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:cr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:s,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:h,hoverEffectTheme:w}=t;u===!0&&n>0&&gs(r,s,w,c,i,n,l),Dn(e,c,f,h,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(Zr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:s=>o({...r,data:s.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},hu=on("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),gu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:s}=e,[l,c]=a.useState(!r&&(t===""||o)),f=a.useCallback(()=>{c(!0)},[]);return l?a.createElement(Zr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):a.createElement(hu,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},s),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:f},a.createElement(Ti,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ms(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,s=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-s-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-s/2),{x:r,y:i,width:s,height:l}}function Fl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,s=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Yl(s,i.baseFontFull);if(l===void 0)return!1;const c=ms(l,n,i,t.contentAlign);return mo({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const mu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:cr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:s,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Oo(c,l,n.baseFontFull),h=ms(u,s,n,t.contentAlign),{x:w,y:g,width:m,height:b}=h;if(r>=w-4&&r<=w-4+m+8&&i>=g-4&&i<=g-4+b+8){const v=Jn(l,n.baseFontFull);o("pointer");const C=5,x=g-v;l.beginPath(),l.moveTo(s.x+w,Math.floor(s.y+x+b+C)+.5),l.lineTo(s.x+w+m,Math.floor(s.y+x+b+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Dn({...e,rect:{...s,x:s.x-1}},c,t.contentAlign),Dn({...e,rect:{...s,x:s.x-2}},c,t.contentAlign),Dn({...e,rect:{...s,x:s.x+1}},c,t.contentAlign),Dn({...e,rect:{...s,x:s.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Dn(e,c,t.contentAlign)},onSelect:e=>{Fl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Fl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(gu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:s=>n({...o,data:s.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},wu=[eu,ru,Pd,Od,Gd,Ud,jd,Qd,au,cu,uu,fu,mu],Si=[];class bu extends Ul{constructor(){super(...arguments);We(this,"imageLoaded",()=>{});We(this,"loadedLocations",[]);We(this,"cache",{});We(this,"sendLoaded",Qs(()=>{this.imageLoaded(new lr(this.loadedLocations)),this.loadedLocations=[]},20));We(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let s=0;s<r.cells.length;s++){const l=r.cells[s];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let s=!1;const l=Si.pop()??new Image;let c=!1;const f={img:void 0,cells:[kn(o,r)],url:n,cancel:()=>{c||(c=!0,Si.length<12?Si.unshift(l):s||(l.src=""))}},u=new Promise(h=>l.addEventListener("load",()=>h(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const h=this.cache[i];if(h!==void 0&&!c){h.img=l;for(const w of h.cells)this.loadedLocations.push(Pi(w));s=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,s=this.cache[i];if(s!==void 0){const l=kn(o,r);return s.cells.includes(l)||s.cells.push(l),s.img}else this.loadImage(n,o,r,i)}}const yu=(e,t)=>{const n=a.useMemo(()=>({...hc,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.renderers??wu,[e.renderers]),r=a.useMemo(()=>e.imageWindowLoader??new bu,[e.imageWindowLoader]);return a.createElement(Ld,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Du=a.forwardRef(yu);export{nd as C,Du as D,ne as G,jl as T,Zr as a,_l as b,nn as c,Eu as d,Ru as e,Su as f,Jn as g,Ao as h,Mu as i,il as j,zo as k,oa as l,Oo as m,Pa as n,Bo as p,Fn as r,Iu as u};
